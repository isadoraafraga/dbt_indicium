2021-04-18 00:48:04.725372 (MainThread): Running with dbt=0.19.1
2021-04-18 00:48:06.504244 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 00:48:06.508232 (MainThread): Tracking: tracking
2021-04-18 00:48:06.509228 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B1F7C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B315DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B315EC8>]}
2021-04-18 00:48:06.549122 (MainThread): Partial parsing not enabled
2021-04-18 00:48:06.577912 (MainThread): Parsing macros\adapters.sql
2021-04-18 00:48:06.712616 (MainThread): Parsing macros\catalog.sql
2021-04-18 00:48:06.742537 (MainThread): Parsing macros\etc.sql
2021-04-18 00:48:06.762481 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 00:48:06.792402 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 00:48:06.839278 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 00:48:06.857229 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 00:48:06.876619 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 00:48:06.913974 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 00:48:06.947882 (MainThread): Parsing macros\core.sql
2021-04-18 00:48:06.980796 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 00:48:07.126409 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 00:48:07.183281 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 00:48:07.197243 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 00:48:07.224172 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 00:48:07.244117 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 00:48:07.261073 (MainThread): Parsing macros\etc\query.sql
2021-04-18 00:48:07.280020 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 00:48:07.319919 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 00:48:07.365792 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 00:48:07.389733 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 00:48:07.418654 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 00:48:07.498483 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 00:48:07.599294 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 00:48:07.628927 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 00:48:07.689775 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 00:48:07.723675 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 00:48:07.747061 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 00:48:07.781965 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 00:48:07.804609 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 00:48:07.821561 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 00:48:07.839512 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 00:48:07.856019 (MainThread): Partial parsing not enabled
2021-04-18 00:48:07.920808 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_product".
2021-04-18 00:48:08.096373 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 00:48:08.098367 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4a0ee03-a54f-4f2e-8ab5-64255dd8e39e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B3D7888>]}
2021-04-18 00:48:08.127292 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4a0ee03-a54f-4f2e-8ab5-64255dd8e39e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2EE92308>]}
2021-04-18 00:48:08.128288 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-04-18 00:48:08.132279 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-04-18 00:48:08.144820 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2EEA8F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2EEA8FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2EE92308>]}
2021-04-18 00:48:08.144820 (MainThread): Flushing usage events
2021-04-18 00:48:09.607958 (MainThread): Connection 'model.northwind_shop.stg_product' was properly closed.
2021-04-18 00:49:53.487296 (MainThread): Running with dbt=0.19.1
2021-04-18 00:49:54.410891 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 00:49:54.413883 (MainThread): Tracking: tracking
2021-04-18 00:49:54.415876 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B2668D848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B26695908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B26695D48>]}
2021-04-18 00:49:54.437853 (MainThread): Partial parsing not enabled
2021-04-18 00:49:54.441908 (MainThread): Parsing macros\adapters.sql
2021-04-18 00:49:54.492862 (MainThread): Parsing macros\catalog.sql
2021-04-18 00:49:54.507830 (MainThread): Parsing macros\etc.sql
2021-04-18 00:49:54.513812 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 00:49:54.524782 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 00:49:54.557731 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 00:49:54.565673 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 00:49:54.569698 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 00:49:54.592600 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 00:49:54.607561 (MainThread): Parsing macros\core.sql
2021-04-18 00:49:54.618565 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 00:49:54.725845 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 00:49:54.751783 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 00:49:54.754773 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 00:49:54.759759 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 00:49:54.765743 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 00:49:54.769731 (MainThread): Parsing macros\etc\query.sql
2021-04-18 00:49:54.773721 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 00:49:54.796661 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 00:49:54.840577 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 00:49:54.850516 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 00:49:54.871460 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 00:49:54.928342 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 00:49:55.011089 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 00:49:55.018102 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 00:49:55.062950 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 00:49:55.077906 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 00:49:55.091869 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 00:49:55.107862 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 00:49:55.116804 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 00:49:55.119831 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 00:49:55.123820 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 00:49:55.139778 (MainThread): Partial parsing not enabled
2021-04-18 00:49:55.200583 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_product".
2021-04-18 00:49:55.423064 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 00:49:55.426053 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e04a267f-7592-482e-9f44-6fe259da4909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B2A1014C8>]}
2021-04-18 00:49:55.458964 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e04a267f-7592-482e-9f44-6fe259da4909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B2A217088>]}
2021-04-18 00:49:55.459963 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-04-18 00:49:55.470937 (MainThread): 
2021-04-18 00:49:55.473942 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 00:49:55.482902 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 00:49:55.485917 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 00:49:56.951776 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_tutorial-dbt-310721_dbt_isadora".
2021-04-18 00:49:56.954768 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_tutorial-dbt-310721_dbt_isadora".
2021-04-18 00:49:56.955766 (ThreadPoolExecutor-0_0): Creating schema "tutorial-dbt-310721.dbt_isadora".
2021-04-18 00:49:56.956763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-04-18 00:49:56.973714 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 00:49:58.550459 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 00:49:58.552004 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 00:49:58.570961 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 00:49:59.867519 (MainThread): 21:49:59 | Concurrency: 1 threads (target='dev')
2021-04-18 00:49:59.869508 (MainThread): 21:49:59 | 
2021-04-18 00:49:59.974223 (Thread-1): Began running node model.northwind_shop.stg_product
2021-04-18 00:49:59.975222 (Thread-1): 21:49:59 | 1 of 1 START view model dbt_isadora.stg_product...................... [RUN]
2021-04-18 00:49:59.976217 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_product".
2021-04-18 00:49:59.977216 (Thread-1): Compiling model.northwind_shop.stg_product
2021-04-18 00:49:59.991178 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_product"
2021-04-18 00:50:00.000154 (Thread-1): finished collecting timing info
2021-04-18 00:50:00.121830 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_product"
2021-04-18 00:50:00.124821 (Thread-1): Opening a new connection, currently in state init
2021-04-18 00:50:00.134796 (Thread-1): On model.northwind_shop.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_product"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_product`
  OPTIONS()
  as with
    source as (
        select *
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 00:50:02.499680 (Thread-1): finished collecting timing info
2021-04-18 00:50:02.500714 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e04a267f-7592-482e-9f44-6fe259da4909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B2A124A08>]}
2021-04-18 00:50:02.500714 (Thread-1): 21:50:02 | 1 of 1 OK created view model dbt_isadora.stg_product................. [OK in 2.52s]
2021-04-18 00:50:02.502672 (Thread-1): Finished running node model.northwind_shop.stg_product
2021-04-18 00:50:02.525854 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 00:50:02.526849 (MainThread): 21:50:02 | 
2021-04-18 00:50:02.528844 (MainThread): 21:50:02 | Finished running 1 view model in 7.05s.
2021-04-18 00:50:02.532835 (MainThread): Connection 'master' was properly closed.
2021-04-18 00:50:02.532835 (MainThread): Connection 'create_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 00:50:02.532835 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 00:50:02.532835 (MainThread): Connection 'model.northwind_shop.stg_product' was properly closed.
2021-04-18 00:50:02.534829 (MainThread): unclosed <socket.socket fd=656, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63991), raddr=('142.250.79.202', 443)>
2021-04-18 00:50:02.535874 (MainThread): unclosed <socket.socket fd=800, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 63992), raddr=('172.217.30.170', 443)>
2021-04-18 00:50:02.544802 (MainThread): 
2021-04-18 00:50:02.546806 (MainThread): Completed successfully
2021-04-18 00:50:02.550784 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 00:50:02.552780 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B26680D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B2A217948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B2A0FC248>]}
2021-04-18 00:50:02.552780 (MainThread): Flushing usage events
2021-04-18 01:09:43.464341 (MainThread): Running with dbt=0.19.1
2021-04-18 01:09:44.334229 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 01:09:44.336703 (MainThread): Tracking: tracking
2021-04-18 01:09:44.337568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8787A088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD878749C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD87874D88>]}
2021-04-18 01:09:44.355562 (MainThread): Partial parsing not enabled
2021-04-18 01:09:44.360425 (MainThread): Parsing macros\adapters.sql
2021-04-18 01:09:44.401623 (MainThread): Parsing macros\catalog.sql
2021-04-18 01:09:44.414594 (MainThread): Parsing macros\etc.sql
2021-04-18 01:09:44.420577 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 01:09:44.429555 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 01:09:44.454484 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 01:09:44.460506 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 01:09:44.465807 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 01:09:44.487755 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 01:09:44.502404 (MainThread): Parsing macros\core.sql
2021-04-18 01:09:44.510420 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 01:09:44.600143 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 01:09:44.619099 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 01:09:44.621122 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 01:09:44.626074 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 01:09:44.631061 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 01:09:44.635050 (MainThread): Parsing macros\etc\query.sql
2021-04-18 01:09:44.637080 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 01:09:44.655995 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 01:09:44.684954 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 01:09:44.688906 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 01:09:44.701966 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 01:09:44.748871 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 01:09:44.816711 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 01:09:44.821476 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 01:09:44.857273 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 01:09:44.871276 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 01:09:44.882299 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 01:09:44.895301 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 01:09:44.901323 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 01:09:44.905274 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 01:09:44.909301 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 01:09:44.922265 (MainThread): Partial parsing not enabled
2021-04-18 01:09:44.994444 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_product".
2021-04-18 01:09:45.164739 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 01:09:45.167735 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd87f2bf-febf-43db-b558-c7575aa3a385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8B47CB88>]}
2021-04-18 01:09:45.190671 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd87f2bf-febf-43db-b558-c7575aa3a385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8B3C89C8>]}
2021-04-18 01:09:45.191669 (MainThread): Found 1 model, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-04-18 01:09:45.198650 (MainThread): 
2021-04-18 01:09:45.200651 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 01:09:45.205633 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 01:09:45.206629 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 01:09:46.116793 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 01:09:46.117810 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 01:09:46.134734 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 01:09:47.418810 (MainThread): 22:09:47 | Concurrency: 1 threads (target='dev')
2021-04-18 01:09:47.421799 (MainThread): 22:09:47 | 
2021-04-18 01:09:47.429816 (Thread-1): Began running node model.northwind_shop.stg_product
2021-04-18 01:09:47.429816 (Thread-1): 22:09:47 | 1 of 1 START view model dbt_isadora.stg_product...................... [RUN]
2021-04-18 01:09:47.431809 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_product".
2021-04-18 01:09:47.431809 (Thread-1): Compiling model.northwind_shop.stg_product
2021-04-18 01:09:47.441789 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_product"
2021-04-18 01:09:47.445770 (Thread-1): finished collecting timing info
2021-04-18 01:09:47.541516 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_product"
2021-04-18 01:09:47.543589 (Thread-1): Opening a new connection, currently in state init
2021-04-18 01:09:47.552571 (Thread-1): On model.northwind_shop.stg_product: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_product"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_product`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 01:09:50.003875 (Thread-1): finished collecting timing info
2021-04-18 01:09:50.003875 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd87f2bf-febf-43db-b558-c7575aa3a385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8B2D3348>]}
2021-04-18 01:09:50.004874 (Thread-1): 22:09:50 | 1 of 1 OK created view model dbt_isadora.stg_product................. [OK in 2.57s]
2021-04-18 01:09:50.005840 (Thread-1): Finished running node model.northwind_shop.stg_product
2021-04-18 01:09:50.069650 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 01:09:50.070647 (MainThread): 22:09:50 | 
2021-04-18 01:09:50.071626 (MainThread): 22:09:50 | Finished running 1 view model in 4.87s.
2021-04-18 01:09:50.072620 (MainThread): Connection 'master' was properly closed.
2021-04-18 01:09:50.072620 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 01:09:50.072620 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 01:09:50.073620 (MainThread): Connection 'model.northwind_shop.stg_product' was properly closed.
2021-04-18 01:09:50.083591 (MainThread): 
2021-04-18 01:09:50.083591 (MainThread): Completed successfully
2021-04-18 01:09:50.085586 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 01:09:50.086585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD87902688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD8AD7D548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD87908748>]}
2021-04-18 01:09:50.086585 (MainThread): Flushing usage events
2021-04-18 01:22:32.045381 (MainThread): Running with dbt=0.19.1
2021-04-18 01:22:32.933729 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 01:22:32.935795 (MainThread): Tracking: tracking
2021-04-18 01:22:32.936797 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027326E13F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027326E1A508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027326E22388>]}
2021-04-18 01:22:32.954749 (MainThread): Partial parsing not enabled
2021-04-18 01:22:32.958301 (MainThread): Parsing macros\adapters.sql
2021-04-18 01:22:32.998234 (MainThread): Parsing macros\catalog.sql
2021-04-18 01:22:33.013160 (MainThread): Parsing macros\etc.sql
2021-04-18 01:22:33.019141 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 01:22:33.028117 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 01:22:33.053053 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 01:22:33.058072 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 01:22:33.062063 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 01:22:33.086960 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 01:22:33.097931 (MainThread): Parsing macros\core.sql
2021-04-18 01:22:33.105909 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 01:22:33.200062 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 01:22:33.220030 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 01:22:33.224020 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 01:22:33.229007 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 01:22:33.232995 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 01:22:33.236985 (MainThread): Parsing macros\etc\query.sql
2021-04-18 01:22:33.239981 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 01:22:33.258926 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 01:22:33.295829 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 01:22:33.299818 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 01:22:33.312543 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 01:22:33.353474 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 01:22:33.420260 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 01:22:33.424251 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 01:22:33.459156 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 01:22:33.472155 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 01:22:33.483059 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 01:22:33.498527 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 01:22:33.504552 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 01:22:33.507544 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 01:22:33.512531 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 01:22:33.525462 (MainThread): Partial parsing not enabled
2021-04-18 01:22:33.578352 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 01:22:33.598298 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 01:22:33.774792 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 01:22:33.778783 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb8be267-a416-4779-84cd-ef7394029e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732AA1B708>]}
2021-04-18 01:22:33.792745 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb8be267-a416-4779-84cd-ef7394029e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732A875588>]}
2021-04-18 01:22:33.792745 (MainThread): Found 2 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-04-18 01:22:33.795772 (MainThread): 
2021-04-18 01:22:33.796737 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 01:22:33.799763 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 01:22:33.799763 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 01:22:35.268812 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 01:22:35.270760 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 01:22:35.286714 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 01:22:36.612991 (MainThread): 22:22:36 | Concurrency: 1 threads (target='dev')
2021-04-18 01:22:36.614847 (MainThread): 22:22:36 | 
2021-04-18 01:22:36.631813 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 01:22:36.632810 (Thread-1): 22:22:36 | 1 of 2 START view model dbt_isadora.stg_orders....................... [RUN]
2021-04-18 01:22:36.639791 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 01:22:36.640789 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 01:22:36.654750 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 01:22:36.656747 (Thread-1): finished collecting timing info
2021-04-18 01:22:37.059668 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 01:22:37.071635 (Thread-1): Opening a new connection, currently in state init
2021-04-18 01:22:37.122499 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            
  

            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 01:22:39.676433 (Thread-1): finished collecting timing info
2021-04-18 01:22:39.678427 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb8be267-a416-4779-84cd-ef7394029e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732A991848>]}
2021-04-18 01:22:39.680421 (Thread-1): 22:22:39 | 1 of 2 OK created view model dbt_isadora.stg_orders.................. [OK in 3.04s]
2021-04-18 01:22:39.682414 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 01:22:39.682414 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 01:22:39.683412 (Thread-1): 22:22:39 | 2 of 2 START view model dbt_isadora.stg_products..................... [RUN]
2021-04-18 01:22:39.686404 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 01:22:39.686404 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 01:22:39.696378 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 01:22:39.700366 (Thread-1): finished collecting timing info
2021-04-18 01:22:39.726299 (Thread-1): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 64305), raddr=('216.58.202.170', 443)>
2021-04-18 01:22:39.726299 (Thread-1): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 64306), raddr=('142.250.219.10', 443)>
2021-04-18 01:22:39.739265 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 01:22:39.741257 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 01:22:39.759208 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 01:22:41.951405 (Thread-1): finished collecting timing info
2021-04-18 01:22:41.952403 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb8be267-a416-4779-84cd-ef7394029e12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732AAA1048>]}
2021-04-18 01:22:41.953400 (Thread-1): 22:22:41 | 2 of 2 OK created view model dbt_isadora.stg_products................ [OK in 2.27s]
2021-04-18 01:22:41.955395 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 01:22:42.026206 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 01:22:42.026206 (MainThread): 22:22:42 | 
2021-04-18 01:22:42.028222 (MainThread): 22:22:42 | Finished running 2 view models in 8.23s.
2021-04-18 01:22:42.029198 (MainThread): Connection 'master' was properly closed.
2021-04-18 01:22:42.030196 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 01:22:42.030196 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 01:22:42.030196 (MainThread): Connection 'model.northwind_shop.stg_products' was properly closed.
2021-04-18 01:22:42.032190 (MainThread): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 64310), raddr=('216.58.202.170', 443)>
2021-04-18 01:22:42.033188 (MainThread): unclosed <socket.socket fd=880, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.103', 64311), raddr=('142.250.219.10', 443)>
2021-04-18 01:22:42.048147 (MainThread): 
2021-04-18 01:22:42.052139 (MainThread): Completed successfully
2021-04-18 01:22:42.058121 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-04-18 01:22:42.061113 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027326EB6948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732A8F8648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002732A9E3BC8>]}
2021-04-18 01:22:42.062111 (MainThread): Flushing usage events
2021-04-18 02:13:36.538723 (MainThread): Running with dbt=0.19.1
2021-04-18 02:13:38.811930 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:13:38.814956 (MainThread): Tracking: tracking
2021-04-18 02:13:38.815967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201001D3F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201001D3A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201001D9C08>]}
2021-04-18 02:13:38.861828 (MainThread): Partial parsing not enabled
2021-04-18 02:13:38.867775 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:13:38.929459 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:13:38.944423 (MainThread): Parsing macros\etc.sql
2021-04-18 02:13:38.950407 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:13:38.964370 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:13:38.998282 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:13:39.006294 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:13:39.010281 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:13:39.034205 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:13:39.058202 (MainThread): Parsing macros\core.sql
2021-04-18 02:13:39.069176 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:13:39.200819 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:13:39.226752 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:13:39.229742 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:13:39.233731 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:13:39.239717 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:13:39.246700 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:13:39.249693 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:13:39.270650 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:13:39.305579 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:13:39.313529 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:13:39.333466 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:13:39.384329 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:13:39.523957 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:13:39.528943 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:13:39.616708 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:13:39.644634 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:13:39.661588 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:13:39.683535 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:13:39.693513 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:13:39.697505 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:13:39.706478 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:13:39.727426 (MainThread): Partial parsing not enabled
2021-04-18 02:13:39.812196 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_costumers".
2021-04-18 02:13:39.858074 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:13:39.869045 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:13:39.881013 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:13:39.905957 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:13:39.930879 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:13:40.277950 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020103E81F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020103C8F548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020103E81F88>]}
2021-04-18 02:13:40.277950 (MainThread): Flushing usage events
2021-04-18 02:13:41.677695 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-18 02:13:41.678692 (MainThread): Encountered an error:
2021-04-18 02:13:41.688665 (MainThread): Compilation Error in model stg_costumers (models\staging\stg_costumers.sql)
  Model 'model.northwind_shop.stg_costumers' (models\staging\stg_costumers.sql) depends on a source named 'northwind_etl.costumers' which was not found
2021-04-18 02:13:42.105551 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_costumers (models\staging\stg_costumers.sql)
  Model 'model.northwind_shop.stg_costumers' (models\staging\stg_costumers.sql) depends on a source named 'northwind_etl.costumers' which was not found

2021-04-18 02:15:05.874083 (MainThread): Running with dbt=0.19.1
2021-04-18 02:15:06.727661 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:15:06.729623 (MainThread): Tracking: tracking
2021-04-18 02:15:06.730618 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EEECE908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F0F69708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EEFDB0C8>]}
2021-04-18 02:15:06.749602 (MainThread): Partial parsing not enabled
2021-04-18 02:15:06.752558 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:15:06.791456 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:15:06.804457 (MainThread): Parsing macros\etc.sql
2021-04-18 02:15:06.808444 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:15:06.818384 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:15:06.842354 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:15:06.847342 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:15:06.852293 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:15:06.871242 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:15:06.882247 (MainThread): Parsing macros\core.sql
2021-04-18 02:15:06.890920 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:15:06.979721 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:15:06.998636 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:15:07.000631 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:15:07.004658 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:15:07.008645 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:15:07.014595 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:15:07.016625 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:15:07.037531 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:15:07.065495 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:15:07.069484 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:15:07.082447 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:15:07.124299 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:15:07.190162 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:15:07.194796 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:15:07.229489 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:15:07.243490 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:15:07.253463 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:15:07.268645 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:15:07.274671 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:15:07.278659 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:15:07.282650 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:15:07.295576 (MainThread): Partial parsing not enabled
2021-04-18 02:15:07.359633 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:15:07.379453 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:15:07.387431 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:15:07.396860 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:15:07.405515 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:15:07.413493 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:15:07.579498 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:15:07.583488 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2C7AE48>]}
2021-04-18 02:15:07.602447 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2C3BD88>]}
2021-04-18 02:15:07.604436 (MainThread): Found 6 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 6 sources, 0 exposures
2021-04-18 02:15:07.607430 (MainThread): 
2021-04-18 02:15:07.609422 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:15:07.614405 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:15:07.615403 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:15:09.224155 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:15:09.224155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:15:09.232136 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:15:10.678390 (MainThread): 23:15:10 | Concurrency: 1 threads (target='dev')
2021-04-18 02:15:10.679205 (MainThread): 23:15:10 | 
2021-04-18 02:15:10.686210 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 02:15:10.686210 (Thread-1): 23:15:10 | 1 of 6 START view model dbt_isadora.stg_customers.................... [RUN]
2021-04-18 02:15:10.687207 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:15:10.688209 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 02:15:10.693192 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:15:10.695187 (Thread-1): finished collecting timing info
2021-04-18 02:15:10.793956 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:15:10.795748 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:15:10.810707 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 02:15:13.317871 (Thread-1): finished collecting timing info
2021-04-18 02:15:13.317871 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2D238C8>]}
2021-04-18 02:15:13.318866 (Thread-1): 23:15:13 | 1 of 6 OK created view model dbt_isadora.stg_customers............... [OK in 2.63s]
2021-04-18 02:15:13.319830 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 02:15:13.320825 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 02:15:13.320825 (Thread-1): 23:15:13 | 2 of 6 START view model dbt_isadora.stg_employees.................... [RUN]
2021-04-18 02:15:13.322819 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:15:13.322819 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 02:15:13.328804 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:15:13.330800 (Thread-1): finished collecting timing info
2021-04-18 02:15:13.339774 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:15:13.341770 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:15:13.354743 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 02:15:15.806189 (Thread-1): finished collecting timing info
2021-04-18 02:15:15.807187 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2C380C8>]}
2021-04-18 02:15:15.807187 (Thread-1): 23:15:15 | 2 of 6 OK created view model dbt_isadora.stg_employees............... [OK in 2.48s]
2021-04-18 02:15:15.808047 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 02:15:15.809070 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 02:15:15.809070 (Thread-1): 23:15:15 | 3 of 6 START view model dbt_isadora.stg_orders....................... [RUN]
2021-04-18 02:15:15.811066 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:15:15.811066 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 02:15:15.815053 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:15:15.817049 (Thread-1): finished collecting timing info
2021-04-18 02:15:15.826026 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:15:15.830013 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:15:15.844972 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 02:15:18.299511 (Thread-1): finished collecting timing info
2021-04-18 02:15:18.299511 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2D47C48>]}
2021-04-18 02:15:18.300508 (Thread-1): 23:15:18 | 3 of 6 OK created view model dbt_isadora.stg_orders.................. [OK in 2.49s]
2021-04-18 02:15:18.301504 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 02:15:18.302506 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 02:15:18.302506 (Thread-1): 23:15:18 | 4 of 6 START view model dbt_isadora.stg_products..................... [RUN]
2021-04-18 02:15:18.304502 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:15:18.304502 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 02:15:18.312545 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:15:18.314472 (Thread-1): finished collecting timing info
2021-04-18 02:15:18.319457 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:15:18.321452 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:15:18.336416 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 02:15:20.739107 (Thread-1): finished collecting timing info
2021-04-18 02:15:20.740104 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2D5DF48>]}
2021-04-18 02:15:20.740104 (Thread-1): 23:15:20 | 4 of 6 OK created view model dbt_isadora.stg_products................ [OK in 2.44s]
2021-04-18 02:15:20.742064 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 02:15:20.742064 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 02:15:20.743062 (Thread-1): 23:15:20 | 5 of 6 START view model dbt_isadora.stg_shippers..................... [RUN]
2021-04-18 02:15:20.744059 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:15:20.745057 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 02:15:20.751043 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:15:20.755036 (Thread-1): finished collecting timing info
2021-04-18 02:15:20.759018 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:15:20.761013 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:15:20.771987 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 02:15:22.619052 (Thread-1): finished collecting timing info
2021-04-18 02:15:22.619052 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2C544C8>]}
2021-04-18 02:15:22.620050 (Thread-1): 23:15:22 | 5 of 6 OK created view model dbt_isadora.stg_shippers................ [OK in 1.87s]
2021-04-18 02:15:22.620511 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 02:15:22.621532 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 02:15:22.622529 (Thread-1): 23:15:22 | 6 of 6 START view model dbt_isadora.stg_suppliers.................... [RUN]
2021-04-18 02:15:22.623527 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:15:22.623527 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 02:15:22.631530 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:15:22.634497 (Thread-1): finished collecting timing info
2021-04-18 02:15:22.639485 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:15:22.641478 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:15:22.655440 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 02:15:22.657434 (Thread-1): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61109), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:22.658430 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61110), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:22.659432 (Thread-1): unclosed <socket.socket fd=1020, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61112), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:22.660431 (Thread-1): unclosed <socket.socket fd=1216, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61111), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:22.661425 (Thread-1): unclosed <socket.socket fd=852, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61114), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:22.661425 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61113), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:22.663426 (Thread-1): unclosed <socket.socket fd=952, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61116), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:22.663426 (Thread-1): unclosed <socket.socket fd=1236, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61115), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:22.664419 (Thread-1): unclosed <socket.socket fd=840, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61118), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:22.664419 (Thread-1): unclosed <socket.socket fd=800, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61117), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:24.544448 (Thread-1): finished collecting timing info
2021-04-18 02:15:24.547390 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6d6ea46-b1b5-4620-88bd-8391be3cb158', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2E12AC8>]}
2021-04-18 02:15:24.548430 (Thread-1): 23:15:24 | 6 of 6 OK created view model dbt_isadora.stg_suppliers............... [OK in 1.92s]
2021-04-18 02:15:24.551374 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 02:15:24.564335 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:15:24.567332 (MainThread): 23:15:24 | 
2021-04-18 02:15:24.569349 (MainThread): 23:15:24 | Finished running 6 view models in 16.96s.
2021-04-18 02:15:24.571319 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:15:24.571319 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:15:24.571319 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:15:24.571319 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-18 02:15:24.644122 (MainThread): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61106), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:24.645160 (MainThread): unclosed <socket.socket fd=1160, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61108), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:24.645160 (MainThread): unclosed <socket.socket fd=1152, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61107), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:24.645160 (MainThread): unclosed <socket.socket fd=396, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61105), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:24.662107 (MainThread): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61119), raddr=('172.217.30.170', 443)>
2021-04-18 02:15:24.662107 (MainThread): unclosed <socket.socket fd=852, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61120), raddr=('142.250.79.202', 443)>
2021-04-18 02:15:24.678030 (MainThread): 
2021-04-18 02:15:24.679028 (MainThread): Completed successfully
2021-04-18 02:15:24.680029 (MainThread): 
Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
2021-04-18 02:15:24.682020 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2DDCA48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F2D8F4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191EF0940C8>]}
2021-04-18 02:15:24.683018 (MainThread): Flushing usage events
2021-04-18 02:19:39.460683 (MainThread): Running with dbt=0.19.1
2021-04-18 02:19:40.589085 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:19:40.590085 (MainThread): Tracking: tracking
2021-04-18 02:19:40.591082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A2C68F6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A2C795EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A2C79B0C8>]}
2021-04-18 02:19:40.617012 (MainThread): Partial parsing not enabled
2021-04-18 02:19:40.624026 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:19:40.676887 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:19:40.693807 (MainThread): Parsing macros\etc.sql
2021-04-18 02:19:40.699789 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:19:40.711796 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:19:40.752175 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:19:40.761144 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:19:40.766132 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:19:40.791098 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:19:40.810013 (MainThread): Parsing macros\core.sql
2021-04-18 02:19:40.824013 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:19:40.959616 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:19:40.987539 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:19:40.989534 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:19:40.992562 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:19:40.998513 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:19:41.006488 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:19:41.009480 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:19:41.045387 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:19:41.125171 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:19:41.140136 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:19:41.164067 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:19:41.225903 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:19:41.320650 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:19:41.324638 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:19:41.387468 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:19:41.411405 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:19:41.427403 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:19:41.449307 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:19:41.456288 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:19:41.459279 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:19:41.464267 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:19:41.490196 (MainThread): Partial parsing not enabled
2021-04-18 02:19:41.558013 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:19:41.585938 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:19:41.625789 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:19:41.638778 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:19:41.647733 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:19:41.659222 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:19:41.672194 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:19:42.047201 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3045BEC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3045BF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3045BFC8>]}
2021-04-18 02:19:42.048198 (MainThread): Flushing usage events
2021-04-18 02:19:42.960169 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-18 02:19:42.960169 (MainThread): Encountered an error:
2021-04-18 02:19:42.962157 (MainThread): Compilation Error in model stg_orders (models\staging\stg_orders.sql)
  Model 'model.northwind_shop.stg_orders' (models\staging\stg_orders.sql) depends on a source named 'northwind_etl.order_details' which was not found
2021-04-18 02:19:42.973126 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 444, in load_all
    manifest = loader.create_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 422, in create_manifest
    self.process_manifest(manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 387, in process_manifest
    process_sources(manifest, project_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 820, in process_sources
    _process_sources_for_node(manifest, current_project, node)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 807, in _process_sources_for_node
    disabled=(isinstance(target_source, Disabled))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 510, in invalid_source_fail_unless_test
    disabled=disabled
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 597, in source_target_not_found
    raise_compiler_error(msg, model)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orders (models\staging\stg_orders.sql)
  Model 'model.northwind_shop.stg_orders' (models\staging\stg_orders.sql) depends on a source named 'northwind_etl.order_details' which was not found

2021-04-18 02:20:50.982119 (MainThread): Running with dbt=0.19.1
2021-04-18 02:20:51.745500 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:20:51.746497 (MainThread): Tracking: tracking
2021-04-18 02:20:51.747496 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842A18BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842A25D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842A25F88>]}
2021-04-18 02:20:51.767443 (MainThread): Partial parsing not enabled
2021-04-18 02:20:51.770472 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:20:51.809333 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:20:51.823327 (MainThread): Parsing macros\etc.sql
2021-04-18 02:20:51.828280 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:20:51.838252 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:20:51.863225 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:20:51.869208 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:20:51.872199 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:20:51.892109 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:20:51.903083 (MainThread): Parsing macros\core.sql
2021-04-18 02:20:51.913056 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:20:52.008797 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:20:52.027782 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:20:52.029776 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:20:52.033768 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:20:52.037756 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:20:52.042706 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:20:52.044700 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:20:52.071631 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:20:52.120500 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:20:52.127482 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:20:52.168376 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:20:52.339916 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:20:52.438647 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:20:52.442636 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:20:52.480537 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:20:52.497492 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:20:52.509461 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:20:52.523423 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:20:52.530402 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:20:52.533394 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:20:52.537383 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:20:52.550352 (MainThread): Partial parsing not enabled
2021-04-18 02:20:52.597223 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:20:52.616175 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:20:52.624154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:20:52.631168 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:20:52.639149 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:20:52.647092 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:20:52.654074 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:20:52.846799 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:20:52.850789 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8464A7E88>]}
2021-04-18 02:20:52.864752 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8466BAF08>]}
2021-04-18 02:20:52.865754 (MainThread): Found 7 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:20:52.867745 (MainThread): 
2021-04-18 02:20:52.868744 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:20:52.871734 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:20:52.871734 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:20:53.851525 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:20:53.851525 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:20:53.861533 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:20:55.301302 (MainThread): 23:20:55 | Concurrency: 1 threads (target='dev')
2021-04-18 02:20:55.303299 (MainThread): 23:20:55 | 
2021-04-18 02:20:55.319250 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 02:20:55.319250 (Thread-1): 23:20:55 | 1 of 7 START view model dbt_isadora.stg_customers.................... [RUN]
2021-04-18 02:20:55.321247 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:20:55.322244 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 02:20:55.333214 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:20:55.338233 (Thread-1): finished collecting timing info
2021-04-18 02:20:55.418983 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:20:55.419979 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:20:55.428957 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 02:20:57.425490 (Thread-1): finished collecting timing info
2021-04-18 02:20:57.426486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8466FEC88>]}
2021-04-18 02:20:57.427450 (Thread-1): 23:20:57 | 1 of 7 OK created view model dbt_isadora.stg_customers............... [OK in 2.11s]
2021-04-18 02:20:57.428449 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 02:20:57.429445 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 02:20:57.429445 (Thread-1): 23:20:57 | 2 of 7 START view model dbt_isadora.stg_employees.................... [RUN]
2021-04-18 02:20:57.430444 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:20:57.431441 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 02:20:57.437428 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:20:57.438422 (Thread-1): finished collecting timing info
2021-04-18 02:20:57.444404 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:20:57.447396 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:20:57.470341 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 02:20:59.891340 (Thread-1): finished collecting timing info
2021-04-18 02:20:59.891340 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8467B8F48>]}
2021-04-18 02:20:59.892377 (Thread-1): 23:20:59 | 2 of 7 OK created view model dbt_isadora.stg_employees............... [OK in 2.46s]
2021-04-18 02:20:59.894330 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 02:20:59.895328 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 02:20:59.895328 (Thread-1): 23:20:59 | 3 of 7 START view model dbt_isadora.stg_order_details................ [RUN]
2021-04-18 02:20:59.897334 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:20:59.897334 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 02:20:59.904305 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:20:59.906298 (Thread-1): finished collecting timing info
2021-04-18 02:20:59.916280 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:20:59.918266 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:20:59.929238 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-18 02:21:02.373536 (Thread-1): finished collecting timing info
2021-04-18 02:21:02.374534 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8467E0FC8>]}
2021-04-18 02:21:02.374534 (Thread-1): 23:21:02 | 3 of 7 OK created view model dbt_isadora.stg_order_details........... [OK in 2.48s]
2021-04-18 02:21:02.376495 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 02:21:02.376495 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 02:21:02.377494 (Thread-1): 23:21:02 | 4 of 7 START view model dbt_isadora.stg_orders....................... [RUN]
2021-04-18 02:21:02.378488 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:21:02.378488 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 02:21:02.385470 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:21:02.389466 (Thread-1): finished collecting timing info
2021-04-18 02:21:02.393452 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:21:02.394448 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:21:02.404419 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 02:21:04.210724 (Thread-1): finished collecting timing info
2021-04-18 02:21:04.210724 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84680FEC8>]}
2021-04-18 02:21:04.211725 (Thread-1): 23:21:04 | 4 of 7 OK created view model dbt_isadora.stg_orders.................. [OK in 1.83s]
2021-04-18 02:21:04.212688 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 02:21:04.213689 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 02:21:04.213689 (Thread-1): 23:21:04 | 5 of 7 START view model dbt_isadora.stg_products..................... [RUN]
2021-04-18 02:21:04.215678 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:21:04.216679 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 02:21:04.225712 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:21:04.226686 (Thread-1): finished collecting timing info
2021-04-18 02:21:04.230638 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:21:04.233657 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:21:04.247598 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 02:21:06.695599 (Thread-1): finished collecting timing info
2021-04-18 02:21:06.696604 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8468323C8>]}
2021-04-18 02:21:06.698589 (Thread-1): 23:21:06 | 5 of 7 OK created view model dbt_isadora.stg_products................ [OK in 2.48s]
2021-04-18 02:21:06.706567 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 02:21:06.706567 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 02:21:06.707566 (Thread-1): 23:21:06 | 6 of 7 START view model dbt_isadora.stg_shippers..................... [RUN]
2021-04-18 02:21:06.708564 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:21:06.709560 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 02:21:06.713550 (Thread-1): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61179), raddr=('142.250.219.42', 443)>
2021-04-18 02:21:06.715545 (Thread-1): unclosed <socket.socket fd=1076, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61180), raddr=('142.250.79.202', 443)>
2021-04-18 02:21:06.719556 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61182), raddr=('142.250.79.202', 443)>
2021-04-18 02:21:06.720532 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61181), raddr=('142.250.219.42', 443)>
2021-04-18 02:21:06.722525 (Thread-1): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61184), raddr=('142.250.79.202', 443)>
2021-04-18 02:21:06.723523 (Thread-1): unclosed <socket.socket fd=1160, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61183), raddr=('142.250.219.42', 443)>
2021-04-18 02:21:06.724522 (Thread-1): unclosed <socket.socket fd=700, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61186), raddr=('142.250.79.202', 443)>
2021-04-18 02:21:06.725517 (Thread-1): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61185), raddr=('142.250.219.42', 443)>
2021-04-18 02:21:06.726529 (Thread-1): unclosed <socket.socket fd=872, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61188), raddr=('142.250.219.42', 443)>
2021-04-18 02:21:06.727564 (Thread-1): unclosed <socket.socket fd=1228, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61189), raddr=('142.250.79.202', 443)>
2021-04-18 02:21:06.745465 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:21:06.747458 (Thread-1): finished collecting timing info
2021-04-18 02:21:06.943299 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:21:06.945294 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:21:06.970240 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 02:21:08.843142 (Thread-1): finished collecting timing info
2021-04-18 02:21:08.844142 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F84611E5C8>]}
2021-04-18 02:21:08.844142 (Thread-1): 23:21:08 | 6 of 7 OK created view model dbt_isadora.stg_shippers................ [OK in 2.13s]
2021-04-18 02:21:08.845138 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 02:21:08.846136 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 02:21:08.847133 (Thread-1): 23:21:08 | 7 of 7 START view model dbt_isadora.stg_suppliers.................... [RUN]
2021-04-18 02:21:08.849139 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:21:08.853142 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 02:21:08.861096 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:21:08.863091 (Thread-1): finished collecting timing info
2021-04-18 02:21:08.883056 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:21:08.886028 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:21:08.904982 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 02:21:10.859433 (Thread-1): finished collecting timing info
2021-04-18 02:21:10.860432 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58367911-aba4-45a7-87ae-d71277441e22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842A0FDC8>]}
2021-04-18 02:21:10.861429 (Thread-1): 23:21:10 | 7 of 7 OK created view model dbt_isadora.stg_suppliers............... [OK in 2.01s]
2021-04-18 02:21:10.862426 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 02:21:10.973193 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:21:10.975186 (MainThread): 23:21:10 | 
2021-04-18 02:21:10.976183 (MainThread): 23:21:10 | Finished running 7 view models in 18.11s.
2021-04-18 02:21:10.978180 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:21:10.979178 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:21:10.979178 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:21:10.981171 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-18 02:21:11.007097 (MainThread): 
2021-04-18 02:21:11.009092 (MainThread): Completed successfully
2021-04-18 02:21:11.023056 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2021-04-18 02:21:11.026046 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8460A4B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8460A4C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F842A74348>]}
2021-04-18 02:21:11.026046 (MainThread): Flushing usage events
2021-04-18 02:23:35.330831 (MainThread): Running with dbt=0.19.1
2021-04-18 02:23:36.410463 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:23:36.412458 (MainThread): Tracking: tracking
2021-04-18 02:23:36.413455 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1D77F6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1D8F28C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1D8F2D08>]}
2021-04-18 02:23:36.457368 (MainThread): Partial parsing not enabled
2021-04-18 02:23:36.463323 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:23:36.547657 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:23:36.579573 (MainThread): Parsing macros\etc.sql
2021-04-18 02:23:36.592541 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:23:36.613481 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:23:36.681303 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:23:36.695264 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:23:36.701247 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:23:36.748122 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:23:36.766074 (MainThread): Parsing macros\core.sql
2021-04-18 02:23:36.792007 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:23:36.978506 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:23:37.014409 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:23:37.017401 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:23:37.028372 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:23:37.033359 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:23:37.046327 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:23:37.049317 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:23:37.099184 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:23:37.153041 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:23:37.162015 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:23:37.191936 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:23:37.280697 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:23:37.413343 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:23:37.420334 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:23:37.529108 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:23:37.562017 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:23:37.582960 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:23:37.611886 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:23:37.628839 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:23:37.632826 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:23:37.646792 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:23:37.680700 (MainThread): Partial parsing not enabled
2021-04-18 02:23:37.816186 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:23:37.860071 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:23:37.877024 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:23:37.893980 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:23:37.908940 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:23:37.927891 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:23:37.945841 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:23:37.961798 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:23:38.390665 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:23:38.453500 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B2151E988>]}
2021-04-18 02:23:38.496370 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B21506F88>]}
2021-04-18 02:23:38.497366 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:23:38.512326 (MainThread): 
2021-04-18 02:23:38.514331 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:23:38.558206 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:23:38.558206 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:23:45.774203 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:23:45.775201 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:23:45.785181 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:23:46.637267 (MainThread): 23:23:46 | Concurrency: 1 threads (target='dev')
2021-04-18 02:23:46.641249 (MainThread): 23:23:46 | 
2021-04-18 02:23:46.648230 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 02:23:46.648230 (Thread-1): 23:23:46 | 1 of 8 START view model dbt_isadora.stg_customers.................... [RUN]
2021-04-18 02:23:46.650226 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:23:46.650226 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 02:23:46.663190 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:23:46.664188 (Thread-1): finished collecting timing info
2021-04-18 02:23:46.809797 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:23:46.811792 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:23:46.826753 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 02:23:49.327465 (Thread-1): finished collecting timing info
2021-04-18 02:23:49.328418 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B21425788>]}
2021-04-18 02:23:49.329452 (Thread-1): 23:23:49 | 1 of 8 OK created view model dbt_isadora.stg_customers............... [OK in 2.68s]
2021-04-18 02:23:49.331417 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 02:23:49.332409 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 02:23:49.334416 (Thread-1): 23:23:49 | 2 of 8 START view model dbt_isadora.stg_employees.................... [RUN]
2021-04-18 02:23:49.339389 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:23:49.339389 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 02:23:49.345373 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:23:49.346369 (Thread-1): finished collecting timing info
2021-04-18 02:23:49.353350 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:23:49.354347 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:23:49.368310 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 02:23:51.254564 (Thread-1): finished collecting timing info
2021-04-18 02:23:51.255562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B216294C8>]}
2021-04-18 02:23:51.256559 (Thread-1): 23:23:51 | 2 of 8 OK created view model dbt_isadora.stg_employees............... [OK in 1.92s]
2021-04-18 02:23:51.258554 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 02:23:51.258554 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 02:23:51.259552 (Thread-1): 23:23:51 | 3 of 8 START view model dbt_isadora.stg_order_details................ [RUN]
2021-04-18 02:23:51.260549 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:23:51.260549 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 02:23:51.262543 (Thread-1): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61216), raddr=('142.250.219.10', 443)>
2021-04-18 02:23:51.263552 (Thread-1): unclosed <socket.socket fd=696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61217), raddr=('142.250.79.202', 443)>
2021-04-18 02:23:51.270523 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:23:51.276521 (Thread-1): finished collecting timing info
2021-04-18 02:23:51.281492 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:23:51.283488 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:23:51.304456 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-18 02:23:53.120446 (Thread-1): finished collecting timing info
2021-04-18 02:23:53.122417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B215F7FC8>]}
2021-04-18 02:23:53.123416 (Thread-1): 23:23:53 | 3 of 8 OK created view model dbt_isadora.stg_order_details........... [OK in 1.86s]
2021-04-18 02:23:53.131394 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 02:23:53.132390 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 02:23:53.133392 (Thread-1): 23:23:53 | 4 of 8 START view model dbt_isadora.stg_orders....................... [RUN]
2021-04-18 02:23:53.138374 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:23:53.138374 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 02:23:53.140369 (Thread-1): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61218), raddr=('142.250.219.10', 443)>
2021-04-18 02:23:53.141367 (Thread-1): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61219), raddr=('142.250.79.202', 443)>
2021-04-18 02:23:53.149345 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:23:53.157328 (Thread-1): finished collecting timing info
2021-04-18 02:23:53.174277 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:23:53.180262 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:23:53.201216 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 02:23:55.088955 (Thread-1): finished collecting timing info
2021-04-18 02:23:55.090948 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B2161DF88>]}
2021-04-18 02:23:55.091949 (Thread-1): 23:23:55 | 4 of 8 OK created view model dbt_isadora.stg_orders.................. [OK in 1.95s]
2021-04-18 02:23:55.093939 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 02:23:55.094938 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 02:23:55.095935 (Thread-1): 23:23:55 | 5 of 8 START view model dbt_isadora.stg_products..................... [RUN]
2021-04-18 02:23:55.098926 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:23:55.098926 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 02:23:55.103929 (Thread-1): unclosed <socket.socket fd=808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61220), raddr=('142.250.219.10', 443)>
2021-04-18 02:23:55.104911 (Thread-1): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61222), raddr=('142.250.79.202', 443)>
2021-04-18 02:23:55.112888 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:23:55.114883 (Thread-1): finished collecting timing info
2021-04-18 02:23:55.123859 (Thread-1): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61214), raddr=('142.250.219.10', 443)>
2021-04-18 02:23:55.124856 (Thread-1): unclosed <socket.socket fd=892, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61215), raddr=('142.250.79.202', 443)>
2021-04-18 02:23:55.161757 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:23:55.163753 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:23:55.182703 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 02:23:57.701232 (Thread-1): finished collecting timing info
2021-04-18 02:23:57.702230 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1F280248>]}
2021-04-18 02:23:57.703226 (Thread-1): 23:23:57 | 5 of 8 OK created view model dbt_isadora.stg_products................ [OK in 2.60s]
2021-04-18 02:23:57.706220 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 02:23:57.707217 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 02:23:57.708255 (Thread-1): 23:23:57 | 6 of 8 START view model dbt_isadora.stg_shippers..................... [RUN]
2021-04-18 02:23:57.711212 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:23:57.711212 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 02:23:57.722211 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:23:57.723172 (Thread-1): finished collecting timing info
2021-04-18 02:23:57.728195 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:23:57.730155 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:23:57.740128 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 02:23:59.527267 (Thread-1): finished collecting timing info
2021-04-18 02:23:59.528265 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1D8C3A08>]}
2021-04-18 02:23:59.528265 (Thread-1): 23:23:59 | 6 of 8 OK created view model dbt_isadora.stg_shippers................ [OK in 1.82s]
2021-04-18 02:23:59.530264 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 02:23:59.530264 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 02:23:59.533268 (Thread-1): 23:23:59 | 7 of 8 START view model dbt_isadora.stg_suppliers.................... [RUN]
2021-04-18 02:23:59.537242 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:23:59.537242 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 02:23:59.543225 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:23:59.544223 (Thread-1): finished collecting timing info
2021-04-18 02:23:59.555196 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:23:59.558186 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:23:59.572149 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 02:24:01.958976 (Thread-1): finished collecting timing info
2021-04-18 02:24:01.960973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1D8C3C08>]}
2021-04-18 02:24:01.961969 (Thread-1): 23:24:01 | 7 of 8 OK created view model dbt_isadora.stg_suppliers............... [OK in 2.42s]
2021-04-18 02:24:01.963964 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 02:24:01.964961 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 02:24:01.970945 (Thread-1): 23:24:01 | 8 of 8 START view model dbt_isadora.dim_customers.................... [RUN]
2021-04-18 02:24:01.971943 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:24:01.972941 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 02:24:01.974933 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61228), raddr=('142.250.219.10', 443)>
2021-04-18 02:24:01.975933 (Thread-1): unclosed <socket.socket fd=696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61229), raddr=('142.250.79.202', 443)>
2021-04-18 02:24:01.984923 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:24:01.991889 (Thread-1): finished collecting timing info
2021-04-18 02:24:02.002858 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:24:02.006849 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:24:02.025798 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    select * from selected;


2021-04-18 02:24:04.411668 (Thread-1): finished collecting timing info
2021-04-18 02:24:04.415658 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efbfa5b7-0d1a-4669-8488-1bedb0b8d154', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B2169CF48>]}
2021-04-18 02:24:04.418653 (Thread-1): 23:24:04 | 8 of 8 OK created view model dbt_isadora.dim_customers............... [OK in 2.44s]
2021-04-18 02:24:04.422640 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 02:24:04.493656 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:24:04.495650 (MainThread): 23:24:04 | 
2021-04-18 02:24:04.500638 (MainThread): 23:24:04 | Finished running 8 view models in 25.98s.
2021-04-18 02:24:04.504625 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:24:04.506622 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:24:04.506622 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:24:04.507620 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-04-18 02:24:04.537537 (MainThread): 
2021-04-18 02:24:04.539531 (MainThread): Completed successfully
2021-04-18 02:24:04.541529 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2021-04-18 02:24:04.543520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B21302908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1F868B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B1D8CD988>]}
2021-04-18 02:24:04.544517 (MainThread): Flushing usage events
2021-04-18 02:28:49.026861 (MainThread): Running with dbt=0.19.1
2021-04-18 02:28:49.839122 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:28:49.840120 (MainThread): Tracking: tracking
2021-04-18 02:28:49.842111 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B65EE8708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B66644E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B66644FC8>]}
2021-04-18 02:28:49.860607 (MainThread): Partial parsing not enabled
2021-04-18 02:28:49.863563 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:28:49.903710 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:28:49.916697 (MainThread): Parsing macros\etc.sql
2021-04-18 02:28:49.921684 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:28:49.930700 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:28:49.956785 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:28:49.962767 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:28:49.967336 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:28:49.988284 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:28:50.001251 (MainThread): Parsing macros\core.sql
2021-04-18 02:28:50.010225 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:28:50.102018 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:28:50.120929 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:28:50.123922 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:28:50.127892 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:28:50.131884 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:28:50.135874 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:28:50.139174 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:28:50.158917 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:28:50.186849 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:28:50.190873 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:28:50.207792 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:28:50.252672 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:28:50.322485 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:28:50.326494 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:28:50.363412 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:28:50.377842 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:28:50.387837 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:28:50.401842 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:28:50.407784 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:28:50.410776 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:28:50.414765 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:28:50.428730 (MainThread): Partial parsing not enabled
2021-04-18 02:28:50.491597 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:28:50.512506 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:28:50.520486 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:28:50.528499 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:28:50.537515 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:28:50.545493 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:28:50.553473 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:28:50.562448 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:28:50.745957 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:28:50.749951 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2da1482-c3e5-416c-b6de-ca02cd13f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6A0F7508>]}
2021-04-18 02:28:50.771889 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2da1482-c3e5-416c-b6de-ca02cd13f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6A0A5A08>]}
2021-04-18 02:28:50.772889 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:28:50.780867 (MainThread): 
2021-04-18 02:28:50.782861 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:28:50.786857 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:28:50.787846 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:28:52.694875 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:28:52.694875 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:28:52.702855 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:28:54.135164 (MainThread): 23:28:54 | Concurrency: 1 threads (target='dev')
2021-04-18 02:28:54.136182 (MainThread): 23:28:54 | 
2021-04-18 02:28:54.143160 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 02:28:54.143160 (Thread-1): 23:28:54 | 1 of 1 START view model dbt_isadora.dim_customers.................... [RUN]
2021-04-18 02:28:54.145156 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:28:54.145156 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 02:28:54.149142 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:28:54.150139 (Thread-1): finished collecting timing info
2021-04-18 02:28:54.238904 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:28:54.241898 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:28:54.250868 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by costumer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:28:56.159775 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/1ca1c829-ea37-4796-9614-a9affbc770d0?maxResults=0&location=US&prettyPrint=false: Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]')
2021-04-18 02:28:57.457392 (Thread-1): finished collecting timing info
2021-04-18 02:28:57.461400 (Thread-1): Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/69185c35-08bc-42ae-87f5-14837bcbc14c?maxResults=0&location=US&prettyPrint=false: Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]

(job ID: 69185c35-08bc-42ae-87f5-14837bcbc14c)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select
   9:            /*Primary Key*/
  10:            customer_id
  11:
  12:            , country
  13:            , city
  14:            , fax
  15:            , postal_code
  16:            , address
  17:            , region
  18:            , contact_name
  19:            , phone
  20:            , company_name
  21:            , contact_title
  22:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  23:    )
  24:
  25:    , transformed as (
  26:        select
  27:        row_number() over (order by costumer_id) as customer_sk
  28:        , *
  29:        from selected
  30:    )
  31:
  32:    select * from transformed;
  33:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-04-18 02:28:58.034595 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2da1482-c3e5-416c-b6de-ca02cd13f5c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6A1A0788>]}
2021-04-18 02:28:58.035595 (Thread-1): 23:28:58 | 1 of 1 ERROR creating view model dbt_isadora.dim_customers........... [ERROR in 3.89s]
2021-04-18 02:28:58.036590 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 02:28:58.119368 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:28:58.119368 (MainThread): 23:28:58 | 
2021-04-18 02:28:58.120368 (MainThread): 23:28:58 | Finished running 1 view model in 7.34s.
2021-04-18 02:28:58.121364 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:28:58.121364 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:28:58.121364 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:28:58.122361 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-04-18 02:28:58.148850 (MainThread): 
2021-04-18 02:28:58.177785 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 02:28:58.186800 (MainThread): 
2021-04-18 02:28:58.187747 (MainThread): Database Error in model dim_customers (models\marts\dim_customers.sql)
2021-04-18 02:28:58.232627 (MainThread):   Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
2021-04-18 02:28:58.269087 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-04-18 02:28:58.318984 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 02:28:58.367821 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6A095C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6A0AB388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029B6A0D61C8>]}
2021-04-18 02:28:58.368820 (MainThread): Flushing usage events
2021-04-18 02:31:56.203952 (MainThread): Running with dbt=0.19.1
2021-04-18 02:31:56.922821 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:31:56.923823 (MainThread): Tracking: tracking
2021-04-18 02:31:56.924817 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C91EAA188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C91EA5B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C91EA5848>]}
2021-04-18 02:31:56.942770 (MainThread): Partial parsing not enabled
2021-04-18 02:31:56.944766 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:31:56.984657 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:31:56.997621 (MainThread): Parsing macros\etc.sql
2021-04-18 02:31:57.001612 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:31:57.011549 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:31:57.037479 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:31:57.043502 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:31:57.046493 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:31:57.066437 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:31:57.076411 (MainThread): Parsing macros\core.sql
2021-04-18 02:31:57.084389 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:31:57.172123 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:31:57.191072 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:31:57.194065 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:31:57.198087 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:31:57.202075 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:31:57.206066 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:31:57.208059 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:31:57.225975 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:31:57.262912 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:31:57.266905 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:31:57.279832 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:31:57.321720 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:31:57.390571 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:31:57.393563 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:31:57.429469 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:31:57.442435 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:31:57.453406 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:31:57.465371 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:31:57.471355 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:31:57.474349 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:31:57.478336 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:31:57.491303 (MainThread): Partial parsing not enabled
2021-04-18 02:31:57.536183 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:31:57.555131 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:31:57.563109 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:31:57.570097 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:31:57.578074 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:31:57.586051 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:31:57.593030 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:31:57.601009 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:31:57.774508 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:31:57.779496 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95A4A988>]}
2021-04-18 02:31:57.800441 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95945748>]}
2021-04-18 02:31:57.800441 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:31:57.807441 (MainThread): 
2021-04-18 02:31:57.809418 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:31:57.815402 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:31:57.815402 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:31:58.765057 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:31:58.765057 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:31:58.779019 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:32:00.205806 (MainThread): 23:32:00 | Concurrency: 1 threads (target='dev')
2021-04-18 02:32:00.207803 (MainThread): 23:32:00 | 
2021-04-18 02:32:00.224752 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 02:32:00.225750 (Thread-1): 23:32:00 | 1 of 8 START view model dbt_isadora.stg_customers.................... [RUN]
2021-04-18 02:32:00.227745 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:32:00.228743 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 02:32:00.238713 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:32:00.244703 (Thread-1): finished collecting timing info
2021-04-18 02:32:00.324484 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:32:00.326482 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:32:00.339443 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 02:32:02.729787 (Thread-1): finished collecting timing info
2021-04-18 02:32:02.730785 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95BD8FC8>]}
2021-04-18 02:32:02.730785 (Thread-1): 23:32:02 | 1 of 8 OK created view model dbt_isadora.stg_customers............... [OK in 2.50s]
2021-04-18 02:32:02.733198 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 02:32:02.733198 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 02:32:02.734195 (Thread-1): 23:32:02 | 2 of 8 START view model dbt_isadora.stg_employees.................... [RUN]
2021-04-18 02:32:02.736190 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:32:02.736190 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 02:32:02.742175 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:32:02.744168 (Thread-1): finished collecting timing info
2021-04-18 02:32:02.748158 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:32:02.750152 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:02.764115 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 02:32:04.562865 (Thread-1): finished collecting timing info
2021-04-18 02:32:04.562865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95C60FC8>]}
2021-04-18 02:32:04.563860 (Thread-1): 23:32:04 | 2 of 8 OK created view model dbt_isadora.stg_employees............... [OK in 1.83s]
2021-04-18 02:32:04.565821 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 02:32:04.565821 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 02:32:04.566824 (Thread-1): 23:32:04 | 3 of 8 START view model dbt_isadora.stg_order_details................ [RUN]
2021-04-18 02:32:04.567814 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:32:04.568812 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 02:32:04.570846 (Thread-1): unclosed <socket.socket fd=840, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61335), raddr=('172.217.29.138', 443)>
2021-04-18 02:32:04.570846 (Thread-1): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61336), raddr=('142.250.79.202', 443)>
2021-04-18 02:32:04.576790 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:32:04.577787 (Thread-1): finished collecting timing info
2021-04-18 02:32:04.581780 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:32:04.582776 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:04.594744 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-18 02:32:06.449321 (Thread-1): finished collecting timing info
2021-04-18 02:32:06.452313 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95C576C8>]}
2021-04-18 02:32:06.454307 (Thread-1): 23:32:06 | 3 of 8 OK created view model dbt_isadora.stg_order_details........... [OK in 1.88s]
2021-04-18 02:32:06.457717 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 02:32:06.458720 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 02:32:06.459709 (Thread-1): 23:32:06 | 4 of 8 START view model dbt_isadora.stg_orders....................... [RUN]
2021-04-18 02:32:06.462700 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:32:06.462700 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 02:32:06.465691 (Thread-1): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61337), raddr=('172.217.29.138', 443)>
2021-04-18 02:32:06.465691 (Thread-1): unclosed <socket.socket fd=840, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61338), raddr=('142.250.79.202', 443)>
2021-04-18 02:32:06.472672 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:32:06.474669 (Thread-1): finished collecting timing info
2021-04-18 02:32:06.480650 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:32:06.481647 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:06.495612 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 02:32:08.248068 (Thread-1): finished collecting timing info
2021-04-18 02:32:08.250019 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95C37A88>]}
2021-04-18 02:32:08.251053 (Thread-1): 23:32:08 | 4 of 8 OK created view model dbt_isadora.stg_orders.................. [OK in 1.79s]
2021-04-18 02:32:08.254919 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 02:32:08.254919 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 02:32:08.256916 (Thread-1): 23:32:08 | 5 of 8 START view model dbt_isadora.stg_products..................... [RUN]
2021-04-18 02:32:08.258907 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:32:08.258907 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 02:32:08.260902 (Thread-1): unclosed <socket.socket fd=1080, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61339), raddr=('172.217.29.138', 443)>
2021-04-18 02:32:08.260902 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61340), raddr=('142.250.79.202', 443)>
2021-04-18 02:32:08.267883 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:32:08.270873 (Thread-1): finished collecting timing info
2021-04-18 02:32:08.273866 (Thread-1): unclosed <socket.socket fd=1040, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61333), raddr=('172.217.29.138', 443)>
2021-04-18 02:32:08.274863 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61334), raddr=('142.250.79.202', 443)>
2021-04-18 02:32:08.295842 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:32:08.296844 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:08.307776 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 02:32:10.764502 (Thread-1): finished collecting timing info
2021-04-18 02:32:10.765501 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95569248>]}
2021-04-18 02:32:10.765501 (Thread-1): 23:32:10 | 5 of 8 OK created view model dbt_isadora.stg_products................ [OK in 2.51s]
2021-04-18 02:32:10.767459 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 02:32:10.767459 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 02:32:10.768461 (Thread-1): 23:32:10 | 6 of 8 START view model dbt_isadora.stg_shippers..................... [RUN]
2021-04-18 02:32:10.770452 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:32:10.770452 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 02:32:10.775443 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:32:10.777433 (Thread-1): finished collecting timing info
2021-04-18 02:32:10.785412 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:32:10.787406 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:10.799373 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 02:32:13.100231 (Thread-1): finished collecting timing info
2021-04-18 02:32:13.101263 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9552A048>]}
2021-04-18 02:32:13.101263 (Thread-1): 23:32:13 | 6 of 8 OK created view model dbt_isadora.stg_shippers................ [OK in 2.33s]
2021-04-18 02:32:13.103561 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 02:32:13.103561 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 02:32:13.104559 (Thread-1): 23:32:13 | 7 of 8 START view model dbt_isadora.stg_suppliers.................... [RUN]
2021-04-18 02:32:13.105558 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:32:13.106554 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 02:32:13.112538 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:32:13.114532 (Thread-1): finished collecting timing info
2021-04-18 02:32:13.122515 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:32:13.123510 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:13.133482 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 02:32:15.483107 (Thread-1): finished collecting timing info
2021-04-18 02:32:15.483107 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C91E8A888>]}
2021-04-18 02:32:15.484104 (Thread-1): 23:32:15 | 7 of 8 OK created view model dbt_isadora.stg_suppliers............... [OK in 2.38s]
2021-04-18 02:32:15.485103 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 02:32:15.486100 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 02:32:15.486100 (Thread-1): 23:32:15 | 8 of 8 START view model dbt_isadora.dim_customers.................... [RUN]
2021-04-18 02:32:15.488095 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:32:15.488095 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 02:32:15.490089 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61345), raddr=('172.217.29.138', 443)>
2021-04-18 02:32:15.490089 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61346), raddr=('142.250.79.202', 443)>
2021-04-18 02:32:15.494080 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:32:15.496073 (Thread-1): finished collecting timing info
2021-04-18 02:32:15.504053 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:32:15.506050 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:32:15.519012 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by costumer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:32:17.356767 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/9928153c-3fa2-404f-966d-e98a76b77b97?maxResults=0&location=US&prettyPrint=false: Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]')
2021-04-18 02:32:19.239557 (Thread-1): finished collecting timing info
2021-04-18 02:32:19.241604 (Thread-1): Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/0442b4a1-1cf3-491f-a677-044a65aba076?maxResults=0&location=US&prettyPrint=false: Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]

(job ID: 0442b4a1-1cf3-491f-a677-044a65aba076)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select
   9:            /*Primary Key*/
  10:            customer_id
  11:
  12:            , country
  13:            , city
  14:            , fax
  15:            , postal_code
  16:            , address
  17:            , region
  18:            , contact_name
  19:            , phone
  20:            , company_name
  21:            , contact_title
  22:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  23:    )
  24:
  25:    , transformed as (
  26:        select
  27:        row_number() over (order by costumer_id) as customer_sk
  28:        , *
  29:        from selected
  30:    )
  31:
  32:    select * from transformed;
  33:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-04-18 02:32:19.263493 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e93f9cc-45ce-4232-ace5-37d121173508', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C94207488>]}
2021-04-18 02:32:19.264533 (Thread-1): 23:32:19 | 8 of 8 ERROR creating view model dbt_isadora.dim_customers........... [ERROR in 3.78s]
2021-04-18 02:32:19.266484 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 02:32:19.299193 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:32:19.299193 (MainThread): 23:32:19 | 
2021-04-18 02:32:19.301191 (MainThread): 23:32:19 | Finished running 8 view models in 21.49s.
2021-04-18 02:32:19.302197 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:32:19.302197 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:32:19.303184 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:32:19.303184 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-04-18 02:32:19.315149 (MainThread): 
2021-04-18 02:32:19.316146 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 02:32:19.318142 (MainThread): 
2021-04-18 02:32:19.319140 (MainThread): Database Error in model dim_customers (models\marts\dim_customers.sql)
2021-04-18 02:32:19.320138 (MainThread):   Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
2021-04-18 02:32:19.322133 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-04-18 02:32:19.323129 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2021-04-18 02:32:19.325124 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C93E9B8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C9419E5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C95CDC908>]}
2021-04-18 02:32:19.328115 (MainThread): Flushing usage events
2021-04-18 02:34:09.941101 (MainThread): Running with dbt=0.19.1
2021-04-18 02:34:10.863636 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:34:10.864634 (MainThread): Tracking: tracking
2021-04-18 02:34:10.865632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F8EABC5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F8EACB288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F8EACB0C8>]}
2021-04-18 02:34:10.885578 (MainThread): Partial parsing not enabled
2021-04-18 02:34:10.888569 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:34:10.931455 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:34:10.950438 (MainThread): Parsing macros\etc.sql
2021-04-18 02:34:10.954431 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:34:10.964380 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:34:10.994288 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:34:11.001269 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:34:11.006255 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:34:11.028194 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:34:11.039166 (MainThread): Parsing macros\core.sql
2021-04-18 02:34:11.049150 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:34:11.145880 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:34:11.165856 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:34:11.168818 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:34:11.173807 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:34:11.178793 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:34:11.182781 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:34:11.185773 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:34:11.206718 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:34:11.236639 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:34:11.240628 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:34:11.255671 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:34:11.302569 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:34:11.404296 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:34:11.410279 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:34:11.449175 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:34:11.468125 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:34:11.482088 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:34:11.499042 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:34:11.507020 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:34:11.511010 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:34:11.517992 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:34:11.540931 (MainThread): Partial parsing not enabled
2021-04-18 02:34:11.675572 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:34:11.708482 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:34:11.716461 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:34:11.725437 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:34:11.734413 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:34:11.742391 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:34:11.750370 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:34:11.761341 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:34:11.959810 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:34:11.964797 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b94ac74e-df5a-4f78-8855-b7e85126b75c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9256D8C8>]}
2021-04-18 02:34:11.999706 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b94ac74e-df5a-4f78-8855-b7e85126b75c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F92746F88>]}
2021-04-18 02:34:12.000702 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:34:12.006684 (MainThread): 
2021-04-18 02:34:12.017685 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:34:12.025635 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:34:12.025635 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:34:12.909416 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:34:12.914418 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:34:12.936343 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:34:14.387851 (MainThread): 23:34:14 | Concurrency: 1 threads (target='dev')
2021-04-18 02:34:14.388846 (MainThread): 23:34:14 | 
2021-04-18 02:34:14.399818 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 02:34:14.400817 (Thread-1): 23:34:14 | 1 of 1 START view model dbt_isadora.dim_customers.................... [RUN]
2021-04-18 02:34:14.403808 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:34:14.403808 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 02:34:14.418768 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:34:14.421762 (Thread-1): finished collecting timing info
2021-04-18 02:34:14.618234 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:34:14.620229 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:34:14.635189 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by costumer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:34:16.036669 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/0d4c12ac-ab41-4abf-b8a3-29cf716c39ee?maxResults=0&location=US&prettyPrint=false: Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]')
2021-04-18 02:34:17.922285 (Thread-1): finished collecting timing info
2021-04-18 02:34:17.924282 (Thread-1): Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/c32e8973-162e-493c-8fb1-1ee56ede8ed4?maxResults=0&location=US&prettyPrint=false: Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]

(job ID: c32e8973-162e-493c-8fb1-1ee56ede8ed4)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select
   9:            /*Primary Key*/
  10:            customer_id
  11:
  12:            , country
  13:            , city
  14:            , fax
  15:            , postal_code
  16:            , address
  17:            , region
  18:            , contact_name
  19:            , phone
  20:            , company_name
  21:            , contact_title
  22:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  23:    )
  24:
  25:    , transformed as (
  26:        select
  27:        row_number() over (order by costumer_id) as customer_sk
  28:        , *
  29:        from selected
  30:    )
  31:
  32:    select * from transformed;
  33:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_customers (models\marts\dim_customers.sql)
  Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
  compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-04-18 02:34:17.967363 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b94ac74e-df5a-4f78-8855-b7e85126b75c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F92657848>]}
2021-04-18 02:34:17.968362 (Thread-1): 23:34:17 | 1 of 1 ERROR creating view model dbt_isadora.dim_customers........... [ERROR in 3.56s]
2021-04-18 02:34:17.970316 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 02:34:18.036586 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:34:18.037581 (MainThread): 23:34:18 | 
2021-04-18 02:34:18.037581 (MainThread): 23:34:18 | Finished running 1 view model in 6.02s.
2021-04-18 02:34:18.038576 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:34:18.039576 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:34:18.039576 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:34:18.039576 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-04-18 02:34:18.056532 (MainThread): 
2021-04-18 02:34:18.057523 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 02:34:18.058522 (MainThread): 
2021-04-18 02:34:18.059519 (MainThread): Database Error in model dim_customers (models\marts\dim_customers.sql)
2021-04-18 02:34:18.065518 (MainThread):   Unrecognized name: costumer_id; Did you mean customer_id? at [27:37]
2021-04-18 02:34:18.066516 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_customers.sql
2021-04-18 02:34:18.067499 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 02:34:18.068496 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F92556DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F9254C748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F8EB54FC8>]}
2021-04-18 02:34:18.069494 (MainThread): Flushing usage events
2021-04-18 02:34:49.509386 (MainThread): Running with dbt=0.19.1
2021-04-18 02:34:50.507419 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:34:50.509413 (MainThread): Tracking: tracking
2021-04-18 02:34:50.510410 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82C0B94C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82A16B188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82A16B108>]}
2021-04-18 02:34:50.546315 (MainThread): Partial parsing not enabled
2021-04-18 02:34:50.550305 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:34:50.624106 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:34:50.646049 (MainThread): Parsing macros\etc.sql
2021-04-18 02:34:50.651035 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:34:50.667989 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:34:50.715860 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:34:50.729825 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:34:50.733812 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:34:50.768720 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:34:50.785674 (MainThread): Parsing macros\core.sql
2021-04-18 02:34:50.800634 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:34:50.947242 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:34:50.980154 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:34:50.982148 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:34:50.986137 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:34:50.996112 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:34:51.000101 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:34:51.005105 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:34:51.043984 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:34:51.085871 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:34:51.096844 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:34:51.118784 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:34:51.188645 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:34:51.309302 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:34:51.315284 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:34:51.384098 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:34:51.407039 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:34:51.419007 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:34:51.446934 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:34:51.455937 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:34:51.461893 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:34:51.465885 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:34:51.489817 (MainThread): Partial parsing not enabled
2021-04-18 02:34:51.735574 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:34:51.768053 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:34:51.783012 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:34:51.798970 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:34:51.814926 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:34:51.830887 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:34:51.843851 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:34:51.852834 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:34:52.166984 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:34:52.179951 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f1e06e8-9e3b-4461-9eda-cef54f104ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82DCCAC08>]}
2021-04-18 02:34:52.242784 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f1e06e8-9e3b-4461-9eda-cef54f104ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82DBEA188>]}
2021-04-18 02:34:52.243783 (MainThread): Found 8 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:34:52.250787 (MainThread): 
2021-04-18 02:34:52.263728 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:34:52.283675 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:34:52.283675 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:34:53.796948 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:34:53.797946 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:34:53.808913 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:34:54.693955 (MainThread): 23:34:54 | Concurrency: 1 threads (target='dev')
2021-04-18 02:34:54.694952 (MainThread): 23:34:54 | 
2021-04-18 02:34:54.710908 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 02:34:54.711905 (Thread-1): 23:34:54 | 1 of 1 START view model dbt_isadora.dim_customers.................... [RUN]
2021-04-18 02:34:54.729857 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:34:54.730855 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 02:34:54.758795 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:34:54.765763 (Thread-1): finished collecting timing info
2021-04-18 02:34:54.895415 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:34:54.896411 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:34:54.911373 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:34:56.733047 (Thread-1): finished collecting timing info
2021-04-18 02:34:56.733047 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f1e06e8-9e3b-4461-9eda-cef54f104ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82DC1EA48>]}
2021-04-18 02:34:56.734045 (Thread-1): 23:34:56 | 1 of 1 OK created view model dbt_isadora.dim_customers............... [OK in 2.02s]
2021-04-18 02:34:56.740060 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 02:34:56.815829 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:34:56.816826 (MainThread): 23:34:56 | 
2021-04-18 02:34:56.817824 (MainThread): 23:34:56 | Finished running 1 view model in 4.55s.
2021-04-18 02:34:56.823810 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:34:56.826806 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:34:56.829816 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:34:56.831783 (MainThread): Connection 'model.northwind_shop.dim_customers' was properly closed.
2021-04-18 02:34:56.882647 (MainThread): 
2021-04-18 02:34:56.883645 (MainThread): Completed successfully
2021-04-18 02:34:56.913566 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 02:34:56.923542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82DBB5C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82DBD78C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A82DDD9348>]}
2021-04-18 02:34:56.924537 (MainThread): Flushing usage events
2021-04-18 02:39:01.222713 (MainThread): Running with dbt=0.19.1
2021-04-18 02:39:01.954827 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:39:01.955827 (MainThread): Tracking: tracking
2021-04-18 02:39:01.955827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EE15FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EE01EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EE126C8>]}
2021-04-18 02:39:01.973777 (MainThread): Partial parsing not enabled
2021-04-18 02:39:01.976768 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:39:02.016627 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:39:02.030627 (MainThread): Parsing macros\etc.sql
2021-04-18 02:39:02.039602 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:39:02.047579 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:39:02.072514 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:39:02.078503 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:39:02.082488 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:39:02.102434 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:39:02.112406 (MainThread): Parsing macros\core.sql
2021-04-18 02:39:02.121384 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:39:02.208150 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:39:02.226104 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:39:02.228097 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:39:02.231089 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:39:02.236076 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:39:02.239067 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:39:02.242059 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:39:02.259977 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:39:02.290897 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:39:02.294886 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:39:02.309845 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:39:02.351767 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:39:02.420582 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:39:02.424572 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:39:02.472444 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:39:02.486406 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:39:02.496381 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:39:02.509346 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:39:02.516327 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:39:02.519318 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:39:02.523308 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:39:02.536274 (MainThread): Partial parsing not enabled
2021-04-18 02:39:02.583112 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:39:02.601102 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 02:39:02.609078 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 02:39:02.616060 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 02:39:02.623041 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:39:02.631985 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:39:02.638998 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:39:02.646978 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:39:02.653925 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:39:02.662934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:39:02.669916 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:39:02.820515 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:39:02.824469 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A299AD48>]}
2021-04-18 02:39:02.842422 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A28AB088>]}
2021-04-18 02:39:02.843420 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:39:02.848407 (MainThread): 
2021-04-18 02:39:02.851401 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:39:02.858401 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:39:02.859377 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:39:03.857036 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:39:03.859030 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:39:03.872985 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:39:04.676314 (MainThread): 23:39:04 | Concurrency: 1 threads (target='dev')
2021-04-18 02:39:04.677340 (MainThread): 23:39:04 | 
2021-04-18 02:39:04.682331 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 02:39:04.683329 (Thread-1): 23:39:04 | 1 of 11 START view model dbt_isadora.stg_customers................... [RUN]
2021-04-18 02:39:04.684326 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:39:04.684326 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 02:39:04.697296 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:39:04.701281 (Thread-1): finished collecting timing info
2021-04-18 02:39:04.789048 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 02:39:04.790045 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:39:04.798022 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 02:39:07.283668 (Thread-1): finished collecting timing info
2021-04-18 02:39:07.284663 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A28B4748>]}
2021-04-18 02:39:07.284663 (Thread-1): 23:39:07 | 1 of 11 OK created view model dbt_isadora.stg_customers.............. [OK in 2.60s]
2021-04-18 02:39:07.286622 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 02:39:07.286622 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 02:39:07.287621 (Thread-1): 23:39:07 | 2 of 11 START view model dbt_isadora.stg_employees................... [RUN]
2021-04-18 02:39:07.288640 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:39:07.289615 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 02:39:07.290613 (Thread-1): unclosed <socket.socket fd=908, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61434), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:07.291609 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61435), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:07.298611 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:39:07.300586 (Thread-1): finished collecting timing info
2021-04-18 02:39:07.306572 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 02:39:07.308563 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:07.322561 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 02:39:09.684729 (Thread-1): finished collecting timing info
2021-04-18 02:39:09.686724 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A29A6EC8>]}
2021-04-18 02:39:09.688712 (Thread-1): 23:39:09 | 2 of 11 OK created view model dbt_isadora.stg_employees.............. [OK in 2.40s]
2021-04-18 02:39:09.690703 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 02:39:09.691700 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 02:39:09.693692 (Thread-1): 23:39:09 | 3 of 11 START view model dbt_isadora.stg_products.................... [RUN]
2021-04-18 02:39:09.695689 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:39:09.696685 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 02:39:09.705662 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:39:09.706659 (Thread-1): finished collecting timing info
2021-04-18 02:39:09.712643 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 02:39:09.715634 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:09.728597 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 02:39:09.969256 (Thread-1): unclosed <socket.socket fd=908, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61437), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:09.970256 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61436), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:11.602025 (Thread-1): finished collecting timing info
2021-04-18 02:39:11.603020 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A2B38108>]}
2021-04-18 02:39:11.605015 (Thread-1): 23:39:11 | 3 of 11 OK created view model dbt_isadora.stg_products............... [OK in 1.91s]
2021-04-18 02:39:11.608007 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 02:39:11.608007 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 02:39:11.610001 (Thread-1): 23:39:11 | 4 of 11 START view model dbt_isadora.stg_shippers.................... [RUN]
2021-04-18 02:39:11.612994 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:39:11.612994 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 02:39:11.712727 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61438), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:11.713726 (Thread-1): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61439), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:11.721700 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:39:11.722700 (Thread-1): finished collecting timing info
2021-04-18 02:39:11.728681 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 02:39:11.729679 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:11.737656 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 02:39:14.116188 (Thread-1): finished collecting timing info
2021-04-18 02:39:14.118184 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A2B6AD48>]}
2021-04-18 02:39:14.119184 (Thread-1): 23:39:14 | 4 of 11 OK created view model dbt_isadora.stg_shippers............... [OK in 2.51s]
2021-04-18 02:39:14.122127 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 02:39:14.123126 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 02:39:14.124127 (Thread-1): 23:39:14 | 5 of 11 START view model dbt_isadora.stg_order_details............... [RUN]
2021-04-18 02:39:14.127116 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:39:14.128117 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 02:39:14.140099 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:39:14.141073 (Thread-1): finished collecting timing info
2021-04-18 02:39:14.146061 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 02:39:14.149054 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:14.160024 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-18 02:39:16.512302 (Thread-1): finished collecting timing info
2021-04-18 02:39:16.512302 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EDE47C8>]}
2021-04-18 02:39:16.513300 (Thread-1): 23:39:16 | 5 of 11 OK created view model dbt_isadora.stg_order_details.......... [OK in 2.39s]
2021-04-18 02:39:16.514261 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 02:39:16.515267 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 02:39:16.515267 (Thread-1): 23:39:16 | 6 of 11 START view model dbt_isadora.stg_orders...................... [RUN]
2021-04-18 02:39:16.517260 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:39:16.517260 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 02:39:16.526250 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:39:16.528224 (Thread-1): finished collecting timing info
2021-04-18 02:39:16.533211 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 02:39:16.536220 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:16.549216 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 02:39:18.957571 (Thread-1): finished collecting timing info
2021-04-18 02:39:18.957571 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EE4EC08>]}
2021-04-18 02:39:18.958565 (Thread-1): 23:39:18 | 6 of 11 OK created view model dbt_isadora.stg_orders................. [OK in 2.44s]
2021-04-18 02:39:18.959528 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 02:39:18.960525 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 02:39:18.960525 (Thread-1): 23:39:18 | 7 of 11 START view model dbt_isadora.stg_suppliers................... [RUN]
2021-04-18 02:39:18.961535 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:39:18.962521 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 02:39:18.969506 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:39:18.972495 (Thread-1): finished collecting timing info
2021-04-18 02:39:18.979486 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 02:39:18.982467 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:18.994433 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 02:39:21.395485 (Thread-1): finished collecting timing info
2021-04-18 02:39:21.396486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A2AC7D08>]}
2021-04-18 02:39:21.396486 (Thread-1): 23:39:21 | 7 of 11 OK created view model dbt_isadora.stg_suppliers.............. [OK in 2.43s]
2021-04-18 02:39:21.398444 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 02:39:21.398444 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 02:39:21.399442 (Thread-1): 23:39:21 | 8 of 11 START view model dbt_isadora.dim_customers................... [RUN]
2021-04-18 02:39:21.400439 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:39:21.401436 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 02:39:21.402436 (Thread-1): unclosed <socket.socket fd=1064, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61446), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:21.403434 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61447), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:21.410413 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:39:21.412407 (Thread-1): finished collecting timing info
2021-04-18 02:39:21.416395 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 02:39:21.417394 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:21.431356 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:39:23.836229 (Thread-1): finished collecting timing info
2021-04-18 02:39:23.837224 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EE6F148>]}
2021-04-18 02:39:23.837224 (Thread-1): 23:39:23 | 8 of 11 OK created view model dbt_isadora.dim_customers.............. [OK in 2.44s]
2021-04-18 02:39:23.839218 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 02:39:23.839218 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-18 02:39:23.840219 (Thread-1): 23:39:23 | 9 of 11 START view model dbt_isadora.dim_employees................... [RUN]
2021-04-18 02:39:23.841215 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 02:39:23.841215 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-18 02:39:23.842214 (Thread-1): unclosed <socket.socket fd=1336, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61448), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:23.843209 (Thread-1): unclosed <socket.socket fd=1048, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61449), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:23.847200 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-18 02:39:23.848198 (Thread-1): finished collecting timing info
2021-04-18 02:39:23.851187 (Thread-1): unclosed <socket.socket fd=920, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61440), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:23.852184 (Thread-1): unclosed <socket.socket fd=1284, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61441), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:23.853181 (Thread-1): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61442), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:23.853181 (Thread-1): unclosed <socket.socket fd=960, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61443), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:23.854178 (Thread-1): unclosed <socket.socket fd=1156, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61444), raddr=('142.250.218.202', 443)>
2021-04-18 02:39:23.855175 (Thread-1): unclosed <socket.socket fd=1328, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61445), raddr=('142.250.79.202', 443)>
2021-04-18 02:39:23.874126 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-04-18 02:39:23.876121 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:23.888090 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
    )

    , transformed as (
        select
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:39:25.757157 (Thread-1): finished collecting timing info
2021-04-18 02:39:25.757157 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A2C0EC48>]}
2021-04-18 02:39:25.758162 (Thread-1): 23:39:25 | 9 of 11 OK created view model dbt_isadora.dim_employees.............. [OK in 1.92s]
2021-04-18 02:39:25.759121 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-18 02:39:25.760116 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-18 02:39:25.760116 (Thread-1): 23:39:25 | 10 of 11 START view model dbt_isadora.dim_products................... [RUN]
2021-04-18 02:39:25.761127 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 02:39:25.762111 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-18 02:39:25.768096 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-18 02:39:25.773082 (Thread-1): finished collecting timing info
2021-04-18 02:39:25.777070 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-18 02:39:25.779065 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:25.795022 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:39:27.676525 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/e6e89be9-9bd6-42c1-bf84-1c2b03213b0f?maxResults=0&location=US&prettyPrint=false: Unrecognized name: discontinued; Did you mean is_discontinued? at [23:26]')
2021-04-18 02:39:29.314032 (Thread-1): finished collecting timing info
2021-04-18 02:39:29.314032 (Thread-1): Database Error in model dim_products (models\marts\dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [23:26]
  compiled SQL at target\run\northwind_shop\models\marts\dim_products.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/6bfe9f4a-6c17-4cfa-9816-dcb7923730aa?maxResults=0&location=US&prettyPrint=false: Unrecognized name: discontinued; Did you mean is_discontinued? at [23:26]

(job ID: 6bfe9f4a-6c17-4cfa-9816-dcb7923730aa)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select
   9:            /*Primary Key*/
  10:            product_id
  11:
  12:            /*Foreign Keys*/
  13:            , category_id
  14:            , supplier_id
  15:
  16:            , product_name
  17:            , unit_price
  18:            , units_in_stock            
  19:            , quantity_per_unit
  20:            , units_on_order
  21:            , 
  22:                case
  23:                    when discontinued = 1 then true
  24:                    else false 
  25:                end as is_discontinued
  26:            , reorder_level
  27:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  28:    )
  29:
  30:    , transformed as (
  31:        select
  32:        row_number() over (order by product_id) as product_sk
  33:        , *
  34:        from selected
  35:    )
  36:
  37:    select * from transformed;
  38:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_products (models\marts\dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [23:26]
  compiled SQL at target\run\northwind_shop\models\marts\dim_products.sql
2021-04-18 02:39:29.332979 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A3C70FC8>]}
2021-04-18 02:39:29.332979 (Thread-1): 23:39:29 | 10 of 11 ERROR creating view model dbt_isadora.dim_products.......... [ERROR in 3.57s]
2021-04-18 02:39:29.333974 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-18 02:39:29.334973 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-18 02:39:29.336003 (Thread-1): 23:39:29 | 11 of 11 START view model dbt_isadora.dim_shippers................... [RUN]
2021-04-18 02:39:29.336968 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 02:39:29.336968 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-18 02:39:29.342950 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 02:39:29.344947 (Thread-1): finished collecting timing info
2021-04-18 02:39:29.350928 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 02:39:29.355917 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 02:39:29.372875 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:39:30.794835 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/b9880afb-c3bc-45a5-9e44-50548763b747?maxResults=0&location=US&prettyPrint=false: Unrecognized name: _sdc_extracted_at; Did you mean _sdc_batched_at? at [17:15]')
2021-04-18 02:39:32.714663 (Thread-1): finished collecting timing info
2021-04-18 02:39:32.716641 (Thread-1): Database Error in model dim_shippers (models\marts\dim_shippers.sql)
  Unrecognized name: _sdc_extracted_at; Did you mean _sdc_batched_at? at [17:15]
  compiled SQL at target\run\northwind_shop\models\marts\dim_shippers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/17f274f9-f02c-445a-824a-3d3718b2fc1e?maxResults=0&location=US&prettyPrint=false: Unrecognized name: _sdc_extracted_at; Did you mean _sdc_batched_at? at [17:15]

(job ID: 17f274f9-f02c-445a-824a-3d3718b2fc1e)

                                                             -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
   5:  OPTIONS()
   6:  as with
   7:    selected as (
   8:        select
   9:            /*Primary Key*/
  10:            shipper_id
  11:
  12:            , phone
  13:            , company_name
  14:
  15:           /*Stitch Columns*/
  16:            , _sdc_batched_at
  17:            , _sdc_extracted_at as last_etl_run
  18:            , _sdc_sequence
  19:            , _sdc_table_version
  20:            , _sdc_received_at
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  22:    )
  23:
  24:    , transformed as (
  25:        select
  26:        row_number() over (order by shipper_id) as shipper_sk
  27:        , *
  28:        from selected
  29:    )
  30:
  31:    select * from transformed;
  32:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_shippers (models\marts\dim_shippers.sql)
  Unrecognized name: _sdc_extracted_at; Did you mean _sdc_batched_at? at [17:15]
  compiled SQL at target\run\northwind_shop\models\marts\dim_shippers.sql
2021-04-18 02:39:32.723625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3411e4c6-11a3-4098-9617-69860ae37c0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A3DAF208>]}
2021-04-18 02:39:32.724628 (Thread-1): 23:39:32 | 11 of 11 ERROR creating view model dbt_isadora.dim_shippers.......... [ERROR in 3.39s]
2021-04-18 02:39:32.727568 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-18 02:39:32.792315 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:39:32.792315 (MainThread): 23:39:32 | 
2021-04-18 02:39:32.793769 (MainThread): 23:39:32 | Finished running 11 view models in 29.94s.
2021-04-18 02:39:32.794790 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:39:32.794790 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:39:32.794790 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:39:32.794790 (MainThread): Connection 'model.northwind_shop.dim_shippers' was properly closed.
2021-04-18 02:39:32.813738 (MainThread): 
2021-04-18 02:39:32.817730 (MainThread): Completed with 2 errors and 0 warnings:
2021-04-18 02:39:32.819722 (MainThread): 
2021-04-18 02:39:32.820720 (MainThread): Database Error in model dim_products (models\marts\dim_products.sql)
2021-04-18 02:39:32.821717 (MainThread):   Unrecognized name: discontinued; Did you mean is_discontinued? at [23:26]
2021-04-18 02:39:32.822714 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_products.sql
2021-04-18 02:39:32.823712 (MainThread): 
2021-04-18 02:39:32.824709 (MainThread): Database Error in model dim_shippers (models\marts\dim_shippers.sql)
2021-04-18 02:39:32.825706 (MainThread):   Unrecognized name: _sdc_extracted_at; Did you mean _sdc_batched_at? at [17:15]
2021-04-18 02:39:32.826704 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_shippers.sql
2021-04-18 02:39:32.827700 (MainThread): 
Done. PASS=9 WARN=0 ERROR=2 SKIP=0 TOTAL=11
2021-04-18 02:39:32.830697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EDDF1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002249EE54D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224A0DF7B08>]}
2021-04-18 02:39:32.834688 (MainThread): Flushing usage events
2021-04-18 02:40:39.243524 (MainThread): Running with dbt=0.19.1
2021-04-18 02:40:39.956958 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['with'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:40:39.956958 (MainThread): Tracking: tracking
2021-04-18 02:40:39.957952 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AB7FD8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AB804F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AB804F48>]}
2021-04-18 02:40:39.975904 (MainThread): Partial parsing not enabled
2021-04-18 02:40:39.978897 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:40:40.016760 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:40:40.029729 (MainThread): Parsing macros\etc.sql
2021-04-18 02:40:40.033715 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:40:40.041694 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:40:40.066630 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:40:40.071616 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:40:40.076572 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:40:40.096547 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:40:40.106523 (MainThread): Parsing macros\core.sql
2021-04-18 02:40:40.114502 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:40:40.199275 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:40:40.219219 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:40:40.221216 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:40:40.225204 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:40:40.229195 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:40:40.232185 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:40:40.235178 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:40:40.253131 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:40:40.281054 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:40:40.285046 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:40:40.297011 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:40:40.337909 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:40:40.403691 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:40:40.407680 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:40:40.441627 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:40:40.455588 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:40:40.465563 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:40:40.477530 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:40:40.483514 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:40:40.486508 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:40:40.490494 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:40:40.503429 (MainThread): Partial parsing not enabled
2021-04-18 02:40:40.552295 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:40:40.570281 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 02:40:40.578260 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 02:40:40.595123 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 02:40:40.602105 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:40:40.610083 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:40:40.617064 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:40:40.624045 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:40:40.631027 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:40:40.639006 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:40:40.646985 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:40:40.817529 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:40:40.821520 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9dc124d-3850-4315-a64d-051a59c2afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AF48EF08>]}
2021-04-18 02:40:40.843461 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9dc124d-3850-4315-a64d-051a59c2afd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AF46EC88>]}
2021-04-18 02:40:40.844459 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:40:40.848465 (MainThread): The selector 'with' does not match any nodes and will be ignored
2021-04-18 02:40:40.854432 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-04-18 02:40:40.856426 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AF46EC88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AF46E448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209AF46E4C8>]}
2021-04-18 02:40:40.856426 (MainThread): Flushing usage events
2021-04-18 02:40:41.728798 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-18 02:40:55.078945 (MainThread): Running with dbt=0.19.1
2021-04-18 02:40:55.799240 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_products'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:40:55.800273 (MainThread): Tracking: tracking
2021-04-18 02:40:55.801269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F99029F8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9902AB188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9902AB108>]}
2021-04-18 02:40:55.819221 (MainThread): Partial parsing not enabled
2021-04-18 02:40:55.822212 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:40:55.861075 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:40:55.874075 (MainThread): Parsing macros\etc.sql
2021-04-18 02:40:55.878062 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:40:55.887038 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:40:55.916924 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:40:55.922911 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:40:55.926900 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:40:55.947876 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:40:55.958846 (MainThread): Parsing macros\core.sql
2021-04-18 02:40:55.966825 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:40:56.053593 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:40:56.071513 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:40:56.074505 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:40:56.077497 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:40:56.082516 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:40:56.085507 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:40:56.087505 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:40:56.106453 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:40:56.137337 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:40:56.141323 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:40:56.155288 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:40:56.198207 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:40:56.271015 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:40:56.275001 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:40:56.310907 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:40:56.324870 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:40:56.335804 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:40:56.348803 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:40:56.354787 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:40:56.357780 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:40:56.361769 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:40:56.374737 (MainThread): Partial parsing not enabled
2021-04-18 02:40:56.419617 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:40:56.437566 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 02:40:56.444547 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 02:40:56.451532 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 02:40:56.459510 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:40:56.466490 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:40:56.473471 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:40:56.481416 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:40:56.489394 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:40:56.497372 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:40:56.505385 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:40:56.671908 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:40:56.676893 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35b1218a-236f-4aa0-8455-f45d1e7bc5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993E2AD48>]}
2021-04-18 02:40:56.705815 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35b1218a-236f-4aa0-8455-f45d1e7bc5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993D30E08>]}
2021-04-18 02:40:56.706812 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:40:56.709806 (MainThread): 
2021-04-18 02:40:56.711801 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:40:56.716804 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:40:56.717784 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:40:58.190295 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:40:58.190295 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:40:58.198310 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:40:59.678650 (MainThread): 23:40:59 | Concurrency: 1 threads (target='dev')
2021-04-18 02:40:59.680646 (MainThread): 23:40:59 | 
2021-04-18 02:40:59.692609 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-18 02:40:59.693609 (Thread-1): 23:40:59 | 1 of 1 START view model dbt_isadora.dim_products..................... [RUN]
2021-04-18 02:40:59.695600 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 02:40:59.695600 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-18 02:40:59.705577 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-18 02:40:59.710559 (Thread-1): finished collecting timing info
2021-04-18 02:40:59.826250 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-18 02:40:59.828245 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:40:59.838216 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:41:02.521677 (Thread-1): finished collecting timing info
2021-04-18 02:41:02.522673 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b1218a-236f-4aa0-8455-f45d1e7bc5b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993D914C8>]}
2021-04-18 02:41:02.522673 (Thread-1): 23:41:02 | 1 of 1 OK created view model dbt_isadora.dim_products................ [OK in 2.83s]
2021-04-18 02:41:02.524633 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-18 02:41:02.580325 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:41:02.580325 (MainThread): 23:41:02 | 
2021-04-18 02:41:02.581324 (MainThread): 23:41:02 | Finished running 1 view model in 5.87s.
2021-04-18 02:41:02.582319 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:41:02.582319 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:41:02.583318 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:41:02.583318 (MainThread): Connection 'model.northwind_shop.dim_products' was properly closed.
2021-04-18 02:41:02.597279 (MainThread): 
2021-04-18 02:41:02.599286 (MainThread): Completed successfully
2021-04-18 02:41:02.600273 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 02:41:02.601268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993D26CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F993D30E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F990320F08>]}
2021-04-18 02:41:02.602266 (MainThread): Flushing usage events
2021-04-18 02:41:19.201960 (MainThread): Running with dbt=0.19.1
2021-04-18 02:41:21.069964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_shippers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 02:41:21.070964 (MainThread): Tracking: tracking
2021-04-18 02:41:21.071960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002767221B248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027672214F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276722091C8>]}
2021-04-18 02:41:21.107863 (MainThread): Partial parsing not enabled
2021-04-18 02:41:21.119832 (MainThread): Parsing macros\adapters.sql
2021-04-18 02:41:21.220563 (MainThread): Parsing macros\catalog.sql
2021-04-18 02:41:21.250483 (MainThread): Parsing macros\etc.sql
2021-04-18 02:41:21.257463 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 02:41:21.287384 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 02:41:21.342236 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 02:41:21.358193 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 02:41:21.373154 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 02:41:21.419032 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 02:41:21.435986 (MainThread): Parsing macros\core.sql
2021-04-18 02:41:21.448952 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 02:41:21.556664 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 02:41:21.580637 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 02:41:21.582631 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 02:41:21.586584 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 02:41:21.591608 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 02:41:21.596560 (MainThread): Parsing macros\etc\query.sql
2021-04-18 02:41:21.599551 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 02:41:21.620529 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 02:41:21.672356 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 02:41:21.686317 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 02:41:21.800014 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 02:41:22.041368 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 02:41:22.149081 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 02:41:22.153070 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 02:41:22.221886 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 02:41:22.255794 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 02:41:22.283721 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 02:41:22.307656 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 02:41:22.324610 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 02:41:22.339571 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 02:41:22.353541 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 02:41:22.374478 (MainThread): Partial parsing not enabled
2021-04-18 02:41:22.504131 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 02:41:22.556007 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 02:41:22.574942 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 02:41:22.601872 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 02:41:22.620819 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 02:41:22.641763 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 02:41:22.667694 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 02:41:22.688638 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 02:41:22.709580 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 02:41:22.737508 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 02:41:22.754462 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 02:41:23.117492 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 02:41:23.121481 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9d65866-f6f4-4b20-898e-792ce9e3c01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027675D9AD88>]}
2021-04-18 02:41:23.174346 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9d65866-f6f4-4b20-898e-792ce9e3c01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027675CAB088>]}
2021-04-18 02:41:23.175338 (MainThread): Found 11 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 02:41:23.190299 (MainThread): 
2021-04-18 02:41:23.191296 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:41:23.200271 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 02:41:23.200271 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 02:41:24.085102 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 02:41:24.086100 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 02:41:24.097080 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 02:41:26.039844 (MainThread): 23:41:26 | Concurrency: 1 threads (target='dev')
2021-04-18 02:41:26.040844 (MainThread): 23:41:26 | 
2021-04-18 02:41:26.117639 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-18 02:41:26.118634 (Thread-1): 23:41:26 | 1 of 1 START view model dbt_isadora.dim_shippers..................... [RUN]
2021-04-18 02:41:26.121626 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 02:41:26.121626 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-18 02:41:26.129603 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 02:41:26.130602 (Thread-1): finished collecting timing info
2021-04-18 02:41:26.448752 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 02:41:26.450749 (Thread-1): Opening a new connection, currently in state init
2021-04-18 02:41:26.468698 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 02:41:29.029483 (Thread-1): finished collecting timing info
2021-04-18 02:41:29.031477 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9d65866-f6f4-4b20-898e-792ce9e3c01c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027675CD7E48>]}
2021-04-18 02:41:29.032474 (Thread-1): 23:41:29 | 1 of 1 OK created view model dbt_isadora.dim_shippers................ [OK in 2.91s]
2021-04-18 02:41:29.033470 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-18 02:41:29.100291 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 02:41:29.102286 (MainThread): 23:41:29 | 
2021-04-18 02:41:29.103283 (MainThread): 23:41:29 | Finished running 1 view model in 5.91s.
2021-04-18 02:41:29.104281 (MainThread): Connection 'master' was properly closed.
2021-04-18 02:41:29.104281 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 02:41:29.105279 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 02:41:29.106276 (MainThread): Connection 'model.northwind_shop.dim_shippers' was properly closed.
2021-04-18 02:41:29.132207 (MainThread): 
2021-04-18 02:41:29.133205 (MainThread): Completed successfully
2021-04-18 02:41:29.134202 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 02:41:29.137199 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027675CBAFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027675CBB888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027675DEBC88>]}
2021-04-18 02:41:29.145191 (MainThread): Flushing usage events
2021-04-18 03:00:32.515722 (MainThread): Running with dbt=0.19.1
2021-04-18 03:00:33.410173 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:00:33.412166 (MainThread): Tracking: tracking
2021-04-18 03:00:33.413203 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B01358D488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B01353B208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B01353B188>]}
2021-04-18 03:00:33.434172 (MainThread): Partial parsing not enabled
2021-04-18 03:00:33.438166 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:00:33.483196 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:00:33.497562 (MainThread): Parsing macros\etc.sql
2021-04-18 03:00:33.504508 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:00:33.514519 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:00:33.546397 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:00:33.553380 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:00:33.557368 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:00:33.580306 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:00:33.596773 (MainThread): Parsing macros\core.sql
2021-04-18 03:00:33.611734 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:00:33.710515 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:00:33.733408 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:00:33.737607 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:00:33.742047 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:00:33.747036 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:00:33.753023 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:00:33.757013 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:00:33.779961 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:00:33.813860 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:00:33.819846 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:00:33.833804 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:00:33.886663 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:00:33.959468 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:00:33.964456 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:00:34.008338 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:00:34.025292 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:00:34.038259 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:00:34.053221 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:00:34.059201 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:00:34.063192 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:00:34.068178 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:00:34.082143 (MainThread): Partial parsing not enabled
2021-04-18 03:00:34.138231 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:00:34.158177 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:00:34.166156 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:00:34.176127 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:00:34.203932 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:00:34.213867 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:00:34.224838 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:00:34.232817 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:00:34.242791 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:00:34.254794 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:00:34.263737 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:00:34.273017 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:00:34.461516 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:00:34.470491 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5f4cb96-9bb0-4da5-a0c4-550a672fa3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0171B9A08>]}
2021-04-18 03:00:34.506394 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5f4cb96-9bb0-4da5-a0c4-550a672fa3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B017020848>]}
2021-04-18 03:00:34.507392 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:00:34.515370 (MainThread): 
2021-04-18 03:00:34.516405 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:00:34.525346 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:00:34.525346 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:00:36.443027 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:00:36.445014 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:00:36.460963 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:00:37.858569 (MainThread): 00:00:37 | Concurrency: 1 threads (target='dev')
2021-04-18 03:00:37.860563 (MainThread): 00:00:37 | 
2021-04-18 03:00:37.884501 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:00:37.886496 (Thread-1): 00:00:37 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:00:37.893478 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:00:37.894514 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:00:37.912424 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:00:37.914420 (Thread-1): finished collecting timing info
2021-04-18 03:00:38.019138 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:00:38.022131 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:00:38.031105 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees
            select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products
            select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers
            select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
        
        left join customers on orders.customers_id=customers.customers_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

select * from orders;


2021-04-18 03:00:40.021600 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/a0d37236-7746-4847-a8fb-2b2ceda8b5cc?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected keyword AS but got keyword SELECT at [12:13]')
2021-04-18 03:00:41.915550 (Thread-1): finished collecting timing info
2021-04-18 03:00:41.916582 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: Expected keyword AS but got keyword SELECT at [12:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/df62cca6-7914-4416-a008-ad52125e54aa?maxResults=0&location=US&prettyPrint=false: Syntax error: Expected keyword AS but got keyword SELECT at [12:13]

(job ID: df62cca6-7914-4416-a008-ad52125e54aa)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees
  12:            select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products
  16:            select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers
  20:            select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:        
  41:        left join customers on orders.customers_id=customers.customers_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:select * from orders;
  47:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Syntax error: Expected keyword AS but got keyword SELECT at [12:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:00:41.954001 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5f4cb96-9bb0-4da5-a0c4-550a672fa3c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B016FEEC08>]}
2021-04-18 03:00:41.954996 (Thread-1): 00:00:41 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 4.06s]
2021-04-18 03:00:41.955991 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:00:42.050441 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:00:42.051467 (MainThread): 00:00:42 | 
2021-04-18 03:00:42.052474 (MainThread): 00:00:42 | Finished running 1 view model in 7.54s.
2021-04-18 03:00:42.053434 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:00:42.053434 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:00:42.054432 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:00:42.054432 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:00:42.064406 (MainThread): 
2021-04-18 03:00:42.064406 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:00:42.066399 (MainThread): 
2021-04-18 03:00:42.067399 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:00:42.069391 (MainThread):   Syntax error: Expected keyword AS but got keyword SELECT at [12:13]
2021-04-18 03:00:42.069391 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:00:42.070390 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:00:42.072385 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B017011348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B013565548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0135F1908>]}
2021-04-18 03:00:42.072385 (MainThread): Flushing usage events
2021-04-18 03:02:18.171877 (MainThread): Running with dbt=0.19.1
2021-04-18 03:02:18.986481 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:02:18.987480 (MainThread): Tracking: tracking
2021-04-18 03:02:18.988477 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104CEC2908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104CECB0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002104CECB208>]}
2021-04-18 03:02:19.007463 (MainThread): Partial parsing not enabled
2021-04-18 03:02:19.010458 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:02:19.055914 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:02:19.069878 (MainThread): Parsing macros\etc.sql
2021-04-18 03:02:19.073870 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:02:19.084807 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:02:19.111769 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:02:19.119710 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:02:19.123736 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:02:19.148674 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:02:19.160643 (MainThread): Parsing macros\core.sql
2021-04-18 03:02:19.171646 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:02:19.266398 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:02:19.286347 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:02:19.288342 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:02:19.292367 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:02:19.297318 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:02:19.302301 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:02:19.304296 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:02:19.325275 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:02:19.357190 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:02:19.361183 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:02:19.376140 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:02:19.422982 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:02:19.499908 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:02:19.503932 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:02:19.542225 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:02:19.558179 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:02:19.571144 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:02:19.585145 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:02:19.591131 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:02:19.595118 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:02:19.601102 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:02:19.614032 (MainThread): Partial parsing not enabled
2021-04-18 03:02:19.666888 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:02:19.688831 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:02:19.695846 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:02:19.707780 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:02:19.735726 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:02:19.746728 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:02:19.755672 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:02:19.765645 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:02:19.775619 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:02:19.785628 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:02:19.793571 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:02:19.803547 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:02:20.008992 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:02:20.018967 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79acffae-cf75-45eb-944e-055496086b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021050976B48>]}
2021-04-18 03:02:20.036918 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79acffae-cf75-45eb-944e-055496086b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210509BFE88>]}
2021-04-18 03:02:20.036918 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:02:20.043928 (MainThread): 
2021-04-18 03:02:20.044897 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:02:20.052879 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:02:20.053875 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:02:21.552725 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:02:21.553722 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:02:21.565689 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:02:22.380781 (MainThread): 00:02:22 | Concurrency: 1 threads (target='dev')
2021-04-18 03:02:22.382775 (MainThread): 00:02:22 | 
2021-04-18 03:02:22.392748 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:02:22.392748 (Thread-1): 00:02:22 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:02:22.394743 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:02:22.394743 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:02:22.407741 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:02:22.409706 (Thread-1): finished collecting timing info
2021-04-18 03:02:22.502454 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:02:22.503450 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:02:22.514421 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
        
        left join customers on orders.customers_id=customers.customers_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

select * from orders;


2021-04-18 03:02:24.308282 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/f7198439-d64f-4719-aa12-598cfba0e930?maxResults=0&location=US&prettyPrint=false: Table name "orders" missing dataset while no default dataset is set in the request.')
2021-04-18 03:02:26.190341 (Thread-1): finished collecting timing info
2021-04-18 03:02:26.192335 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Table name "orders" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/b1d0c8b0-7f0a-4f4e-9272-18a1051f4c5b?maxResults=0&location=US&prettyPrint=false: Table name "orders" missing dataset while no default dataset is set in the request.

(job ID: b1d0c8b0-7f0a-4f4e-9272-18a1051f4c5b)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:        
  41:        left join customers on orders.customers_id=customers.customers_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:select * from orders;
  47:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Table name "orders" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:02:26.213265 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79acffae-cf75-45eb-944e-055496086b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021050B1BE08>]}
2021-04-18 03:02:26.214264 (Thread-1): 00:02:26 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.82s]
2021-04-18 03:02:26.216257 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:02:26.238200 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:02:26.239202 (MainThread): 00:02:26 | 
2021-04-18 03:02:26.240193 (MainThread): 00:02:26 | Finished running 1 view model in 6.19s.
2021-04-18 03:02:26.240193 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:02:26.241191 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:02:26.241191 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:02:26.241191 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:02:26.258156 (MainThread): 
2021-04-18 03:02:26.259142 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:02:26.260140 (MainThread): 
2021-04-18 03:02:26.261140 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:02:26.266133 (MainThread):   Table name "orders" missing dataset while no default dataset is set in the request.
2021-04-18 03:02:26.267121 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:02:26.269115 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:02:26.271110 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021050B66788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021050A98D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021050A49C48>]}
2021-04-18 03:02:26.271110 (MainThread): Flushing usage events
2021-04-18 03:04:39.855221 (MainThread): Running with dbt=0.19.1
2021-04-18 03:04:41.691694 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:04:41.692693 (MainThread): Tracking: tracking
2021-04-18 03:04:41.693689 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B003975A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B003985EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B003985E08>]}
2021-04-18 03:04:41.716627 (MainThread): Partial parsing not enabled
2021-04-18 03:04:41.724606 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:04:41.796414 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:04:41.816361 (MainThread): Parsing macros\etc.sql
2021-04-18 03:04:41.825338 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:04:41.834312 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:04:41.890188 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:04:41.901135 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:04:41.912105 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:04:41.955008 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:04:41.977928 (MainThread): Parsing macros\core.sql
2021-04-18 03:04:41.991892 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:04:42.183380 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:04:42.217289 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:04:42.223273 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:04:42.228260 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:04:42.232248 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:04:42.237249 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:04:42.240227 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:04:42.262170 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:04:42.297112 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:04:42.301109 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:04:42.316067 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:04:42.384840 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:04:42.507630 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:04:42.513134 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:04:42.559808 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:04:42.579755 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:04:42.592719 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:04:42.608677 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:04:42.614661 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:04:42.617651 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:04:42.625227 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:04:42.643179 (MainThread): Partial parsing not enabled
2021-04-18 03:04:42.723962 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:04:42.746900 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:04:42.757872 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:04:42.766847 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:04:42.776821 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:04:42.789787 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:04:42.797763 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:04:42.808769 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:04:42.816750 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:04:42.828683 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:04:42.838655 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:04:42.846669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:04:43.077558 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:04:43.093519 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e437e66a-5ce4-44e7-b258-c1dea4d8dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00761DFC8>]}
2021-04-18 03:04:43.133982 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e437e66a-5ce4-44e7-b258-c1dea4d8dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0075CBC88>]}
2021-04-18 03:04:43.133982 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:04:43.150937 (MainThread): 
2021-04-18 03:04:43.156926 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:04:43.165910 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:04:43.165910 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:04:44.296407 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:04:44.296407 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:04:44.309375 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:04:45.325504 (MainThread): 00:04:45 | Concurrency: 1 threads (target='dev')
2021-04-18 03:04:45.326501 (MainThread): 00:04:45 | 
2021-04-18 03:04:45.332485 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:04:45.333481 (Thread-1): 00:04:45 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:04:45.335479 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:04:45.337481 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:04:45.363403 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:04:45.367391 (Thread-1): finished collecting timing info
2021-04-18 03:04:45.478094 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:04:45.479090 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:04:45.488068 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
        
        left join customers on orders.customers_id=customers.customers_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

select * from orders;


2021-04-18 03:04:47.039952 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/188cf073-3f1d-4491-a656-469c256e37fa?maxResults=0&location=US&prettyPrint=false: Table name "orders" missing dataset while no default dataset is set in the request.')
2021-04-18 03:04:48.905699 (Thread-1): finished collecting timing info
2021-04-18 03:04:48.906697 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Table name "orders" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/0a53c37c-856a-4145-aa1d-869980327ddd?maxResults=0&location=US&prettyPrint=false: Table name "orders" missing dataset while no default dataset is set in the request.

(job ID: 0a53c37c-856a-4145-aa1d-869980327ddd)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:        
  41:        left join customers on orders.customers_id=customers.customers_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:select * from orders;
  47:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Table name "orders" missing dataset while no default dataset is set in the request.
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:04:48.917665 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e437e66a-5ce4-44e7-b258-c1dea4d8dbc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0074FDFC8>]}
2021-04-18 03:04:48.918663 (Thread-1): 00:04:48 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.58s]
2021-04-18 03:04:48.920657 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:04:48.977989 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:04:48.978979 (MainThread): 00:04:48 | 
2021-04-18 03:04:48.979982 (MainThread): 00:04:48 | Finished running 1 view model in 5.83s.
2021-04-18 03:04:48.980975 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:04:48.980975 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:04:48.981972 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:04:48.981972 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:04:49.007903 (MainThread): 
2021-04-18 03:04:49.007903 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:04:49.009902 (MainThread): 
2021-04-18 03:04:49.010895 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:04:49.015881 (MainThread):   Table name "orders" missing dataset while no default dataset is set in the request.
2021-04-18 03:04:49.031838 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:04:49.038820 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:04:49.042811 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B003A3B688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00740DD48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B00744B648>]}
2021-04-18 03:04:49.043806 (MainThread): Flushing usage events
2021-04-18 03:06:18.734887 (MainThread): Running with dbt=0.19.1
2021-04-18 03:06:19.650441 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:06:19.651437 (MainThread): Tracking: tracking
2021-04-18 03:06:19.652437 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201CB0E708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201A8BB188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201A8BB0C8>]}
2021-04-18 03:06:19.669392 (MainThread): Partial parsing not enabled
2021-04-18 03:06:19.674377 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:06:19.714272 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:06:19.727234 (MainThread): Parsing macros\etc.sql
2021-04-18 03:06:19.731223 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:06:19.741197 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:06:19.766131 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:06:19.772150 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:06:19.776139 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:06:19.795088 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:06:19.807025 (MainThread): Parsing macros\core.sql
2021-04-18 03:06:19.816032 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:06:19.904800 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:06:19.921750 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:06:19.924742 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:06:19.927734 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:06:19.931723 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:06:19.935714 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:06:19.937707 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:06:19.955659 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:06:19.984584 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:06:19.988571 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:06:20.000541 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:06:20.049409 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:06:20.117194 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:06:20.120221 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:06:20.156123 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:06:20.172047 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:06:20.183061 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:06:20.195981 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:06:20.202000 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:06:20.205994 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:06:20.209980 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:06:20.221912 (MainThread): Partial parsing not enabled
2021-04-18 03:06:20.268825 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:06:20.287776 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:06:20.294752 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:06:20.301734 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:06:20.318654 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:06:20.328629 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:06:20.336606 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:06:20.343587 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:06:20.351569 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:06:20.361541 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:06:20.368520 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:06:20.376499 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:06:20.553027 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:06:20.558016 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '801d288f-2acd-4d97-a3f5-30a5b5632400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E382A88>]}
2021-04-18 03:06:20.577979 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '801d288f-2acd-4d97-a3f5-30a5b5632400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E39FB08>]}
2021-04-18 03:06:20.578960 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:06:20.583947 (MainThread): 
2021-04-18 03:06:20.585944 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:06:20.587934 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:06:20.588935 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:06:22.052340 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:06:22.053300 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:06:22.060280 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:06:23.465314 (MainThread): 00:06:23 | Concurrency: 1 threads (target='dev')
2021-04-18 03:06:23.467312 (MainThread): 00:06:23 | 
2021-04-18 03:06:23.480269 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:06:23.481273 (Thread-1): 00:06:23 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:06:23.483263 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:06:23.483263 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:06:23.495231 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:06:23.497225 (Thread-1): finished collecting timing info
2021-04-18 03:06:23.573022 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:06:23.574020 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:06:23.582994 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
        
        left join customers on orders.customers_id=customers.customers_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

select * from orders_with_sk;


2021-04-18 03:06:25.532218 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/e21ea3a9-f305-4d56-a9f9-259662c2444c?maxResults=0&location=US&prettyPrint=false: Name customers_id not found inside orders at [41:39]')
2021-04-18 03:06:26.688109 (Thread-1): finished collecting timing info
2021-04-18 03:06:26.688109 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name customers_id not found inside orders at [41:39]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/218f8e14-8654-4b6c-91ed-a3a9f318a6e4?maxResults=0&location=US&prettyPrint=false: Name customers_id not found inside orders at [41:39]

(job ID: 218f8e14-8654-4b6c-91ed-a3a9f318a6e4)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:        
  41:        left join customers on orders.customers_id=customers.customers_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:select * from orders_with_sk;
  47:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Name customers_id not found inside orders at [41:39]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:06:26.713007 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '801d288f-2acd-4d97-a3f5-30a5b5632400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E441EC8>]}
2021-04-18 03:06:26.714004 (Thread-1): 00:06:26 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.23s]
2021-04-18 03:06:26.714997 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:06:26.774865 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:06:26.774865 (MainThread): 00:06:26 | 
2021-04-18 03:06:26.776056 (MainThread): 00:06:26 | Finished running 1 view model in 6.19s.
2021-04-18 03:06:26.777076 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:06:26.777076 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:06:26.777076 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:06:26.778074 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:06:26.789044 (MainThread): 
2021-04-18 03:06:26.790045 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:06:26.794037 (MainThread): 
2021-04-18 03:06:26.795027 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:06:26.797024 (MainThread):   Name customers_id not found inside orders at [41:39]
2021-04-18 03:06:26.798020 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:06:26.801042 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:06:26.803009 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201A940F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201E543888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201A949B08>]}
2021-04-18 03:06:26.804010 (MainThread): Flushing usage events
2021-04-18 03:07:38.203099 (MainThread): Running with dbt=0.19.1
2021-04-18 03:07:38.911777 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:07:38.912776 (MainThread): Tracking: tracking
2021-04-18 03:07:38.912776 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F5709308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F37B4A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F37BB088>]}
2021-04-18 03:07:38.930727 (MainThread): Partial parsing not enabled
2021-04-18 03:07:38.933719 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:07:38.974647 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:07:38.987613 (MainThread): Parsing macros\etc.sql
2021-04-18 03:07:38.991567 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:07:39.002537 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:07:39.033454 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:07:39.039471 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:07:39.043460 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:07:39.064371 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:07:39.076341 (MainThread): Parsing macros\core.sql
2021-04-18 03:07:39.085316 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:07:39.174078 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:07:39.194026 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:07:39.197018 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:07:39.200009 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:07:39.204996 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:07:39.208985 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:07:39.211978 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:07:39.230925 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:07:39.259849 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:07:39.264836 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:07:39.277835 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:07:39.324675 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:07:39.407454 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:07:39.412441 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:07:39.447347 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:07:39.462305 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:07:39.472279 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:07:39.487241 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:07:39.494222 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:07:39.498212 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:07:39.502201 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:07:39.518159 (MainThread): Partial parsing not enabled
2021-04-18 03:07:39.566028 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:07:39.587007 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:07:39.593989 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:07:39.601967 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:07:39.619124 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:07:39.630094 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:07:39.638071 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:07:39.645052 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:07:39.653031 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:07:39.662009 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:07:39.670985 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:07:39.678965 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:07:39.843558 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:07:39.848509 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ed48e15-cd73-48b8-bb98-c0456b105de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F740DE48>]}
2021-04-18 03:07:39.874440 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ed48e15-cd73-48b8-bb98-c0456b105de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F73BBB88>]}
2021-04-18 03:07:39.874440 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:07:39.880425 (MainThread): 
2021-04-18 03:07:39.881421 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:07:39.886408 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:07:39.888406 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:07:41.026442 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:07:41.026442 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:07:41.034421 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:07:42.457689 (MainThread): 00:07:42 | Concurrency: 1 threads (target='dev')
2021-04-18 03:07:42.458687 (MainThread): 00:07:42 | 
2021-04-18 03:07:42.463675 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:07:42.463675 (Thread-1): 00:07:42 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:07:42.465670 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:07:42.465670 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:07:42.477678 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:07:42.478669 (Thread-1): finished collecting timing info
2021-04-18 03:07:42.560452 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:07:42.561447 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:07:42.572381 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
        
        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

select * from orders_with_sk;


2021-04-18 03:07:45.153736 (Thread-1): finished collecting timing info
2021-04-18 03:07:45.154733 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ed48e15-cd73-48b8-bb98-c0456b105de5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F6C7E588>]}
2021-04-18 03:07:45.154733 (Thread-1): 00:07:45 | 1 of 1 OK created view model dbt_isadora.fact_order_details.......... [OK in 2.69s]
2021-04-18 03:07:45.156909 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:07:45.224162 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:07:45.224162 (MainThread): 00:07:45 | 
2021-04-18 03:07:45.225196 (MainThread): 00:07:45 | Finished running 1 view model in 5.34s.
2021-04-18 03:07:45.227154 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:07:45.227154 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:07:45.227154 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:07:45.228150 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:07:45.244110 (MainThread): 
2021-04-18 03:07:45.245103 (MainThread): Completed successfully
2021-04-18 03:07:45.246101 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 03:07:45.247098 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F7312108>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F3838CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267F741EC48>]}
2021-04-18 03:07:45.248096 (MainThread): Flushing usage events
2021-04-18 03:27:43.408317 (MainThread): Running with dbt=0.19.1
2021-04-18 03:27:44.241160 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:27:44.242840 (MainThread): Tracking: tracking
2021-04-18 03:27:44.243880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285B838708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285BF50EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285BF50FC8>]}
2021-04-18 03:27:44.263788 (MainThread): Partial parsing not enabled
2021-04-18 03:27:44.266748 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:27:44.307349 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:27:44.320310 (MainThread): Parsing macros\etc.sql
2021-04-18 03:27:44.324945 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:27:44.333959 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:27:44.358857 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:27:44.364879 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:27:44.368831 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:27:44.389776 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:27:44.400747 (MainThread): Parsing macros\core.sql
2021-04-18 03:27:44.408994 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:27:44.496799 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:27:44.515557 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:27:44.517590 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:27:44.522309 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:27:44.526336 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:27:44.530328 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:27:44.533284 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:27:44.551270 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:27:44.579194 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:27:44.583854 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:27:44.596824 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:27:44.638712 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:27:44.707628 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:27:44.711671 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:27:44.746744 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:27:44.761149 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:27:44.773125 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:27:44.787879 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:27:44.793866 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:27:44.796859 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:27:44.801848 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:27:44.816809 (MainThread): Partial parsing not enabled
2021-04-18 03:27:44.865674 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:27:44.884624 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:27:44.892637 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:27:44.900259 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:27:44.908237 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:27:44.920205 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:27:44.928184 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:27:44.936909 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:27:44.944888 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:27:44.953863 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:27:44.962421 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:27:44.969396 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:27:45.133922 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:27:45.140903 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7996d5d-7d7f-41e0-8318-2b225cbcfd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285BFC9AC8>]}
2021-04-18 03:27:45.160851 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7996d5d-7d7f-41e0-8318-2b225cbcfd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285FA50BC8>]}
2021-04-18 03:27:45.160851 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:27:45.166841 (MainThread): 
2021-04-18 03:27:45.168830 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:27:45.171820 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:27:45.171820 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:27:46.401636 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:27:46.401636 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:27:46.409647 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:27:47.877595 (MainThread): 00:27:47 | Concurrency: 1 threads (target='dev')
2021-04-18 03:27:47.878642 (MainThread): 00:27:47 | 
2021-04-18 03:27:47.884596 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:27:47.885593 (Thread-1): 00:27:47 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:27:47.887589 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:27:47.887589 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:27:47.897584 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:27:47.900555 (Thread-1): finished collecting timing info
2021-04-18 03:27:47.983332 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:27:47.985327 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:27:47.994304 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_id
            , products.product_sk as product_fk
            , discount
            , unit_price
            , quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:27:49.993595 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/a17d64df-24cc-4d62-a5ff-c57df4215e63?maxResults=0&location=US&prettyPrint=false: Column name unit_price is ambiguous at [51:15]')
2021-04-18 03:27:51.912726 (Thread-1): finished collecting timing info
2021-04-18 03:27:51.913701 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Column name unit_price is ambiguous at [51:15]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/16bccfb8-1767-4f65-a39b-1c3d1ce1c7a7?maxResults=0&location=US&prettyPrint=false: Column name unit_price is ambiguous at [51:15]

(job ID: 16bccfb8-1767-4f65-a39b-1c3d1ce1c7a7)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_id
  49:            , products.product_sk as product_fk
  50:            , discount
  51:            , unit_price
  52:            , quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Column name unit_price is ambiguous at [51:15]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:27:51.943550 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7996d5d-7d7f-41e0-8318-2b225cbcfd7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285FA0D948>]}
2021-04-18 03:27:51.944546 (Thread-1): 00:27:51 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 4.06s]
2021-04-18 03:27:51.945508 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:27:51.957479 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:27:51.957479 (MainThread): 00:27:51 | 
2021-04-18 03:27:51.958473 (MainThread): 00:27:51 | Finished running 1 view model in 6.79s.
2021-04-18 03:27:51.960477 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:27:51.960477 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:27:51.962478 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:27:51.962478 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:27:51.977460 (MainThread): 
2021-04-18 03:27:51.978418 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:27:51.979418 (MainThread): 
2021-04-18 03:27:51.981417 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:27:51.983407 (MainThread):   Column name unit_price is ambiguous at [51:15]
2021-04-18 03:27:51.984403 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:27:51.985401 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:27:51.987396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285FA21E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285BFC9B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001285FBDDB88>]}
2021-04-18 03:27:51.988393 (MainThread): Flushing usage events
2021-04-18 03:29:51.099642 (MainThread): Running with dbt=0.19.1
2021-04-18 03:29:51.784115 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:29:51.785080 (MainThread): Tracking: tracking
2021-04-18 03:29:51.785080 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227368F48C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022736904988>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022736904DC8>]}
2021-04-18 03:29:51.803035 (MainThread): Partial parsing not enabled
2021-04-18 03:29:51.806025 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:29:51.843958 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:29:51.856923 (MainThread): Parsing macros\etc.sql
2021-04-18 03:29:51.860877 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:29:51.869886 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:29:51.894784 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:29:51.900771 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:29:51.905759 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:29:51.932718 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:29:51.945649 (MainThread): Parsing macros\core.sql
2021-04-18 03:29:51.953665 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:29:52.044388 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:29:52.062376 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:29:52.064369 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:29:52.068356 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:29:52.072348 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:29:52.076335 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:29:52.078333 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:29:52.096284 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:29:52.126166 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:29:52.131191 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:29:52.145119 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:29:52.190996 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:29:52.259811 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:29:52.264799 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:29:52.300700 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:29:52.314665 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:29:52.325633 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:29:52.339598 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:29:52.346581 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:29:52.350569 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:29:52.354558 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:29:52.369519 (MainThread): Partial parsing not enabled
2021-04-18 03:29:52.415430 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:29:52.434380 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:29:52.441324 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:29:52.448305 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:29:52.467488 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:29:52.477464 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:29:52.485441 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:29:52.492422 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:29:52.500403 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:29:52.509413 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:29:52.516395 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:29:52.525336 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:29:52.687901 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:29:52.712833 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16956a69-0eef-4a56-850d-bc6c22229cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273A55CE88>]}
2021-04-18 03:29:52.737767 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16956a69-0eef-4a56-850d-bc6c22229cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273A3A3988>]}
2021-04-18 03:29:52.738770 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:29:52.745748 (MainThread): 
2021-04-18 03:29:52.746742 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:29:52.750735 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:29:52.750735 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:29:54.313721 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:29:54.313721 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:29:54.321699 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:29:55.870765 (MainThread): 00:29:55 | Concurrency: 1 threads (target='dev')
2021-04-18 03:29:55.871761 (MainThread): 00:29:55 | 
2021-04-18 03:29:55.876749 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:29:55.877747 (Thread-1): 00:29:55 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:29:55.879740 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:29:55.879740 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:29:55.892708 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:29:55.894700 (Thread-1): finished collecting timing info
2021-04-18 03:29:56.003409 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:29:56.004406 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:29:56.018370 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:29:57.513273 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/77493f06-b91a-4003-9343-e95dddf5ef01?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]')
2021-04-18 03:29:59.432259 (Thread-1): finished collecting timing info
2021-04-18 03:29:59.435251 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/a82bc968-d035-4a40-98b2-85b6f9a12652?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]

(job ID: a82bc968-d035-4a40-98b2-85b6f9a12652)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_details.order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:29:59.454113 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16956a69-0eef-4a56-850d-bc6c22229cb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273A44EA48>]}
2021-04-18 03:29:59.455110 (Thread-1): 00:29:59 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.58s]
2021-04-18 03:29:59.456107 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:29:59.525355 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:29:59.526349 (MainThread): 00:29:59 | 
2021-04-18 03:29:59.528314 (MainThread): 00:29:59 | Finished running 1 view model in 6.78s.
2021-04-18 03:29:59.531317 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:29:59.531317 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:29:59.531317 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:29:59.532337 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:29:59.543272 (MainThread): 
2021-04-18 03:29:59.544270 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:29:59.545269 (MainThread): 
2021-04-18 03:29:59.546265 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:29:59.547260 (MainThread):   Unrecognized name: order_details at [58:13]
2021-04-18 03:29:59.550255 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:29:59.552253 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:29:59.556237 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273A55CE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273A4C02C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002273A444CC8>]}
2021-04-18 03:29:59.557234 (MainThread): Flushing usage events
2021-04-18 03:35:16.748857 (MainThread): Running with dbt=0.19.1
2021-04-18 03:35:17.430873 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:35:17.431874 (MainThread): Tracking: tracking
2021-04-18 03:35:17.432869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2032B048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC2036D5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC20322F08>]}
2021-04-18 03:35:17.451822 (MainThread): Partial parsing not enabled
2021-04-18 03:35:17.454809 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:35:17.494671 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:35:17.507636 (MainThread): Parsing macros\etc.sql
2021-04-18 03:35:17.512623 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:35:17.520599 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:35:17.551519 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:35:17.557501 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:35:17.561490 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:35:17.586423 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:35:17.597393 (MainThread): Parsing macros\core.sql
2021-04-18 03:35:17.606373 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:35:17.692178 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:35:17.710127 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:35:17.712122 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:35:17.715114 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:35:17.720101 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:35:17.723093 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:35:17.725087 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:35:17.743044 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:35:17.771964 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:35:17.775952 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:35:17.789881 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:35:17.833761 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:35:17.900618 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:35:17.904607 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:35:17.941509 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:35:17.955474 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:35:17.965444 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:35:17.978411 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:35:17.984394 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:35:17.987388 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:35:17.991376 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:35:18.005308 (MainThread): Partial parsing not enabled
2021-04-18 03:35:18.056170 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:35:18.075154 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:35:18.084127 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:35:18.091112 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:35:18.111781 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:35:18.122751 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:35:18.130730 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:35:18.138708 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:35:18.145687 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:35:18.153666 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:35:18.162645 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:35:18.170623 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:35:18.344159 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:35:18.351142 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd487b1d0-806a-4922-b1c7-13e5b8f31806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC23FA8D08>]}
2021-04-18 03:35:18.373082 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd487b1d0-806a-4922-b1c7-13e5b8f31806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC23E0FD88>]}
2021-04-18 03:35:18.374079 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:35:18.381060 (MainThread): 
2021-04-18 03:35:18.382057 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:35:18.385050 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:35:18.386047 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:35:19.430791 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:35:19.431757 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:35:19.446704 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:35:20.828263 (MainThread): 00:35:20 | Concurrency: 1 threads (target='dev')
2021-04-18 03:35:20.829258 (MainThread): 00:35:20 | 
2021-04-18 03:35:20.835242 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:35:20.835242 (Thread-1): 00:35:20 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:35:20.836257 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:35:20.837241 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:35:20.850203 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:35:20.852198 (Thread-1): finished collecting timing info
2021-04-18 03:35:20.932983 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:35:20.933981 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:35:20.945945 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_detail_with_sk as (
        select
            order_detail.order_id
            , products.product_sk as product_fk
            , order_detail.discount
            , order_detail.unit_price
            , order_detail.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_detail
            left join products on order_detail.product_id = products.product_id
    )
    , final as (
        select
            order_detail.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_detail_with_sk.product_fk
            , order_detail_with_sk.discount
            , order_detail_with_sk.unit_price
            , order_detail_with_sk.quantity
            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:35:22.346140 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/1183e8de-1d4b-407b-94f4-08ce41cd1825?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]')
2021-04-18 03:35:24.188723 (Thread-1): finished collecting timing info
2021-04-18 03:35:24.189694 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/c97c3bc1-14ec-466d-8f82-3406903fe71d?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]

(job ID: c97c3bc1-14ec-466d-8f82-3406903fe71d)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_detail_with_sk as (
  47:        select
  48:            order_detail.order_id
  49:            , products.product_sk as product_fk
  50:            , order_detail.discount
  51:            , order_detail.unit_price
  52:            , order_detail.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_detail
  54:            left join products on order_detail.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_detail.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_detail_with_sk.product_fk
  73:            , order_detail_with_sk.discount
  74:            , order_detail_with_sk.unit_price
  75:            , order_detail_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_detail_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:35:24.197673 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd487b1d0-806a-4922-b1c7-13e5b8f31806', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC23E02708>]}
2021-04-18 03:35:24.198672 (Thread-1): 00:35:24 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.36s]
2021-04-18 03:35:24.199633 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:35:24.231176 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:35:24.232173 (MainThread): 00:35:24 | 
2021-04-18 03:35:24.232173 (MainThread): 00:35:24 | Finished running 1 view model in 5.85s.
2021-04-18 03:35:24.233170 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:35:24.233170 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:35:24.234171 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:35:24.234171 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:35:24.250160 (MainThread): 
2021-04-18 03:35:24.251122 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:35:24.252120 (MainThread): 
2021-04-18 03:35:24.253118 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:35:24.254114 (MainThread):   Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]
2021-04-18 03:35:24.257123 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:35:24.260109 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:35:24.264087 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC203B3808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC203E8448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CC20350688>]}
2021-04-18 03:35:24.265085 (MainThread): Flushing usage events
2021-04-18 03:35:50.740291 (MainThread): Running with dbt=0.19.1
2021-04-18 03:35:51.422605 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:35:51.423603 (MainThread): Tracking: tracking
2021-04-18 03:35:51.424601 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750390F6C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017503A159C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017503A15DC8>]}
2021-04-18 03:35:51.443584 (MainThread): Partial parsing not enabled
2021-04-18 03:35:51.446540 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:35:51.486431 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:35:51.499397 (MainThread): Parsing macros\etc.sql
2021-04-18 03:35:51.503386 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:35:51.512362 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:35:51.539293 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:35:51.546277 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:35:51.550264 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:35:51.570207 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:35:51.582179 (MainThread): Parsing macros\core.sql
2021-04-18 03:35:51.591154 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:35:51.682944 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:35:51.699896 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:35:51.702856 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:35:51.705879 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:35:51.709869 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:35:51.713858 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:35:51.716853 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:35:51.734805 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:35:51.763726 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:35:51.767717 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:35:51.779683 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:35:51.820576 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:35:51.886397 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:35:51.890391 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:35:51.926260 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:35:51.942216 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:35:51.954184 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:35:51.967184 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:35:51.972170 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:35:51.976160 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:35:51.979149 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:35:51.992080 (MainThread): Partial parsing not enabled
2021-04-18 03:35:52.039953 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:35:52.058936 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:35:52.065920 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:35:52.072899 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:35:52.081878 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:35:52.091850 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:35:52.099829 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:35:52.106809 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:35:52.126774 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:35:52.135750 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:35:52.142731 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:35:52.151676 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:35:52.349671 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:35:52.357648 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175076ADE88>]}
2021-04-18 03:35:52.389563 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175074FF6C8>]}
2021-04-18 03:35:52.389563 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:35:52.397545 (MainThread): 
2021-04-18 03:35:52.397545 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:35:52.401529 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:35:52.403535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:35:53.239729 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:35:53.240692 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:35:53.247672 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:35:54.085682 (MainThread): 00:35:54 | Concurrency: 1 threads (target='dev')
2021-04-18 03:35:54.087647 (MainThread): 00:35:54 | 
2021-04-18 03:35:54.093623 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 03:35:54.094620 (Thread-1): 00:35:54 | 1 of 12 START view model dbt_isadora.stg_customers................... [RUN]
2021-04-18 03:35:54.095621 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:35:54.095621 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 03:35:54.104596 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 03:35:54.105593 (Thread-1): finished collecting timing info
2021-04-18 03:35:54.181422 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 03:35:54.183382 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:35:54.192357 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 03:35:56.583938 (Thread-1): finished collecting timing info
2021-04-18 03:35:56.584938 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175074BD748>]}
2021-04-18 03:35:56.584938 (Thread-1): 00:35:56 | 1 of 12 OK created view model dbt_isadora.stg_customers.............. [OK in 2.49s]
2021-04-18 03:35:56.586897 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 03:35:56.586897 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 03:35:56.587895 (Thread-1): 00:35:56 | 2 of 12 START view model dbt_isadora.stg_employees................... [RUN]
2021-04-18 03:35:56.588889 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:35:56.589888 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 03:35:56.590886 (Thread-1): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61948), raddr=('172.217.29.10', 443)>
2021-04-18 03:35:56.591898 (Thread-1): unclosed <socket.socket fd=1084, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61949), raddr=('142.250.218.234', 443)>
2021-04-18 03:35:56.596869 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 03:35:56.598876 (Thread-1): finished collecting timing info
2021-04-18 03:35:56.606841 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 03:35:56.607840 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:35:56.620809 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 03:35:58.971544 (Thread-1): finished collecting timing info
2021-04-18 03:35:58.971544 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750773A708>]}
2021-04-18 03:35:58.972542 (Thread-1): 00:35:58 | 2 of 12 OK created view model dbt_isadora.stg_employees.............. [OK in 2.38s]
2021-04-18 03:35:58.973506 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 03:35:58.974501 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 03:35:58.975499 (Thread-1): 00:35:58 | 3 of 12 START view model dbt_isadora.stg_products.................... [RUN]
2021-04-18 03:35:58.976498 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:35:58.976498 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 03:35:58.982517 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 03:35:58.984474 (Thread-1): finished collecting timing info
2021-04-18 03:35:58.994450 (Thread-1): unclosed <socket.socket fd=1116, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61951), raddr=('142.250.218.234', 443)>
2021-04-18 03:35:58.995445 (Thread-1): unclosed <socket.socket fd=1120, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61950), raddr=('172.217.29.10', 443)>
2021-04-18 03:35:59.000429 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 03:35:59.002426 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:35:59.015392 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 03:36:01.487473 (Thread-1): finished collecting timing info
2021-04-18 03:36:01.488506 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175074BA548>]}
2021-04-18 03:36:01.488506 (Thread-1): 00:36:01 | 3 of 12 OK created view model dbt_isadora.stg_products............... [OK in 2.51s]
2021-04-18 03:36:01.490785 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 03:36:01.490785 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 03:36:01.491783 (Thread-1): 00:36:01 | 4 of 12 START view model dbt_isadora.stg_shippers.................... [RUN]
2021-04-18 03:36:01.492779 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:36:01.493777 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 03:36:01.499760 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 03:36:01.501756 (Thread-1): finished collecting timing info
2021-04-18 03:36:01.510732 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 03:36:01.512726 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:01.523700 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 03:36:04.088378 (Thread-1): finished collecting timing info
2021-04-18 03:36:04.090385 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175039CBE08>]}
2021-04-18 03:36:04.092379 (Thread-1): 00:36:04 | 4 of 12 OK created view model dbt_isadora.stg_shippers............... [OK in 2.60s]
2021-04-18 03:36:04.095323 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 03:36:04.096307 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 03:36:04.098307 (Thread-1): 00:36:04 | 5 of 12 START view model dbt_isadora.stg_order_details............... [RUN]
2021-04-18 03:36:04.100296 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:36:04.100296 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 03:36:04.102289 (Thread-1): unclosed <socket.socket fd=932, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61954), raddr=('172.217.29.10', 443)>
2021-04-18 03:36:04.103294 (Thread-1): unclosed <socket.socket fd=704, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61955), raddr=('142.250.218.234', 443)>
2021-04-18 03:36:04.109272 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 03:36:04.111266 (Thread-1): finished collecting timing info
2021-04-18 03:36:04.124230 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 03:36:04.126224 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:04.142182 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_detail`
    )

    select * from source;


2021-04-18 03:36:05.918481 (Thread-1): Unhandled error while running:
/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_detail`
    )

    select * from source;


2021-04-18 03:36:05.918481 (Thread-1): 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/3ad2587e-47ed-4de6-b97f-c2f0018109bf?maxResults=0&location=US&prettyPrint=false: Not found: Table tutorial-dbt-310721:northwind_etl.order_detail was not found in location US

(job ID: 3ad2587e-47ed-4de6-b97f-c2f0018109bf)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select
   9:	        /*Primary Key*/
  10:            order_id
  11:
  12:            /*Foreign Keys*/
  13:            , product_id
  14:
  15:            , discount
  16:            , unit_price
  17:            , quantity
  18:
  19:           /*Stitch Columns*/
  20:            , _sdc_batched_at
  21:            , _sdc_extracted_at as last_etl_run
  22:            , _sdc_sequence
  23:            , _sdc_table_version
  24:            , _sdc_received_at
  25:        from `tutorial-dbt-310721`.`northwind_etl`.`order_detail`
  26:    )
  27:
  28:    select * from source;
  29:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
2021-04-18 03:36:05.918481 (Thread-1): finished collecting timing info
2021-04-18 03:36:05.919480 (Thread-1): Runtime Error in model stg_order_details (models\staging\stg_order_details.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/3ad2587e-47ed-4de6-b97f-c2f0018109bf?maxResults=0&location=US&prettyPrint=false: Not found: Table tutorial-dbt-310721:northwind_etl.order_detail was not found in location US
  
  (job ID: 3ad2587e-47ed-4de6-b97f-c2f0018109bf)
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.NotFound: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/3ad2587e-47ed-4de6-b97f-c2f0018109bf?maxResults=0&location=US&prettyPrint=false: Not found: Table tutorial-dbt-310721:northwind_etl.order_detail was not found in location US

(job ID: 3ad2587e-47ed-4de6-b97f-c2f0018109bf)

                                                                -----Query Job SQL Follows-----                                                                

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
   5:  OPTIONS()
   6:  as with
   7:    source as (
   8:        select
   9:	        /*Primary Key*/
  10:            order_id
  11:
  12:            /*Foreign Keys*/
  13:            , product_id
  14:
  15:            , discount
  16:            , unit_price
  17:            , quantity
  18:
  19:           /*Stitch Columns*/
  20:            , _sdc_batched_at
  21:            , _sdc_extracted_at as last_etl_run
  22:            , _sdc_sequence
  23:            , _sdc_table_version
  24:            , _sdc_received_at
  25:        from `tutorial-dbt-310721`.`northwind_etl`.`order_detail`
  26:    )
  27:
  28:    select * from source;
  29:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 181, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error in model stg_order_details (models\staging\stg_order_details.sql)
  404 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/3ad2587e-47ed-4de6-b97f-c2f0018109bf?maxResults=0&location=US&prettyPrint=false: Not found: Table tutorial-dbt-310721:northwind_etl.order_detail was not found in location US
  
  (job ID: 3ad2587e-47ed-4de6-b97f-c2f0018109bf)
2021-04-18 03:36:05.928454 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017503A435C8>]}
2021-04-18 03:36:05.929452 (Thread-1): 00:36:05 | 5 of 12 ERROR creating view model dbt_isadora.stg_order_details...... [ERROR in 1.83s]
2021-04-18 03:36:05.930450 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 03:36:05.931452 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 03:36:05.932444 (Thread-1): 00:36:05 | 6 of 12 START view model dbt_isadora.stg_orders...................... [RUN]
2021-04-18 03:36:05.933446 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:36:05.934439 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 03:36:05.938463 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 03:36:05.939430 (Thread-1): finished collecting timing info
2021-04-18 03:36:05.944415 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 03:36:05.946407 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:05.960370 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 03:36:08.417464 (Thread-1): finished collecting timing info
2021-04-18 03:36:08.422488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017503A552C8>]}
2021-04-18 03:36:08.426439 (Thread-1): 00:36:08 | 6 of 12 OK created view model dbt_isadora.stg_orders................. [OK in 2.49s]
2021-04-18 03:36:08.446384 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 03:36:08.447383 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 03:36:08.447383 (Thread-1): 00:36:08 | 7 of 12 START view model dbt_isadora.stg_suppliers................... [RUN]
2021-04-18 03:36:08.451385 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:36:08.451385 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 03:36:08.470335 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 03:36:08.477303 (Thread-1): finished collecting timing info
2021-04-18 03:36:08.493259 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 03:36:08.495254 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:08.531157 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 03:36:11.009177 (Thread-1): finished collecting timing info
2021-04-18 03:36:11.010177 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750763D188>]}
2021-04-18 03:36:11.012169 (Thread-1): 00:36:11 | 7 of 12 OK created view model dbt_isadora.stg_suppliers.............. [OK in 2.56s]
2021-04-18 03:36:11.015161 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 03:36:11.018161 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 03:36:11.019151 (Thread-1): 00:36:11 | 8 of 12 START view model dbt_isadora.dim_customers................... [RUN]
2021-04-18 03:36:11.021147 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:36:11.022143 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 03:36:11.029124 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 03:36:11.031119 (Thread-1): finished collecting timing info
2021-04-18 03:36:11.041092 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 03:36:11.043087 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:11.061038 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:36:13.524994 (Thread-1): finished collecting timing info
2021-04-18 03:36:13.525990 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175075943C8>]}
2021-04-18 03:36:13.526987 (Thread-1): 00:36:13 | 8 of 12 OK created view model dbt_isadora.dim_customers.............. [OK in 2.50s]
2021-04-18 03:36:13.533968 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 03:36:13.533968 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-18 03:36:13.534966 (Thread-1): 00:36:13 | 9 of 12 START view model dbt_isadora.dim_employees................... [RUN]
2021-04-18 03:36:13.537959 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:36:13.537959 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-18 03:36:13.552918 (Thread-1): unclosed <socket.socket fd=1184, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61957), raddr=('142.250.218.234', 443)>
2021-04-18 03:36:13.553919 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61956), raddr=('172.217.29.10', 443)>
2021-04-18 03:36:13.553919 (Thread-1): unclosed <socket.socket fd=1212, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61958), raddr=('172.217.29.10', 443)>
2021-04-18 03:36:13.554912 (Thread-1): unclosed <socket.socket fd=432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61959), raddr=('142.250.218.234', 443)>
2021-04-18 03:36:13.555910 (Thread-1): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61962), raddr=('172.217.29.10', 443)>
2021-04-18 03:36:13.555910 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61963), raddr=('142.250.218.234', 443)>
2021-04-18 03:36:13.556907 (Thread-1): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61967), raddr=('172.217.29.10', 443)>
2021-04-18 03:36:13.556907 (Thread-1): unclosed <socket.socket fd=1248, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61970), raddr=('142.250.218.234', 443)>
2021-04-18 03:36:13.568877 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-18 03:36:13.571868 (Thread-1): finished collecting timing info
2021-04-18 03:36:13.578849 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-04-18 03:36:13.580842 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:13.602784 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
    )

    , transformed as (
        select
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:36:16.010020 (Thread-1): finished collecting timing info
2021-04-18 03:36:16.011019 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175074E8708>]}
2021-04-18 03:36:16.012017 (Thread-1): 00:36:16 | 9 of 12 OK created view model dbt_isadora.dim_employees.............. [OK in 2.47s]
2021-04-18 03:36:16.013011 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-18 03:36:16.014009 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-18 03:36:16.015009 (Thread-1): 00:36:16 | 10 of 12 START view model dbt_isadora.dim_products................... [RUN]
2021-04-18 03:36:16.018019 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:36:16.018019 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-18 03:36:16.020995 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61971), raddr=('172.217.29.10', 443)>
2021-04-18 03:36:16.020995 (Thread-1): unclosed <socket.socket fd=1296, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 61972), raddr=('142.250.218.234', 443)>
2021-04-18 03:36:16.027972 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-18 03:36:16.029967 (Thread-1): finished collecting timing info
2021-04-18 03:36:16.045923 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-18 03:36:16.053900 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:16.074845 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:36:17.867068 (Thread-1): finished collecting timing info
2021-04-18 03:36:17.867068 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175074AA088>]}
2021-04-18 03:36:17.868087 (Thread-1): 00:36:17 | 10 of 12 OK created view model dbt_isadora.dim_products.............. [OK in 1.85s]
2021-04-18 03:36:17.872053 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-18 03:36:17.872053 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-18 03:36:17.873052 (Thread-1): 00:36:17 | 11 of 12 START view model dbt_isadora.dim_shippers................... [RUN]
2021-04-18 03:36:17.875046 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:36:17.875046 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-18 03:36:17.884022 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 03:36:17.886017 (Thread-1): finished collecting timing info
2021-04-18 03:36:17.894993 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 03:36:17.899980 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:36:17.919943 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:36:20.328572 (Thread-1): finished collecting timing info
2021-04-18 03:36:20.329569 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8571d385-37fe-4b8e-920d-c50667314edd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001750763D188>]}
2021-04-18 03:36:20.330573 (Thread-1): 00:36:20 | 11 of 12 OK created view model dbt_isadora.dim_shippers.............. [OK in 2.46s]
2021-04-18 03:36:20.336553 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-18 03:36:20.337549 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:36:20.338546 (Thread-1): 00:36:20 | 12 of 12 SKIP relation dbt_isadora.fact_order_details................ [SKIP]
2021-04-18 03:36:20.340541 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:36:20.361485 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:36:20.362483 (MainThread): 00:36:20 | 
2021-04-18 03:36:20.363478 (MainThread): 00:36:20 | Finished running 12 view models in 27.96s.
2021-04-18 03:36:20.372476 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:36:20.373453 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:36:20.374453 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:36:20.374453 (MainThread): Connection 'model.northwind_shop.dim_shippers' was properly closed.
2021-04-18 03:36:20.405368 (MainThread): 
2021-04-18 03:36:20.407362 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:36:20.459223 (MainThread): 
2021-04-18 03:36:20.494132 (MainThread): Runtime Error in model stg_order_details (models\staging\stg_order_details.sql)
2021-04-18 03:36:20.513078 (MainThread):   404 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/3ad2587e-47ed-4de6-b97f-c2f0018109bf?maxResults=0&location=US&prettyPrint=false: Not found: Table tutorial-dbt-310721:northwind_etl.order_detail was not found in location US
2021-04-18 03:36:20.529198 (MainThread):   
2021-04-18 03:36:20.545715 (MainThread):   (job ID: 3ad2587e-47ed-4de6-b97f-c2f0018109bf)
2021-04-18 03:36:20.560674 (MainThread): 
Done. PASS=10 WARN=0 ERROR=1 SKIP=1 TOTAL=12
2021-04-18 03:36:20.574637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175059F7C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175059F7AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175074A5D88>]}
2021-04-18 03:36:20.574637 (MainThread): Flushing usage events
2021-04-18 03:38:40.512997 (MainThread): Running with dbt=0.19.1
2021-04-18 03:38:41.436046 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:38:41.437857 (MainThread): Tracking: tracking
2021-04-18 03:38:41.438858 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8D233548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8D226EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8D22C948>]}
2021-04-18 03:38:41.456810 (MainThread): Partial parsing not enabled
2021-04-18 03:38:41.460799 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:38:41.515388 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:38:41.529350 (MainThread): Parsing macros\etc.sql
2021-04-18 03:38:41.534337 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:38:41.547304 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:38:41.578222 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:38:41.585204 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:38:41.594181 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:38:41.627089 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:38:41.640398 (MainThread): Parsing macros\core.sql
2021-04-18 03:38:41.649417 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:38:41.756131 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:38:41.777040 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:38:41.780030 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:38:41.784261 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:38:41.790284 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:38:41.797231 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:38:41.802217 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:38:41.840116 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:38:41.895966 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:38:41.903944 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:38:41.929876 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:38:41.996696 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:38:42.119368 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:38:42.128345 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:38:42.201151 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:38:42.229076 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:38:42.251017 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:38:42.276948 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:38:42.288916 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:38:42.294901 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:38:42.302879 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:38:42.326814 (MainThread): Partial parsing not enabled
2021-04-18 03:38:42.426547 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:38:42.470430 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:38:42.488383 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:38:42.504340 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:38:42.576150 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:38:42.594099 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:38:42.610058 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:38:42.625017 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:38:42.641974 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:38:42.658934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:38:42.673909 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:38:42.684857 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:38:42.947157 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:38:42.954139 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90EB8C08>]}
2021-04-18 03:38:42.971092 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90D1FA48>]}
2021-04-18 03:38:42.972089 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:38:42.987052 (MainThread): 
2021-04-18 03:38:42.990043 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:38:42.998020 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:38:42.999017 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:38:43.897968 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:38:43.897968 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:38:43.909969 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:38:44.817135 (MainThread): 00:38:44 | Concurrency: 1 threads (target='dev')
2021-04-18 03:38:44.818133 (MainThread): 00:38:44 | 
2021-04-18 03:38:44.830100 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 03:38:44.831119 (Thread-1): 00:38:44 | 1 of 12 START view model dbt_isadora.stg_customers................... [RUN]
2021-04-18 03:38:44.832096 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:38:44.832096 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 03:38:44.842070 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 03:38:44.843065 (Thread-1): finished collecting timing info
2021-04-18 03:38:44.948784 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 03:38:44.950777 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:38:44.963742 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 03:38:47.407928 (Thread-1): finished collecting timing info
2021-04-18 03:38:47.408925 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90CF04C8>]}
2021-04-18 03:38:47.409923 (Thread-1): 00:38:47 | 1 of 12 OK created view model dbt_isadora.stg_customers.............. [OK in 2.58s]
2021-04-18 03:38:47.410924 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 03:38:47.410924 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 03:38:47.411919 (Thread-1): 00:38:47 | 2 of 12 START view model dbt_isadora.stg_employees................... [RUN]
2021-04-18 03:38:47.413931 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:38:47.413931 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 03:38:47.414911 (Thread-1): unclosed <socket.socket fd=380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62003), raddr=('172.217.29.10', 443)>
2021-04-18 03:38:47.415912 (Thread-1): unclosed <socket.socket fd=1020, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62004), raddr=('142.250.218.234', 443)>
2021-04-18 03:38:47.421893 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 03:38:47.423886 (Thread-1): finished collecting timing info
2021-04-18 03:38:47.429871 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 03:38:47.436851 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:38:47.458797 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 03:38:49.273248 (Thread-1): finished collecting timing info
2021-04-18 03:38:49.274245 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90F5C1C8>]}
2021-04-18 03:38:49.276267 (Thread-1): 00:38:49 | 2 of 12 OK created view model dbt_isadora.stg_employees.............. [OK in 1.86s]
2021-04-18 03:38:49.278235 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 03:38:49.279234 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 03:38:49.280246 (Thread-1): 00:38:49 | 3 of 12 START view model dbt_isadora.stg_products.................... [RUN]
2021-04-18 03:38:49.281227 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:38:49.282225 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 03:38:49.291208 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 03:38:49.295203 (Thread-1): finished collecting timing info
2021-04-18 03:38:49.305163 (Thread-1): unclosed <socket.socket fd=1248, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62008), raddr=('142.250.218.234', 443)>
2021-04-18 03:38:49.305163 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62007), raddr=('172.217.29.10', 443)>
2021-04-18 03:38:49.312146 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 03:38:49.314140 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:38:49.329098 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 03:38:52.012262 (Thread-1): finished collecting timing info
2021-04-18 03:38:52.013259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8F217D08>]}
2021-04-18 03:38:52.014256 (Thread-1): 00:38:52 | 3 of 12 OK created view model dbt_isadora.stg_products............... [OK in 2.73s]
2021-04-18 03:38:52.017248 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 03:38:52.018246 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 03:38:52.019264 (Thread-1): 00:38:52 | 4 of 12 START view model dbt_isadora.stg_shippers.................... [RUN]
2021-04-18 03:38:52.021241 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:38:52.021241 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 03:38:52.029216 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 03:38:52.031210 (Thread-1): finished collecting timing info
2021-04-18 03:38:52.037194 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 03:38:52.038192 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:38:52.057150 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 03:38:54.458334 (Thread-1): finished collecting timing info
2021-04-18 03:38:54.460329 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8D21FF08>]}
2021-04-18 03:38:54.461328 (Thread-1): 00:38:54 | 4 of 12 OK created view model dbt_isadora.stg_shippers............... [OK in 2.44s]
2021-04-18 03:38:54.464319 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 03:38:54.465316 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 03:38:54.466314 (Thread-1): 00:38:54 | 5 of 12 START view model dbt_isadora.stg_order_details............... [RUN]
2021-04-18 03:38:54.468308 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:38:54.468308 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 03:38:54.470303 (Thread-1): unclosed <socket.socket fd=800, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62015), raddr=('172.217.29.10', 443)>
2021-04-18 03:38:54.471300 (Thread-1): unclosed <socket.socket fd=656, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62016), raddr=('142.250.218.234', 443)>
2021-04-18 03:38:54.479279 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 03:38:54.480277 (Thread-1): finished collecting timing info
2021-04-18 03:38:54.489252 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 03:38:54.492244 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:38:54.539135 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-18 03:38:56.353717 (Thread-1): finished collecting timing info
2021-04-18 03:38:56.354713 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8D2766C8>]}
2021-04-18 03:38:56.355710 (Thread-1): 00:38:56 | 5 of 12 OK created view model dbt_isadora.stg_order_details.......... [OK in 1.89s]
2021-04-18 03:38:56.357705 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 03:38:56.357705 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 03:38:56.358703 (Thread-1): 00:38:56 | 6 of 12 START view model dbt_isadora.stg_orders...................... [RUN]
2021-04-18 03:38:56.359700 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:38:56.360697 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 03:38:56.375656 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 03:38:56.377651 (Thread-1): finished collecting timing info
2021-04-18 03:38:56.384633 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 03:38:56.386628 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:38:56.418541 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 03:38:58.788279 (Thread-1): finished collecting timing info
2021-04-18 03:38:58.789277 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8EFF4708>]}
2021-04-18 03:38:58.790274 (Thread-1): 00:38:58 | 6 of 12 OK created view model dbt_isadora.stg_orders................. [OK in 2.43s]
2021-04-18 03:38:58.798254 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 03:38:58.798254 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 03:38:58.799252 (Thread-1): 00:38:58 | 7 of 12 START view model dbt_isadora.stg_suppliers................... [RUN]
2021-04-18 03:38:58.802245 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:38:58.802245 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 03:38:58.811220 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 03:38:58.813215 (Thread-1): finished collecting timing info
2021-04-18 03:38:58.821195 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 03:38:58.824185 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:38:58.883028 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 03:39:01.261605 (Thread-1): finished collecting timing info
2021-04-18 03:39:01.262602 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90F93048>]}
2021-04-18 03:39:01.262602 (Thread-1): 00:39:01 | 7 of 12 OK created view model dbt_isadora.stg_suppliers.............. [OK in 2.46s]
2021-04-18 03:39:01.264599 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 03:39:01.265595 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 03:39:01.265595 (Thread-1): 00:39:01 | 8 of 12 START view model dbt_isadora.dim_customers................... [RUN]
2021-04-18 03:39:01.267590 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:39:01.267590 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 03:39:01.273574 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 03:39:01.279557 (Thread-1): finished collecting timing info
2021-04-18 03:39:01.284544 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 03:39:01.287536 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:39:01.304566 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:39:03.117846 (Thread-1): finished collecting timing info
2021-04-18 03:39:03.117846 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90F2ABC8>]}
2021-04-18 03:39:03.118844 (Thread-1): 00:39:03 | 8 of 12 OK created view model dbt_isadora.dim_customers.............. [OK in 1.85s]
2021-04-18 03:39:03.119840 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 03:39:03.119840 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-18 03:39:03.120837 (Thread-1): 00:39:03 | 9 of 12 START view model dbt_isadora.dim_employees................... [RUN]
2021-04-18 03:39:03.122833 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:39:03.122833 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-18 03:39:03.143775 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62020), raddr=('142.250.218.234', 443)>
2021-04-18 03:39:03.144772 (Thread-1): unclosed <socket.socket fd=816, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62018), raddr=('172.217.29.10', 443)>
2021-04-18 03:39:03.144772 (Thread-1): unclosed <socket.socket fd=840, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62024), raddr=('172.217.29.10', 443)>
2021-04-18 03:39:03.145770 (Thread-1): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62025), raddr=('142.250.218.234', 443)>
2021-04-18 03:39:03.145770 (Thread-1): unclosed <socket.socket fd=1272, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62031), raddr=('172.217.29.10', 443)>
2021-04-18 03:39:03.145770 (Thread-1): unclosed <socket.socket fd=1276, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62033), raddr=('142.250.218.234', 443)>
2021-04-18 03:39:03.145770 (Thread-1): unclosed <socket.socket fd=1140, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62038), raddr=('172.217.29.10', 443)>
2021-04-18 03:39:03.146767 (Thread-1): unclosed <socket.socket fd=828, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62039), raddr=('142.250.218.234', 443)>
2021-04-18 03:39:03.147764 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-18 03:39:03.149762 (Thread-1): finished collecting timing info
2021-04-18 03:39:03.155744 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-04-18 03:39:03.160730 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:39:03.179682 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
    )

    , transformed as (
        select
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:39:05.672213 (Thread-1): finished collecting timing info
2021-04-18 03:39:05.674208 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90F2D448>]}
2021-04-18 03:39:05.675205 (Thread-1): 00:39:05 | 9 of 12 OK created view model dbt_isadora.dim_employees.............. [OK in 2.55s]
2021-04-18 03:39:05.694154 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-18 03:39:05.694154 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-18 03:39:05.695151 (Thread-1): 00:39:05 | 10 of 12 START view model dbt_isadora.dim_products................... [RUN]
2021-04-18 03:39:05.697145 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:39:05.697145 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-18 03:39:05.699140 (Thread-1): unclosed <socket.socket fd=1324, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62043), raddr=('172.217.29.10', 443)>
2021-04-18 03:39:05.700137 (Thread-1): unclosed <socket.socket fd=984, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62044), raddr=('142.250.218.234', 443)>
2021-04-18 03:39:05.706130 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-18 03:39:05.708119 (Thread-1): finished collecting timing info
2021-04-18 03:39:05.715098 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-18 03:39:05.717095 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:39:05.731057 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:39:08.140483 (Thread-1): finished collecting timing info
2021-04-18 03:39:08.141482 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90E68E48>]}
2021-04-18 03:39:08.142470 (Thread-1): 00:39:08 | 10 of 12 OK created view model dbt_isadora.dim_products.............. [OK in 2.45s]
2021-04-18 03:39:08.144427 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-18 03:39:08.145429 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-18 03:39:08.146422 (Thread-1): 00:39:08 | 11 of 12 START view model dbt_isadora.dim_shippers................... [RUN]
2021-04-18 03:39:08.147418 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:39:08.147418 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-18 03:39:08.148420 (Thread-1): unclosed <socket.socket fd=440, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62045), raddr=('172.217.29.10', 443)>
2021-04-18 03:39:08.149416 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62046), raddr=('142.250.218.234', 443)>
2021-04-18 03:39:08.153404 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 03:39:08.154402 (Thread-1): finished collecting timing info
2021-04-18 03:39:08.157393 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 03:39:08.159389 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:39:08.167367 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:39:09.936399 (Thread-1): finished collecting timing info
2021-04-18 03:39:09.937397 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C90D23FC8>]}
2021-04-18 03:39:09.937397 (Thread-1): 00:39:09 | 11 of 12 OK created view model dbt_isadora.dim_shippers.............. [OK in 1.79s]
2021-04-18 03:39:09.939390 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-18 03:39:09.939390 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:39:09.940388 (Thread-1): 00:39:09 | 12 of 12 START view model dbt_isadora.fact_order_details............. [RUN]
2021-04-18 03:39:09.941383 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:39:09.942382 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:39:09.950363 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:39:09.952353 (Thread-1): finished collecting timing info
2021-04-18 03:39:09.956343 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:39:09.957341 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:39:09.967316 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_detail_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_detail.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_detail_with_sk.product_fk
            , order_detail_with_sk.discount
            , order_detail_with_sk.unit_price
            , order_detail_with_sk.quantity
            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:39:11.821855 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/89ef0adc-4084-484d-bf5a-ca734fb8ec86?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_detail; Did you mean order_details? at [54:35]')
2021-04-18 03:39:13.682082 (Thread-1): finished collecting timing info
2021-04-18 03:39:13.684015 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_detail; Did you mean order_details? at [54:35]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/bd83c303-fcc2-46f6-8cd3-6b7b98bf2ba6?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_detail; Did you mean order_details? at [54:35]

(job ID: bd83c303-fcc2-46f6-8cd3-6b7b98bf2ba6)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_detail_with_sk as (
  47:        select
  48:            order_details.order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_detail.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_detail_with_sk.product_fk
  73:            , order_detail_with_sk.discount
  74:            , order_detail_with_sk.unit_price
  75:            , order_detail_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_detail_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_detail; Did you mean order_details? at [54:35]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:39:13.711585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c1743ff-38d1-419f-aa36-e89782bc9720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8D2F2C48>]}
2021-04-18 03:39:13.712578 (Thread-1): 00:39:13 | 12 of 12 ERROR creating view model dbt_isadora.fact_order_details.... [ERROR in 3.77s]
2021-04-18 03:39:13.714055 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:39:13.802534 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:39:13.804528 (MainThread): 00:39:13 | 
2021-04-18 03:39:13.806524 (MainThread): 00:39:13 | Finished running 12 view models in 30.82s.
2021-04-18 03:39:13.809517 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:39:13.811512 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:39:13.812509 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:39:13.812509 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:39:13.829460 (MainThread): 
2021-04-18 03:39:13.830457 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:39:13.831453 (MainThread): 
2021-04-18 03:39:13.832452 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:39:13.833450 (MainThread):   Unrecognized name: order_detail; Did you mean order_details? at [54:35]
2021-04-18 03:39:13.834444 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:39:13.834444 (MainThread): 
Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
2021-04-18 03:39:13.836438 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8E493888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C8ED17588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015C908F9188>]}
2021-04-18 03:39:13.836438 (MainThread): Flushing usage events
2021-04-18 03:39:52.843749 (MainThread): Running with dbt=0.19.1
2021-04-18 03:39:53.668708 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:39:53.669704 (MainThread): Tracking: tracking
2021-04-18 03:39:53.670701 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2641E6608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2641EA148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2641EA048>]}
2021-04-18 03:39:53.689686 (MainThread): Partial parsing not enabled
2021-04-18 03:39:53.692640 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:39:53.733122 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:39:53.747118 (MainThread): Parsing macros\etc.sql
2021-04-18 03:39:53.751649 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:39:53.762247 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:39:53.791176 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:39:53.796195 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:39:53.801148 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:39:53.822095 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:39:53.841042 (MainThread): Parsing macros\core.sql
2021-04-18 03:39:53.852011 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:39:53.979671 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:39:54.013580 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:39:54.018568 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:39:54.029538 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:39:54.035521 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:39:54.042502 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:39:54.047489 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:39:54.070428 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:39:54.110322 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:39:54.115306 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:39:54.132261 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:39:54.193102 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:39:54.272885 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:39:54.279869 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:39:54.315772 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:39:54.329771 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:39:54.340705 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:39:54.353704 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:39:54.359688 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:39:54.363644 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:39:54.367666 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:39:54.381596 (MainThread): Partial parsing not enabled
2021-04-18 03:39:54.428751 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:39:54.447825 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:39:54.455805 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:39:54.464849 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:39:54.482513 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:39:54.493521 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:39:54.502494 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:39:54.510476 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:39:54.519450 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:39:54.529387 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:39:54.537367 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:39:54.545383 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:39:54.740823 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:39:54.747805 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D26643BA08>]}
2021-04-18 03:39:54.775731 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267E2CE08>]}
2021-04-18 03:39:54.776730 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:39:54.781716 (MainThread): 
2021-04-18 03:39:54.783710 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:39:54.791687 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:39:54.792688 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:39:56.244301 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:39:56.245296 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:39:56.255269 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:39:57.744305 (MainThread): 00:39:57 | Concurrency: 1 threads (target='dev')
2021-04-18 03:39:57.745303 (MainThread): 00:39:57 | 
2021-04-18 03:39:57.755271 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-18 03:39:57.756272 (Thread-1): 00:39:57 | 1 of 12 START view model dbt_isadora.stg_customers................... [RUN]
2021-04-18 03:39:57.759264 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:39:57.759264 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-18 03:39:57.780206 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-18 03:39:57.782202 (Thread-1): finished collecting timing info
2021-04-18 03:39:57.895917 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-18 03:39:57.897889 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:39:57.909859 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-18 03:40:00.382681 (Thread-1): finished collecting timing info
2021-04-18 03:40:00.383678 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267CB43C8>]}
2021-04-18 03:40:00.384675 (Thread-1): 00:40:00 | 1 of 12 OK created view model dbt_isadora.stg_customers.............. [OK in 2.63s]
2021-04-18 03:40:00.385673 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-18 03:40:00.386671 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-18 03:40:00.386671 (Thread-1): 00:40:00 | 2 of 12 START view model dbt_isadora.stg_employees................... [RUN]
2021-04-18 03:40:00.389662 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:40:00.389662 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-18 03:40:00.391658 (Thread-1): unclosed <socket.socket fd=712, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62077), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:00.391658 (Thread-1): unclosed <socket.socket fd=812, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62078), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:00.400648 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-18 03:40:00.402628 (Thread-1): finished collecting timing info
2021-04-18 03:40:00.409609 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-18 03:40:00.411605 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:00.428558 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-18 03:40:02.814919 (Thread-1): finished collecting timing info
2021-04-18 03:40:02.814919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267F0C708>]}
2021-04-18 03:40:02.815916 (Thread-1): 00:40:02 | 2 of 12 OK created view model dbt_isadora.stg_employees.............. [OK in 2.43s]
2021-04-18 03:40:02.817912 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-18 03:40:02.817912 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-18 03:40:02.818909 (Thread-1): 00:40:02 | 3 of 12 START view model dbt_isadora.stg_products.................... [RUN]
2021-04-18 03:40:02.820904 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:40:02.820904 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-18 03:40:02.826889 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-18 03:40:02.827885 (Thread-1): finished collecting timing info
2021-04-18 03:40:02.834865 (Thread-1): unclosed <socket.socket fd=812, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62083), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:02.834865 (Thread-1): unclosed <socket.socket fd=952, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62082), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:02.839854 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-18 03:40:02.840851 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:02.856815 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-18 03:40:05.342528 (Thread-1): finished collecting timing info
2021-04-18 03:40:05.344524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2641938C8>]}
2021-04-18 03:40:05.345514 (Thread-1): 00:40:05 | 3 of 12 OK created view model dbt_isadora.stg_products............... [OK in 2.52s]
2021-04-18 03:40:05.348501 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-18 03:40:05.349500 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-18 03:40:05.350494 (Thread-1): 00:40:05 | 4 of 12 START view model dbt_isadora.stg_shippers.................... [RUN]
2021-04-18 03:40:05.351498 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:40:05.352490 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-18 03:40:05.362484 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 03:40:05.364458 (Thread-1): finished collecting timing info
2021-04-18 03:40:05.369442 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-18 03:40:05.371438 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:05.382413 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-18 03:40:07.853613 (Thread-1): finished collecting timing info
2021-04-18 03:40:07.853613 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2641ADA88>]}
2021-04-18 03:40:07.854656 (Thread-1): 00:40:07 | 4 of 12 OK created view model dbt_isadora.stg_shippers............... [OK in 2.50s]
2021-04-18 03:40:07.856605 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-18 03:40:07.856605 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-18 03:40:07.857607 (Thread-1): 00:40:07 | 5 of 12 START view model dbt_isadora.stg_order_details............... [RUN]
2021-04-18 03:40:07.858601 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:40:07.858601 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-18 03:40:07.860598 (Thread-1): unclosed <socket.socket fd=908, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62086), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:07.861591 (Thread-1): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62087), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:07.866582 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 03:40:07.868574 (Thread-1): finished collecting timing info
2021-04-18 03:40:07.878547 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-18 03:40:07.880541 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:07.891513 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-18 03:40:10.263519 (Thread-1): finished collecting timing info
2021-04-18 03:40:10.265515 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2661A3848>]}
2021-04-18 03:40:10.266514 (Thread-1): 00:40:10 | 5 of 12 OK created view model dbt_isadora.stg_order_details.......... [OK in 2.41s]
2021-04-18 03:40:10.269449 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-18 03:40:10.270445 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-18 03:40:10.271441 (Thread-1): 00:40:10 | 6 of 12 START view model dbt_isadora.stg_orders...................... [RUN]
2021-04-18 03:40:10.272439 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:40:10.273436 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-18 03:40:10.282423 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-18 03:40:10.284406 (Thread-1): finished collecting timing info
2021-04-18 03:40:10.290391 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-18 03:40:10.292385 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:10.306349 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-18 03:40:12.733153 (Thread-1): finished collecting timing info
2021-04-18 03:40:12.733153 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267F18A48>]}
2021-04-18 03:40:12.734151 (Thread-1): 00:40:12 | 6 of 12 OK created view model dbt_isadora.stg_orders................. [OK in 2.46s]
2021-04-18 03:40:12.737111 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-18 03:40:12.737111 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-18 03:40:12.738107 (Thread-1): 00:40:12 | 7 of 12 START view model dbt_isadora.stg_suppliers................... [RUN]
2021-04-18 03:40:12.739102 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:40:12.739102 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-18 03:40:12.746085 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 03:40:12.750073 (Thread-1): finished collecting timing info
2021-04-18 03:40:12.756062 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-18 03:40:12.758052 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:12.773013 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-18 03:40:15.212522 (Thread-1): finished collecting timing info
2021-04-18 03:40:15.213486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267E40388>]}
2021-04-18 03:40:15.213486 (Thread-1): 00:40:15 | 7 of 12 OK created view model dbt_isadora.stg_suppliers.............. [OK in 2.48s]
2021-04-18 03:40:15.215481 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-18 03:40:15.215481 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-18 03:40:15.216478 (Thread-1): 00:40:15 | 8 of 12 START view model dbt_isadora.dim_customers................... [RUN]
2021-04-18 03:40:15.218473 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:40:15.218473 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-18 03:40:15.222460 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-18 03:40:15.223457 (Thread-1): finished collecting timing info
2021-04-18 03:40:15.229443 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-18 03:40:15.230438 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:15.239417 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:40:17.542189 (Thread-1): finished collecting timing info
2021-04-18 03:40:17.544195 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267C5C748>]}
2021-04-18 03:40:17.546190 (Thread-1): 00:40:17 | 8 of 12 OK created view model dbt_isadora.dim_customers.............. [OK in 2.33s]
2021-04-18 03:40:17.549171 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-18 03:40:17.549171 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-18 03:40:17.551208 (Thread-1): 00:40:17 | 9 of 12 START view model dbt_isadora.dim_employees................... [RUN]
2021-04-18 03:40:17.553159 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:40:17.553159 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-18 03:40:17.567118 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62089), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:17.568118 (Thread-1): unclosed <socket.socket fd=1004, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62088), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:17.568118 (Thread-1): unclosed <socket.socket fd=1280, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62090), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:17.569125 (Thread-1): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62091), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:17.570113 (Thread-1): unclosed <socket.socket fd=1300, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62092), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:17.570113 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62093), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:17.571110 (Thread-1): unclosed <socket.socket fd=824, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62094), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:17.571110 (Thread-1): unclosed <socket.socket fd=820, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62095), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:17.572108 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-18 03:40:17.574106 (Thread-1): finished collecting timing info
2021-04-18 03:40:17.583163 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-04-18 03:40:17.586126 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:17.599036 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
    )

    , transformed as (
        select
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:40:19.981172 (Thread-1): finished collecting timing info
2021-04-18 03:40:19.983168 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267E60448>]}
2021-04-18 03:40:19.985161 (Thread-1): 00:40:19 | 9 of 12 OK created view model dbt_isadora.dim_employees.............. [OK in 2.43s]
2021-04-18 03:40:19.988105 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-18 03:40:19.989108 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-18 03:40:19.991100 (Thread-1): 00:40:19 | 10 of 12 START view model dbt_isadora.dim_products................... [RUN]
2021-04-18 03:40:19.992092 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:40:19.993093 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-18 03:40:19.994089 (Thread-1): unclosed <socket.socket fd=1028, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62096), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:19.995095 (Thread-1): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62097), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:20.003062 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-18 03:40:20.004057 (Thread-1): finished collecting timing info
2021-04-18 03:40:20.010043 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-18 03:40:20.012045 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:20.026997 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:40:22.432255 (Thread-1): finished collecting timing info
2021-04-18 03:40:22.433247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267C8ADC8>]}
2021-04-18 03:40:22.434249 (Thread-1): 00:40:22 | 10 of 12 OK created view model dbt_isadora.dim_products.............. [OK in 2.44s]
2021-04-18 03:40:22.436500 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-18 03:40:22.437507 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-18 03:40:22.437507 (Thread-1): 00:40:22 | 11 of 12 START view model dbt_isadora.dim_shippers................... [RUN]
2021-04-18 03:40:22.439503 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:40:22.439503 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-18 03:40:22.440535 (Thread-1): unclosed <socket.socket fd=1340, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62098), raddr=('142.250.218.202', 443)>
2021-04-18 03:40:22.441532 (Thread-1): unclosed <socket.socket fd=1356, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('172.20.10.2', 62099), raddr=('142.250.218.234', 443)>
2021-04-18 03:40:22.444520 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 03:40:22.446480 (Thread-1): finished collecting timing info
2021-04-18 03:40:22.451474 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-18 03:40:22.453463 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:22.465433 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-18 03:40:24.880657 (Thread-1): finished collecting timing info
2021-04-18 03:40:24.881660 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267CA7E88>]}
2021-04-18 03:40:24.882652 (Thread-1): 00:40:24 | 11 of 12 OK created view model dbt_isadora.dim_shippers.............. [OK in 2.44s]
2021-04-18 03:40:24.884648 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-18 03:40:24.884648 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:40:24.885648 (Thread-1): 00:40:24 | 12 of 12 START view model dbt_isadora.fact_order_details............. [RUN]
2021-04-18 03:40:24.887639 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:40:24.887639 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:40:24.898610 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:40:24.901604 (Thread-1): finished collecting timing info
2021-04-18 03:40:24.912573 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:40:24.913569 (Thread-1): Opening a new connection, currently in state closed
2021-04-18 03:40:24.927535 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_detail_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_detail_with_sk.product_fk
            , order_detail_with_sk.discount
            , order_detail_with_sk.unit_price
            , order_detail_with_sk.quantity
            from orders_with_sk
            left join order_detail_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:40:29.473032 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/25c94426-382e-4dc7-b17a-2d04809cc5dc?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]')
2021-04-18 03:40:31.500621 (Thread-1): finished collecting timing info
2021-04-18 03:40:31.502616 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/1652cb04-5af2-4d88-828e-509b93351572?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]

(job ID: 1652cb04-5af2-4d88-828e-509b93351572)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_detail_with_sk as (
  47:        select
  48:            order_details.order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_detail_with_sk.product_fk
  73:            , order_detail_with_sk.discount
  74:            , order_detail_with_sk.unit_price
  75:            , order_detail_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_detail_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:40:31.519554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '825ccb73-cc86-45c7-826a-1dac37a6cd94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D267D4BA88>]}
2021-04-18 03:40:31.520517 (Thread-1): 00:40:31 | 12 of 12 ERROR creating view model dbt_isadora.fact_order_details.... [ERROR in 6.63s]
2021-04-18 03:40:31.521514 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:40:31.611296 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:40:31.611296 (MainThread): 00:40:31 | 
2021-04-18 03:40:31.612677 (MainThread): 00:40:31 | Finished running 12 view models in 36.83s.
2021-04-18 03:40:31.613698 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:40:31.613698 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:40:31.613698 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:40:31.614713 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:40:31.634642 (MainThread): 
2021-04-18 03:40:31.634642 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:40:31.635639 (MainThread): 
2021-04-18 03:40:31.636639 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:40:31.637635 (MainThread):   Unrecognized name: order_details_with_sk; Did you mean order_detail_with_sk? at [77:71]
2021-04-18 03:40:31.638631 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:40:31.639630 (MainThread): 
Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
2021-04-18 03:40:31.641625 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2664DD848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2678A9088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D265CB8A08>]}
2021-04-18 03:40:31.641625 (MainThread): Flushing usage events
2021-04-18 03:41:24.332577 (MainThread): Running with dbt=0.19.1
2021-04-18 03:41:26.870024 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:41:26.871024 (MainThread): Tracking: tracking
2021-04-18 03:41:26.871989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08AA39708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08AA45AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08AA45E88>]}
2021-04-18 03:41:26.891327 (MainThread): Partial parsing not enabled
2021-04-18 03:41:26.894320 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:41:26.942440 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:41:26.957406 (MainThread): Parsing macros\etc.sql
2021-04-18 03:41:26.962101 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:41:26.973080 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:41:27.002998 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:41:27.012971 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:41:27.018134 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:41:27.041079 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:41:27.056811 (MainThread): Parsing macros\core.sql
2021-04-18 03:41:27.070797 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:41:27.206435 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:41:27.245330 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:41:27.248322 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:41:27.253310 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:41:27.258295 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:41:27.263282 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:41:27.266836 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:41:27.296262 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:41:27.329199 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:41:27.333158 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:41:27.346637 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:41:27.389528 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:41:27.467320 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:41:27.472328 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:41:27.510205 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:41:27.526164 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:41:27.546282 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:41:27.568918 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:41:27.575943 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:41:27.579932 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:41:27.584921 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:41:27.599877 (MainThread): Partial parsing not enabled
2021-04-18 03:41:27.660352 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:41:27.679342 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:41:27.687282 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:41:27.696295 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:41:27.705634 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:41:27.716643 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:41:27.724621 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:41:27.732401 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:41:27.740379 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:41:27.749363 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:41:27.757335 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:41:27.765802 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:41:27.933499 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:41:27.939451 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80a22b6b-e86b-43b4-bf76-f9f86d9887fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08E69BE88>]}
2021-04-18 03:41:27.951412 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80a22b6b-e86b-43b4-bf76-f9f86d9887fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08E64CD48>]}
2021-04-18 03:41:27.952410 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:41:27.959391 (MainThread): 
2021-04-18 03:41:27.960394 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:41:27.964379 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:41:27.965375 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:41:28.942522 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:41:28.942522 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:41:28.951494 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:41:29.833022 (MainThread): 00:41:29 | Concurrency: 1 threads (target='dev')
2021-04-18 03:41:29.835015 (MainThread): 00:41:29 | 
2021-04-18 03:41:29.844991 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:41:29.844991 (Thread-1): 00:41:29 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:41:29.846983 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:41:29.846983 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:41:29.856957 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:41:29.857952 (Thread-1): finished collecting timing info
2021-04-18 03:41:29.981623 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:41:29.982621 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:41:29.996581 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:41:31.853838 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/f601b207-0d83-4387-873d-30ec9d405843?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]')
2021-04-18 03:41:33.734721 (Thread-1): finished collecting timing info
2021-04-18 03:41:33.734721 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/82f5d69a-c951-4346-b69c-9328a19d23da?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]

(job ID: 82f5d69a-c951-4346-b69c-9328a19d23da)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_details.order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:41:33.767922 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80a22b6b-e86b-43b4-bf76-f9f86d9887fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08E599048>]}
2021-04-18 03:41:33.768928 (Thread-1): 00:41:33 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.92s]
2021-04-18 03:41:33.770446 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:41:33.841968 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:41:33.841968 (MainThread): 00:41:33 | 
2021-04-18 03:41:33.842929 (MainThread): 00:41:33 | Finished running 1 view model in 5.88s.
2021-04-18 03:41:33.843925 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:41:33.843925 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:41:33.843925 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:41:33.843925 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:41:33.857912 (MainThread): 
2021-04-18 03:41:33.859919 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:41:33.861881 (MainThread): 
2021-04-18 03:41:33.863873 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:41:33.864869 (MainThread):   Unrecognized name: order_details at [58:13]
2021-04-18 03:41:33.865867 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:41:33.866864 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:41:33.867861 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08E4C0AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08E620F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08DF09308>]}
2021-04-18 03:41:33.868859 (MainThread): Flushing usage events
2021-04-18 03:43:59.119313 (MainThread): Running with dbt=0.19.1
2021-04-18 03:43:59.836045 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:43:59.836045 (MainThread): Tracking: tracking
2021-04-18 03:43:59.837042 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A90EAC788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A915C4D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A915C4E48>]}
2021-04-18 03:43:59.854959 (MainThread): Partial parsing not enabled
2021-04-18 03:43:59.857951 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:43:59.895850 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:43:59.909815 (MainThread): Parsing macros\etc.sql
2021-04-18 03:43:59.914802 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:43:59.923776 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:43:59.955692 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:43:59.961675 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:43:59.966661 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:43:59.985610 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:43:59.995585 (MainThread): Parsing macros\core.sql
2021-04-18 03:44:00.003598 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:44:00.098311 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:44:00.118256 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:44:00.121249 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:44:00.125238 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:44:00.130225 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:44:00.134213 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:44:00.137206 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:44:00.157154 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:44:00.186111 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:44:00.190098 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:44:00.203032 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:44:00.244956 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:44:00.316724 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:44:00.321745 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:44:00.356653 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:44:00.370617 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:44:00.381587 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:44:00.393559 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:44:00.399539 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:44:00.402530 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:44:00.407517 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:44:00.419487 (MainThread): Partial parsing not enabled
2021-04-18 03:44:00.465365 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:44:00.483281 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:44:00.491294 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:44:00.499272 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:44:00.508244 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:44:00.518218 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:44:00.526197 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:44:00.533178 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:44:00.541156 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:44:00.550134 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:44:00.557122 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:44:00.566092 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:44:00.730651 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:44:00.737634 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b554f6a-b5e7-4ca6-9fbc-deaec4b266ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A95091908>]}
2021-04-18 03:44:00.766555 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b554f6a-b5e7-4ca6-9fbc-deaec4b266ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A950AFA48>]}
2021-04-18 03:44:00.766555 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:44:00.771541 (MainThread): 
2021-04-18 03:44:00.772538 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:44:00.779525 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:44:00.782545 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:44:02.093342 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:44:02.094337 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:44:02.107303 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:44:03.514627 (MainThread): 00:44:03 | Concurrency: 1 threads (target='dev')
2021-04-18 03:44:03.515625 (MainThread): 00:44:03 | 
2021-04-18 03:44:03.521607 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:44:03.522606 (Thread-1): 00:44:03 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:44:03.524600 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:44:03.524600 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:44:03.545553 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:44:03.547539 (Thread-1): finished collecting timing info
2021-04-18 03:44:03.653256 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:44:03.655252 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:44:03.675197 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:44:05.570007 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/6158f7ca-f19d-406c-8bd4-3a5a09703219?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]')
2021-04-18 03:44:07.447614 (Thread-1): finished collecting timing info
2021-04-18 03:44:07.448607 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/e4eb8bdf-c961-4558-8df6-2cfa27a4ace7?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]

(job ID: e4eb8bdf-c961-4558-8df6-2cfa27a4ace7)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_details.order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:44:07.456586 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b554f6a-b5e7-4ca6-9fbc-deaec4b266ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A95159D48>]}
2021-04-18 03:44:07.457585 (Thread-1): 00:44:07 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.93s]
2021-04-18 03:44:07.458548 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:44:07.509261 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:44:07.509261 (MainThread): 00:44:07 | 
2021-04-18 03:44:07.510434 (MainThread): 00:44:07 | Finished running 1 view model in 6.74s.
2021-04-18 03:44:07.511435 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:44:07.511435 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:44:07.511435 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:44:07.511435 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:44:07.523066 (MainThread): 
2021-04-18 03:44:07.524063 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:44:07.526057 (MainThread): 
2021-04-18 03:44:07.527054 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:44:07.528051 (MainThread):   Unrecognized name: order_details at [58:13]
2021-04-18 03:44:07.529049 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:44:07.530048 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:44:07.535035 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A91640FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A915CB848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9506E2C8>]}
2021-04-18 03:44:07.536031 (MainThread): Flushing usage events
2021-04-18 03:45:46.149636 (MainThread): Running with dbt=0.19.1
2021-04-18 03:45:46.849662 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:45:46.850659 (MainThread): Tracking: tracking
2021-04-18 03:45:46.850659 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A1593848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A159B0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A159BE48>]}
2021-04-18 03:45:46.868612 (MainThread): Partial parsing not enabled
2021-04-18 03:45:46.871601 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:45:46.912492 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:45:46.925457 (MainThread): Parsing macros\etc.sql
2021-04-18 03:45:46.930445 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:45:46.938423 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:45:46.964355 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:45:46.970339 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:45:46.974329 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:45:46.994273 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:45:47.004249 (MainThread): Parsing macros\core.sql
2021-04-18 03:45:47.012227 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:45:47.100990 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:45:47.118940 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:45:47.120942 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:45:47.124924 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:45:47.128916 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:45:47.132903 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:45:47.135863 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:45:47.155810 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:45:47.187724 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:45:47.191713 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:45:47.204711 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:45:47.245604 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:45:47.319372 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:45:47.324390 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:45:47.365250 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:45:47.381206 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:45:47.392176 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:45:47.404144 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:45:47.410129 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:45:47.413120 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:45:47.417110 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:45:47.430076 (MainThread): Partial parsing not enabled
2021-04-18 03:45:47.476985 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:45:47.496929 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:45:47.503914 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:45:47.511859 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:45:47.542080 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:45:47.552053 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:45:47.560032 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:45:47.567013 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:45:47.575027 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:45:47.583005 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:45:47.590984 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:45:47.597965 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:45:47.758503 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:45:47.764490 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4761ff04-6073-4967-b2f2-74b68dd01bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A51ECE48>]}
2021-04-18 03:45:47.790446 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4761ff04-6073-4967-b2f2-74b68dd01bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A503FB08>]}
2021-04-18 03:45:47.792426 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:45:47.797398 (MainThread): 
2021-04-18 03:45:47.799395 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:45:47.801389 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:45:47.802385 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:45:48.701128 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:45:48.701128 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:45:48.717071 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:45:50.177996 (MainThread): 00:45:50 | Concurrency: 1 threads (target='dev')
2021-04-18 03:45:50.179015 (MainThread): 00:45:50 | 
2021-04-18 03:45:50.184653 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:45:50.184653 (Thread-1): 00:45:50 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:45:50.186514 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:45:50.186514 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:45:50.196487 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:45:50.198489 (Thread-1): finished collecting timing info
2021-04-18 03:45:50.288279 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:45:50.290237 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:45:50.299210 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_detail.order_id
            , products.product_sk as product_fk
            , order_detail.discount
            , order_detail.unit_price
            , order_detail.quantity
            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_detail
            left join products on order_detail.product_id = products.product_id
    )
    , final as (
        select
            order_detail.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:45:52.354269 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/4c81ad28-e4f3-4a6a-91cf-8d2bf96d3d02?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_detail; Did you mean order_date? at [58:13]')
2021-04-18 03:45:53.526684 (Thread-1): finished collecting timing info
2021-04-18 03:45:53.527683 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_detail; Did you mean order_date? at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/67ed72c7-4102-443c-be72-b13ea8179b3b?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_detail; Did you mean order_date? at [58:13]

(job ID: 67ed72c7-4102-443c-be72-b13ea8179b3b)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_detail.order_id
  49:            , products.product_sk as product_fk
  50:            , order_detail.discount
  51:            , order_detail.unit_price
  52:            , order_detail.quantity
  53:            from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_detail
  54:            left join products on order_detail.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_detail.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_detail; Did you mean order_date? at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:45:53.537654 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4761ff04-6073-4967-b2f2-74b68dd01bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A5043F08>]}
2021-04-18 03:45:53.538657 (Thread-1): 00:45:53 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.35s]
2021-04-18 03:45:53.539612 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:45:53.601395 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:45:53.602395 (MainThread): 00:45:53 | 
2021-04-18 03:45:53.603388 (MainThread): 00:45:53 | Finished running 1 view model in 5.80s.
2021-04-18 03:45:53.603388 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:45:53.604388 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:45:53.604388 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:45:53.604388 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:45:53.620354 (MainThread): 
2021-04-18 03:45:53.621339 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:45:53.622340 (MainThread): 
2021-04-18 03:45:53.623334 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:45:53.624334 (MainThread):   Unrecognized name: order_detail; Did you mean order_date? at [58:13]
2021-04-18 03:45:53.625333 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:45:53.626327 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:45:53.627324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A1632608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A1618848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A4FE3F08>]}
2021-04-18 03:45:53.628321 (MainThread): Flushing usage events
2021-04-18 03:49:48.567914 (MainThread): Running with dbt=0.19.1
2021-04-18 03:49:49.295693 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:49:49.296689 (MainThread): Tracking: tracking
2021-04-18 03:49:49.297686 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965C98D4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965C935F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965C935E48>]}
2021-04-18 03:49:49.315639 (MainThread): Partial parsing not enabled
2021-04-18 03:49:49.318630 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:49:49.361519 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:49:49.374485 (MainThread): Parsing macros\etc.sql
2021-04-18 03:49:49.378473 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:49:49.390442 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:49:49.414410 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:49:49.420394 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:49:49.424380 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:49:49.443335 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:49:49.454306 (MainThread): Parsing macros\core.sql
2021-04-18 03:49:49.461286 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:49:49.550016 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:49:49.568964 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:49:49.571957 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:49:49.575946 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:49:49.579935 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:49:49.583924 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:49:49.586916 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:49:49.606863 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:49:49.636817 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:49:49.640804 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:49:49.652774 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:49:49.694663 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:49:49.767432 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:49:49.771420 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:49:49.806326 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:49:49.820289 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:49:49.830262 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:49:49.843227 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:49:49.849247 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:49:49.852241 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:49:49.856228 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:49:49.871153 (MainThread): Partial parsing not enabled
2021-04-18 03:49:49.920026 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:49:49.940969 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:49:49.948948 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:49:49.956927 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:49:49.980125 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:49:49.992094 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:49:50.000073 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:49:50.008052 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:49:50.016030 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:49:50.026004 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:49:50.033982 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:49:50.041961 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:49:50.219483 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:49:50.225472 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '042821e2-cc53-4111-95a8-933f37a76325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965E174F88>]}
2021-04-18 03:49:50.243421 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '042821e2-cc53-4111-95a8-933f37a76325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196604FBB48>]}
2021-04-18 03:49:50.244418 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:49:50.251401 (MainThread): 
2021-04-18 03:49:50.254408 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:49:50.257383 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:49:50.258381 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:49:51.765433 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:49:51.766436 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:49:51.777404 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:49:52.611651 (MainThread): 00:49:52 | Concurrency: 1 threads (target='dev')
2021-04-18 03:49:52.614643 (MainThread): 00:49:52 | 
2021-04-18 03:49:52.627604 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:49:52.628600 (Thread-1): 00:49:52 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:49:52.630596 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:49:52.630596 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:49:52.647548 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:49:52.649543 (Thread-1): finished collecting timing info
2021-04-18 03:49:52.739320 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:49:52.740300 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:49:52.752268 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:49:54.201572 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/34c77a97-c1ff-4679-ae45-a7510beb0809?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]')
2021-04-18 03:49:55.841862 (Thread-1): finished collecting timing info
2021-04-18 03:49:55.842858 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/1072eb7d-99f3-41a7-80b2-95ee43c10536?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]

(job ID: 1072eb7d-99f3-41a7-80b2-95ee43c10536)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_details.order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:49:55.857818 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '042821e2-cc53-4111-95a8-933f37a76325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019660367F88>]}
2021-04-18 03:49:55.858814 (Thread-1): 00:49:55 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.23s]
2021-04-18 03:49:55.859811 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:49:55.927916 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:49:55.928914 (MainThread): 00:49:55 | 
2021-04-18 03:49:55.929920 (MainThread): 00:49:55 | Finished running 1 view model in 5.68s.
2021-04-18 03:49:55.930908 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:49:55.931905 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:49:55.931905 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:49:55.931905 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:49:55.946866 (MainThread): 
2021-04-18 03:49:55.947863 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:49:55.948865 (MainThread): 
2021-04-18 03:49:55.949858 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:49:55.950854 (MainThread):   Unrecognized name: order_details at [58:13]
2021-04-18 03:49:55.951852 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:49:55.952851 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:49:55.955840 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001966021CE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019660214908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196603A6388>]}
2021-04-18 03:49:55.956843 (MainThread): Flushing usage events
2021-04-18 03:51:04.233426 (MainThread): Running with dbt=0.19.1
2021-04-18 03:51:05.045256 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:51:05.046258 (MainThread): Tracking: tracking
2021-04-18 03:51:05.047251 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C756125D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C756125EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C756125CC8>]}
2021-04-18 03:51:05.066202 (MainThread): Partial parsing not enabled
2021-04-18 03:51:05.069191 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:51:05.109468 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:51:05.121401 (MainThread): Parsing macros\etc.sql
2021-04-18 03:51:05.126387 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:51:05.135398 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:51:05.162326 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:51:05.167313 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:51:05.171302 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:51:05.192211 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:51:05.204178 (MainThread): Parsing macros\core.sql
2021-04-18 03:51:05.212158 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:51:05.307903 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:51:05.327884 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:51:05.329878 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:51:05.333870 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:51:05.337857 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:51:05.341849 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:51:05.343843 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:51:05.363752 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:51:05.394672 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:51:05.398659 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:51:05.412658 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:51:05.454546 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:51:05.566216 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:51:05.570244 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:51:05.628050 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:51:05.650027 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:51:05.664951 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:51:05.684895 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:51:05.694867 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:51:05.699858 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:51:05.704876 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:51:05.728779 (MainThread): Partial parsing not enabled
2021-04-18 03:51:05.816545 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:51:05.845465 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:51:05.855438 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:51:05.867409 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:51:05.895335 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:51:05.914281 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:51:05.937221 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:51:05.954178 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:51:05.969138 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:51:05.984095 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:51:05.999055 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:51:06.012021 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:51:06.332162 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:51:06.338148 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35048706-c577-4c4a-86ad-9a1fe6e153d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C759DBCE88>]}
2021-04-18 03:51:06.362086 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35048706-c577-4c4a-86ad-9a1fe6e153d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C759C107C8>]}
2021-04-18 03:51:06.363082 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:51:06.367070 (MainThread): 
2021-04-18 03:51:06.371063 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:51:06.382031 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:51:06.382031 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:51:08.291480 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:51:08.292444 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:51:08.300422 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:51:09.103210 (MainThread): 00:51:09 | Concurrency: 1 threads (target='dev')
2021-04-18 03:51:09.105202 (MainThread): 00:51:09 | 
2021-04-18 03:51:09.116179 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:51:09.117172 (Thread-1): 00:51:09 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:51:09.118166 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:51:09.119168 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:51:09.134125 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:51:09.135120 (Thread-1): finished collecting timing info
2021-04-18 03:51:09.222886 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:51:09.224878 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:51:09.232858 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
            left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:51:11.404274 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/d155b4a6-b92e-411b-876a-27f3ec711290?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]')
2021-04-18 03:51:13.004072 (Thread-1): finished collecting timing info
2021-04-18 03:51:13.006066 (Thread-1): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/d4a2061d-f001-4cd0-ba4a-c8d14db96daf?maxResults=0&location=US&prettyPrint=false: Unrecognized name: order_details at [58:13]

(job ID: d4a2061d-f001-4cd0-ba4a-c8d14db96daf)

                                                                -----Query Job SQL Follows-----                                                                 

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
   5:  OPTIONS()
   6:  as with
   7:    customers as (
   8:        select *
   9:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  10:    )
  11:    , employees as (
  12:        select *
  13:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  14:    )
  15:    , products as (
  16:        select *
  17:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  18:    )
  19:    , shippers as (
  20:        select *
  21:        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  22:    )
  23:    , orders_with_sk as (
  24:            select
  25:            order_id
  26:            , employees.employee_sk as employeee_fk
  27:            , customers.customer_sk as customer_fk
  28:            , shippers.shipper_sk as shipper_fk
  29:            , orders.ship_region
  30:            , orders.shipped_date
  31:            , orders.ship_country
  32:            , orders.ship_name
  33:            , orders.order_date
  34:            , orders.ship_postal_code
  35:            , orders.ship_city
  36:            , orders.freight
  37:            , orders.required_date
  38:            , orders.ship_address
  39:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders
  40:
  41:        left join customers on orders.customer_id=customers.customer_id
  42:        left join employees on orders.employee_id=employees.employee_id
  43:        left join shippers on orders.shipper_id=shippers.shipper_id
  44:    )
  45:
  46:    , order_details_with_sk as (
  47:        select
  48:            order_id
  49:            , products.product_sk as product_fk
  50:            , order_details.discount
  51:            , order_details.unit_price
  52:            , order_details.quantity
  53:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
  54:            left join products on order_details.product_id = products.product_id
  55:    )
  56:    , final as (
  57:        select
  58:            order_details.order_id
  59:            , orders_with_sk.employeee_fk
  60:            , orders_with_sk.customer_fk
  61:            , orders_with_sk.shipper_fk
  62:            , orders_with_sk.ship_region
  63:            , orders_with_sk.shipped_date
  64:            , orders_with_sk.ship_country
  65:            , orders_with_sk.ship_name
  66:            , orders_with_sk.order_date
  67:            , orders_with_sk.ship_postal_code
  68:            , orders_with_sk.ship_city
  69:            , orders_with_sk.freight
  70:            , orders_with_sk.required_date
  71:            , orders_with_sk.ship_address
  72:            , order_details_with_sk.product_fk
  73:            , order_details_with_sk.discount
  74:            , order_details_with_sk.unit_price
  75:            , order_details_with_sk.quantity
  76:            from orders_with_sk
  77:            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
  78:    )
  79:
  80:select * from final;
  81:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model fact_order_details (models\marts\fact_order_details.sql)
  Unrecognized name: order_details at [58:13]
  compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:51:13.026994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35048706-c577-4c4a-86ad-9a1fe6e153d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C759C00988>]}
2021-04-18 03:51:13.026994 (Thread-1): 00:51:13 | 1 of 1 ERROR creating view model dbt_isadora.fact_order_details...... [ERROR in 3.91s]
2021-04-18 03:51:13.028952 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:51:13.086308 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:51:13.086308 (MainThread): 00:51:13 | 
2021-04-18 03:51:13.087419 (MainThread): 00:51:13 | Finished running 1 view model in 6.72s.
2021-04-18 03:51:13.088424 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:51:13.088424 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:51:13.088424 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:51:13.089419 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:51:13.110363 (MainThread): 
2021-04-18 03:51:13.111361 (MainThread): Completed with 1 error and 0 warnings:
2021-04-18 03:51:13.112361 (MainThread): 
2021-04-18 03:51:13.113355 (MainThread): Database Error in model fact_order_details (models\marts\fact_order_details.sql)
2021-04-18 03:51:13.114353 (MainThread):   Unrecognized name: order_details at [58:13]
2021-04-18 03:51:13.115358 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\fact_order_details.sql
2021-04-18 03:51:13.116347 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-18 03:51:13.117347 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C759BEFBC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C759DBCE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C759BADE08>]}
2021-04-18 03:51:13.118342 (MainThread): Flushing usage events
2021-04-18 03:54:51.733712 (MainThread): Running with dbt=0.19.1
2021-04-18 03:54:52.994086 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-18 03:54:52.995084 (MainThread): Tracking: tracking
2021-04-18 03:54:52.997078 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001880F892048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001880F89B248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001880F89B088>]}
2021-04-18 03:54:53.017333 (MainThread): Partial parsing not enabled
2021-04-18 03:54:53.020324 (MainThread): Parsing macros\adapters.sql
2021-04-18 03:54:53.069194 (MainThread): Parsing macros\catalog.sql
2021-04-18 03:54:53.083157 (MainThread): Parsing macros\etc.sql
2021-04-18 03:54:53.087183 (MainThread): Parsing macros\materializations\copy.sql
2021-04-18 03:54:53.096123 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-18 03:54:53.122052 (MainThread): Parsing macros\materializations\seed.sql
2021-04-18 03:54:53.128037 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-18 03:54:53.132026 (MainThread): Parsing macros\materializations\table.sql
2021-04-18 03:54:53.152973 (MainThread): Parsing macros\materializations\view.sql
2021-04-18 03:54:53.164457 (MainThread): Parsing macros\core.sql
2021-04-18 03:54:53.173432 (MainThread): Parsing macros\adapters\common.sql
2021-04-18 03:54:53.265187 (MainThread): Parsing macros\etc\datetime.sql
2021-04-18 03:54:53.284136 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-18 03:54:53.287127 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-18 03:54:53.291117 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-18 03:54:53.300135 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-18 03:54:53.305082 (MainThread): Parsing macros\etc\query.sql
2021-04-18 03:54:53.309070 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-18 03:54:53.331011 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-18 03:54:53.367911 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-18 03:54:53.372900 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-18 03:54:53.386896 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-18 03:54:53.439754 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-18 03:54:53.518509 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-18 03:54:53.522498 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-18 03:54:53.570372 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-18 03:54:53.589320 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-18 03:54:53.602288 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-18 03:54:53.620271 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-18 03:54:53.627223 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-18 03:54:53.632209 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-18 03:54:53.638192 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-18 03:54:53.654185 (MainThread): Partial parsing not enabled
2021-04-18 03:54:53.713990 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-18 03:54:53.735929 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-18 03:54:53.744906 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-18 03:54:53.754878 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-18 03:54:53.777171 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:54:53.788141 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-18 03:54:53.797153 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-18 03:54:53.805131 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-18 03:54:53.814075 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-18 03:54:53.826075 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-18 03:54:53.836016 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-18 03:54:53.845988 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-18 03:54:54.067395 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-18 03:54:54.073380 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97a6849e-c254-4a20-a40f-533389302bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018813518948>]}
2021-04-18 03:54:54.098331 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97a6849e-c254-4a20-a40f-533389302bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001881337F408>]}
2021-04-18 03:54:54.103300 (MainThread): Found 12 models, 2 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-18 03:54:54.107290 (MainThread): 
2021-04-18 03:54:54.108285 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:54:54.118262 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-18 03:54:54.120272 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-18 03:54:55.044861 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-18 03:54:55.045855 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-18 03:54:55.056825 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-18 03:54:56.072997 (MainThread): 00:54:56 | Concurrency: 1 threads (target='dev')
2021-04-18 03:54:56.074771 (MainThread): 00:54:56 | 
2021-04-18 03:54:56.087754 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-18 03:54:56.087754 (Thread-1): 00:54:56 | 1 of 1 START view model dbt_isadora.fact_order_details............... [RUN]
2021-04-18 03:54:56.089742 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-18 03:54:56.090744 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-18 03:54:56.107693 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:54:56.108691 (Thread-1): finished collecting timing info
2021-04-18 03:54:56.202440 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-18 03:54:56.203439 (Thread-1): Opening a new connection, currently in state init
2021-04-18 03:54:56.211414 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
        left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details_with_sk.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-18 03:54:58.230765 (Thread-1): finished collecting timing info
2021-04-18 03:54:58.230765 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97a6849e-c254-4a20-a40f-533389302bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018813358908>]}
2021-04-18 03:54:58.231759 (Thread-1): 00:54:58 | 1 of 1 OK created view model dbt_isadora.fact_order_details.......... [OK in 2.14s]
2021-04-18 03:54:58.232726 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-18 03:54:58.287569 (MainThread): Acquiring new bigquery connection "master".
2021-04-18 03:54:58.288597 (MainThread): 00:54:58 | 
2021-04-18 03:54:58.289560 (MainThread): 00:54:58 | Finished running 1 view model in 4.18s.
2021-04-18 03:54:58.289560 (MainThread): Connection 'master' was properly closed.
2021-04-18 03:54:58.290557 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-18 03:54:58.290557 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-18 03:54:58.290557 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-18 03:54:58.301526 (MainThread): 
2021-04-18 03:54:58.302525 (MainThread): Completed successfully
2021-04-18 03:54:58.303521 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-18 03:54:58.318481 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001880F918788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018813362C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001881353EB08>]}
2021-04-18 03:54:58.319478 (MainThread): Flushing usage events
2021-04-22 01:19:47.622115 (MainThread): Running with dbt=0.19.1
2021-04-22 01:19:50.018714 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:19:50.020653 (MainThread): Tracking: tracking
2021-04-22 01:19:50.022960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254338E0548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254339E4B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254339EB088>]}
2021-04-22 01:19:50.067659 (MainThread): Partial parsing not enabled
2021-04-22 01:19:50.082665 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:19:50.191241 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:19:50.222414 (MainThread): Parsing macros\etc.sql
2021-04-22 01:19:50.242723 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:19:50.269246 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:19:50.311576 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:19:50.332208 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:19:50.352629 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:19:50.391561 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:19:50.422947 (MainThread): Parsing macros\core.sql
2021-04-22 01:19:50.461401 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:19:51.395164 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:19:51.462272 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:19:51.489778 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:19:51.514809 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:19:51.550105 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:19:51.587345 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:19:51.614789 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:19:51.695942 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:19:51.814089 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:19:51.852229 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:19:51.909927 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:19:52.072636 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:19:52.259657 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:19:52.305064 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:19:52.412633 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:19:52.470812 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:19:52.514209 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:19:52.571789 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:19:52.606286 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:19:52.634153 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:19:52.672281 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:19:52.713699 (MainThread): Partial parsing not enabled
2021-04-22 01:19:52.889307 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:19:52.941608 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:19:52.971941 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:19:52.999531 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:19:53.017122 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:19:53.041830 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:19:53.068968 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:19:53.091721 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:19:53.154262 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:19:53.249005 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:19:53.314217 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:19:53.336394 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:19:53.636657 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 01:19:53.640679 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76f22f35-d4da-4314-9a23-f69719902333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025437674B88>]}
2021-04-22 01:19:53.669221 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76f22f35-d4da-4314-9a23-f69719902333', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254374B41C8>]}
2021-04-22 01:19:53.670225 (MainThread): Found 12 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 01:19:53.673681 (MainThread): 
2021-04-22 01:19:53.675393 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:19:53.686415 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 01:19:53.686415 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 01:19:53.740731 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 01:19:55.514619 (MainThread): 22:19:55 | Concurrency: 1 threads (target='dev')
2021-04-22 01:19:55.520457 (MainThread): 22:19:55 | 
2021-04-22 01:19:55.538076 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customer_id
2021-04-22 01:19:55.539119 (Thread-1): 22:19:55 | 1 of 4 START test not_null_dim_customers_customer_id................. [RUN]
2021-04-22 01:19:55.543304 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customer_id".
2021-04-22 01:19:55.544307 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customer_id
2021-04-22 01:19:55.653277 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customer_id"
2021-04-22 01:19:55.671384 (Thread-1): finished collecting timing info
2021-04-22 01:19:55.673774 (Thread-1): Opening a new connection, currently in state init
2021-04-22 01:19:55.724411 (Thread-1): On test.northwind_shop.not_null_dim_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
where customer_id is null



2021-04-22 01:19:58.996589 (Thread-1): finished collecting timing info
2021-04-22 01:19:58.997588 (Thread-1): 22:19:58 | 1 of 4 PASS not_null_dim_customers_customer_id....................... [PASS in 3.46s]
2021-04-22 01:19:58.999583 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customer_id
2021-04-22 01:19:58.999583 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 01:19:59.000580 (Thread-1): 22:19:59 | 2 of 4 START test source_not_null_northwind_etl_orders_order_id...... [RUN]
2021-04-22 01:19:59.001576 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-04-22 01:19:59.002573 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 01:19:59.014425 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-04-22 01:19:59.025091 (Thread-1): finished collecting timing info
2021-04-22 01:19:59.026087 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:19:59.039206 (Thread-1): On test.northwind_shop.source_not_null_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from `tutorial-dbt-310721`.`northwind_etl`.`orders`
where order_id is null



2021-04-22 01:20:01.964786 (Thread-1): finished collecting timing info
2021-04-22 01:20:01.964786 (Thread-1): 22:20:01 | 2 of 4 PASS source_not_null_northwind_etl_orders_order_id............ [PASS in 2.96s]
2021-04-22 01:20:01.974052 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 01:20:01.975051 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 01:20:01.976343 (Thread-1): 22:20:01 | 3 of 4 START test source_unique_northwind_etl_orders_order_id........ [RUN]
2021-04-22 01:20:01.979353 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-04-22 01:20:01.984144 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 01:20:01.986358 (Thread-1): unclosed <socket.socket fd=812, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50629), raddr=('172.217.162.202', 443)>
2021-04-22 01:20:01.989950 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50630), raddr=('142.250.218.234', 443)>
2021-04-22 01:20:02.107740 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-04-22 01:20:02.126029 (Thread-1): finished collecting timing info
2021-04-22 01:20:02.126029 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:20:02.162033 (Thread-1): On test.northwind_shop.source_unique_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.source_unique_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-04-22 01:20:05.032615 (Thread-1): finished collecting timing info
2021-04-22 01:20:05.032615 (Thread-1): 22:20:05 | 3 of 4 PASS source_unique_northwind_etl_orders_order_id.............. [PASS in 3.05s]
2021-04-22 01:20:05.041554 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 01:20:05.041554 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customer_id
2021-04-22 01:20:05.044689 (Thread-1): 22:20:05 | 4 of 4 START test unique_dim_customers_customer_id................... [RUN]
2021-04-22 01:20:05.049276 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customer_id".
2021-04-22 01:20:05.049276 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customer_id
2021-04-22 01:20:05.099311 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customer_id"
2021-04-22 01:20:05.105260 (Thread-1): finished collecting timing info
2021-04-22 01:20:05.106258 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:20:05.196920 (Thread-1): On test.northwind_shop.unique_dim_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2021-04-22 01:20:08.523698 (Thread-1): finished collecting timing info
2021-04-22 01:20:08.525506 (Thread-1): 22:20:08 | 4 of 4 PASS unique_dim_customers_customer_id......................... [PASS in 3.48s]
2021-04-22 01:20:08.531672 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customer_id
2021-04-22 01:20:08.590325 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:20:08.600750 (MainThread): 22:20:08 | 
2021-04-22 01:20:08.604688 (MainThread): 22:20:08 | Finished running 4 tests in 14.92s.
2021-04-22 01:20:08.605683 (MainThread): Connection 'master' was properly closed.
2021-04-22 01:20:08.608867 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 01:20:08.612465 (MainThread): Connection 'test.northwind_shop.unique_dim_customers_customer_id' was properly closed.
2021-04-22 01:20:08.637674 (MainThread): unclosed <socket.socket fd=720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50625), raddr=('172.217.162.202', 443)>
2021-04-22 01:20:08.640316 (MainThread): unclosed <socket.socket fd=784, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50626), raddr=('142.250.218.234', 443)>
2021-04-22 01:20:08.642626 (MainThread): unclosed <socket.socket fd=896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50628), raddr=('142.250.218.234', 443)>
2021-04-22 01:20:08.646342 (MainThread): unclosed <socket.socket fd=920, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50627), raddr=('172.217.162.202', 443)>
2021-04-22 01:20:08.664454 (MainThread): unclosed <socket.socket fd=988, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50631), raddr=('172.217.162.202', 443)>
2021-04-22 01:20:08.669118 (MainThread): unclosed <socket.socket fd=732, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50632), raddr=('142.250.218.234', 443)>
2021-04-22 01:20:08.670118 (MainThread): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50633), raddr=('172.217.162.202', 443)>
2021-04-22 01:20:08.675639 (MainThread): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50634), raddr=('142.250.218.234', 443)>
2021-04-22 01:20:08.865970 (MainThread): 
2021-04-22 01:20:08.867518 (MainThread): Completed successfully
2021-04-22 01:20:08.871049 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-04-22 01:20:08.884086 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254359B7A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254359B7A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254359B7048>]}
2021-04-22 01:20:08.885093 (MainThread): Flushing usage events
2021-04-22 01:20:43.784416 (MainThread): Running with dbt=0.19.1
2021-04-22 01:20:45.754213 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:20:45.756584 (MainThread): Tracking: tracking
2021-04-22 01:20:45.760598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C47E3EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C47E4C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C47E4F08>]}
2021-04-22 01:20:45.803054 (MainThread): Partial parsing not enabled
2021-04-22 01:20:45.813981 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:20:46.183453 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:20:46.220657 (MainThread): Parsing macros\etc.sql
2021-04-22 01:20:46.232326 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:20:46.257696 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:20:46.302986 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:20:46.316718 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:20:46.324568 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:20:46.354045 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:20:46.367996 (MainThread): Parsing macros\core.sql
2021-04-22 01:20:46.379157 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:20:46.548527 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:20:46.595852 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:20:46.597324 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:20:46.615364 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:20:46.627283 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:20:46.634994 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:20:46.642800 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:20:46.693085 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:20:46.760437 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:20:46.776242 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:20:46.797067 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:20:46.848028 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:20:46.935752 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:20:46.938198 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:20:46.987149 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:20:47.008294 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:20:47.017651 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:20:47.036016 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:20:47.038073 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:20:47.038073 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:20:47.050248 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:20:47.064827 (MainThread): Partial parsing not enabled
2021-04-22 01:20:47.115633 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:20:47.139376 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:20:47.148108 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:20:47.158264 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:20:47.168286 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:20:47.187661 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:20:47.197005 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:20:47.198003 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:20:47.208215 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:20:47.217827 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:20:47.227953 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:20:47.235576 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:20:47.440556 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 01:20:47.446490 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39096c71-0e20-4cce-9c23-9b5d79a0144d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C8275508>]}
2021-04-22 01:20:47.478812 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39096c71-0e20-4cce-9c23-9b5d79a0144d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C82B2248>]}
2021-04-22 01:20:47.478812 (MainThread): Found 12 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 01:20:47.485395 (MainThread): 
2021-04-22 01:20:47.490452 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:20:47.498295 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 01:20:47.500149 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 01:20:47.517882 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 01:20:48.964697 (MainThread): 22:20:48 | Concurrency: 1 threads (target='dev')
2021-04-22 01:20:48.965729 (MainThread): 22:20:48 | 
2021-04-22 01:20:48.971071 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-04-22 01:20:48.972068 (Thread-1): 22:20:48 | 1 of 4 START test not_null_dim_customers_customer_sk................. [RUN]
2021-04-22 01:20:48.973097 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customer_sk".
2021-04-22 01:20:48.974143 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customer_sk
2021-04-22 01:20:48.998393 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customer_sk"
2021-04-22 01:20:49.002992 (Thread-1): finished collecting timing info
2021-04-22 01:20:49.003992 (Thread-1): Opening a new connection, currently in state init
2021-04-22 01:20:49.021413 (Thread-1): On test.northwind_shop.not_null_dim_customers_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.not_null_dim_customers_customer_sk"} */

    
    



select count(*) as validation_errors
from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
where customer_sk is null



2021-04-22 01:20:52.749243 (Thread-1): finished collecting timing info
2021-04-22 01:20:52.749243 (Thread-1): 22:20:52 | 1 of 4 PASS not_null_dim_customers_customer_sk....................... [PASS in 3.78s]
2021-04-22 01:20:52.757817 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-04-22 01:20:52.759244 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 01:20:52.761836 (Thread-1): 22:20:52 | 2 of 4 START test source_not_null_northwind_etl_orders_order_id...... [RUN]
2021-04-22 01:20:52.766027 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-04-22 01:20:52.767025 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 01:20:52.806038 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-04-22 01:20:52.810703 (Thread-1): finished collecting timing info
2021-04-22 01:20:52.811706 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:20:52.894687 (Thread-1): On test.northwind_shop.source_not_null_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from `tutorial-dbt-310721`.`northwind_etl`.`orders`
where order_id is null



2021-04-22 01:20:55.857799 (Thread-1): finished collecting timing info
2021-04-22 01:20:55.858374 (Thread-1): 22:20:55 | 2 of 4 PASS source_not_null_northwind_etl_orders_order_id............ [PASS in 3.09s]
2021-04-22 01:20:55.859423 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 01:20:55.860561 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 01:20:55.860561 (Thread-1): 22:20:55 | 3 of 4 START test source_unique_northwind_etl_orders_order_id........ [RUN]
2021-04-22 01:20:55.861560 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-04-22 01:20:55.861560 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 01:20:55.884738 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-04-22 01:20:55.884738 (Thread-1): finished collecting timing info
2021-04-22 01:20:55.884738 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:20:55.907826 (Thread-1): On test.northwind_shop.source_unique_northwind_etl_orders_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.source_unique_northwind_etl_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2021-04-22 01:20:58.922578 (Thread-1): finished collecting timing info
2021-04-22 01:20:58.924823 (Thread-1): 22:20:58 | 3 of 4 PASS source_unique_northwind_etl_orders_order_id.............. [PASS in 3.06s]
2021-04-22 01:20:58.929575 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 01:20:58.931671 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customer_sk
2021-04-22 01:20:58.934247 (Thread-1): 22:20:58 | 4 of 4 START test unique_dim_customers_customer_sk................... [RUN]
2021-04-22 01:20:58.938751 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customer_sk".
2021-04-22 01:20:58.941053 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customer_sk
2021-04-22 01:20:58.945509 (Thread-1): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50650), raddr=('172.217.162.202', 443)>
2021-04-22 01:20:58.951852 (Thread-1): unclosed <socket.socket fd=1168, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50651), raddr=('142.250.218.234', 443)>
2021-04-22 01:20:58.983024 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customer_sk"
2021-04-22 01:20:58.995636 (Thread-1): finished collecting timing info
2021-04-22 01:20:58.997980 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:20:59.092096 (Thread-1): On test.northwind_shop.unique_dim_customers_customer_sk: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.unique_dim_customers_customer_sk"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_sk

    from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    where customer_sk is not null
    group by customer_sk
    having count(*) > 1

) validation_errors



2021-04-22 01:21:02.583991 (Thread-1): finished collecting timing info
2021-04-22 01:21:02.586025 (Thread-1): 22:21:02 | 4 of 4 PASS unique_dim_customers_customer_sk......................... [PASS in 3.65s]
2021-04-22 01:21:02.590971 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customer_sk
2021-04-22 01:21:02.669260 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:21:02.670263 (MainThread): 22:21:02 | 
2021-04-22 01:21:02.672803 (MainThread): 22:21:02 | Finished running 4 tests in 15.18s.
2021-04-22 01:21:02.673799 (MainThread): Connection 'master' was properly closed.
2021-04-22 01:21:02.673799 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 01:21:02.673799 (MainThread): Connection 'test.northwind_shop.unique_dim_customers_customer_sk' was properly closed.
2021-04-22 01:21:02.685211 (MainThread): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50643), raddr=('172.217.162.202', 443)>
2021-04-22 01:21:02.685211 (MainThread): unclosed <socket.socket fd=668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50644), raddr=('142.250.218.234', 443)>
2021-04-22 01:21:02.685211 (MainThread): unclosed <socket.socket fd=696, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50646), raddr=('142.250.218.234', 443)>
2021-04-22 01:21:02.685211 (MainThread): unclosed <socket.socket fd=1016, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50645), raddr=('172.217.162.202', 443)>
2021-04-22 01:21:02.693568 (MainThread): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50649), raddr=('142.250.218.234', 443)>
2021-04-22 01:21:02.695559 (MainThread): unclosed <socket.socket fd=1176, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50648), raddr=('172.217.162.202', 443)>
2021-04-22 01:21:02.708010 (MainThread): unclosed <socket.socket fd=992, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50652), raddr=('172.217.162.202', 443)>
2021-04-22 01:21:02.708010 (MainThread): unclosed <socket.socket fd=940, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50653), raddr=('142.250.218.234', 443)>
2021-04-22 01:21:02.914529 (MainThread): 
2021-04-22 01:21:02.915527 (MainThread): Completed successfully
2021-04-22 01:21:02.917527 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-04-22 01:21:02.921792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C4799C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C4799548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209C47999C8>]}
2021-04-22 01:21:02.921792 (MainThread): Flushing usage events
2021-04-22 01:22:50.815722 (MainThread): Running with dbt=0.19.1
2021-04-22 01:22:52.573384 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 01:22:52.574687 (MainThread): Tracking: tracking
2021-04-22 01:22:52.575685 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF59CAA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF59D5FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF59D5F48>]}
2021-04-22 01:22:52.624351 (MainThread): Partial parsing not enabled
2021-04-22 01:22:52.636561 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:22:52.767858 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:22:52.804257 (MainThread): Parsing macros\etc.sql
2021-04-22 01:22:52.813510 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:22:52.856626 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:22:52.958195 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:22:52.985940 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:22:52.990920 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:22:53.056020 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:22:53.094205 (MainThread): Parsing macros\core.sql
2021-04-22 01:22:53.122190 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:22:53.373955 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:22:53.439746 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:22:53.448754 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:22:53.456083 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:22:53.471416 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:22:53.475046 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:22:53.485241 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:22:53.541200 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:22:53.618492 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:22:53.624083 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:22:53.670966 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:22:53.815844 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:22:54.020833 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:22:54.039523 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:22:54.188529 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:22:54.243567 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:22:54.273836 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:22:54.317413 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:22:54.325694 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:22:54.337147 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:22:54.350119 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:22:54.387496 (MainThread): Partial parsing not enabled
2021-04-22 01:22:54.546198 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:22:54.582915 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:22:54.595702 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:22:54.602183 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:22:54.615371 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:22:54.633035 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:22:54.646286 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:22:54.659706 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:22:54.673014 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:22:54.688040 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:22:54.701464 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:22:54.714316 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:22:55.010976 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 01:22:55.014967 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF9665088>]}
2021-04-22 01:22:55.055072 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF94A9C08>]}
2021-04-22 01:22:55.055072 (MainThread): Found 12 models, 4 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 01:22:55.070520 (MainThread): 
2021-04-22 01:22:55.073554 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:22:55.088336 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 01:22:55.089893 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 01:22:56.552773 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 01:22:56.561918 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 01:22:56.594008 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 01:22:58.041469 (MainThread): 22:22:58 | Concurrency: 1 threads (target='dev')
2021-04-22 01:22:58.046221 (MainThread): 22:22:58 | 
2021-04-22 01:22:58.078371 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-22 01:22:58.081920 (Thread-1): 22:22:58 | 1 of 12 START view model dbt_isadora.stg_customers................... [RUN]
2021-04-22 01:22:58.089547 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:22:58.089547 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-22 01:22:58.156189 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-22 01:22:58.170322 (Thread-1): finished collecting timing info
2021-04-22 01:22:58.300792 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-22 01:22:58.303410 (Thread-1): Opening a new connection, currently in state init
2021-04-22 01:22:58.314298 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-22 01:23:00.983331 (Thread-1): finished collecting timing info
2021-04-22 01:23:00.985325 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF94AD088>]}
2021-04-22 01:23:00.987321 (Thread-1): 22:23:00 | 1 of 12 OK created view model dbt_isadora.stg_customers.............. [OK in 2.90s]
2021-04-22 01:23:00.989701 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-22 01:23:00.990706 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-22 01:23:00.993043 (Thread-1): 22:23:00 | 2 of 12 START view model dbt_isadora.stg_employees................... [RUN]
2021-04-22 01:23:00.995551 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:23:00.999795 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-22 01:23:01.002787 (Thread-1): unclosed <socket.socket fd=744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50674), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:01.003784 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50675), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:01.017911 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-22 01:23:01.020486 (Thread-1): finished collecting timing info
2021-04-22 01:23:01.055417 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-22 01:23:01.072119 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:01.119508 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-22 01:23:03.925752 (Thread-1): finished collecting timing info
2021-04-22 01:23:03.928730 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF5A9B5C8>]}
2021-04-22 01:23:03.930432 (Thread-1): 22:23:03 | 2 of 12 OK created view model dbt_isadora.stg_employees.............. [OK in 2.93s]
2021-04-22 01:23:03.935859 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-22 01:23:03.935859 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-22 01:23:03.937783 (Thread-1): 22:23:03 | 3 of 12 START view model dbt_isadora.stg_products.................... [RUN]
2021-04-22 01:23:03.940773 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:23:03.941195 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-22 01:23:03.954795 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-22 01:23:03.960651 (Thread-1): finished collecting timing info
2021-04-22 01:23:04.119955 (Thread-1): unclosed <socket.socket fd=744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50678), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:04.120987 (Thread-1): unclosed <socket.socket fd=1108, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50677), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:04.136096 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-22 01:23:04.138619 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:04.165683 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-22 01:23:06.789597 (Thread-1): finished collecting timing info
2021-04-22 01:23:06.790683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF9491208>]}
2021-04-22 01:23:06.792087 (Thread-1): 22:23:06 | 3 of 12 OK created view model dbt_isadora.stg_products............... [OK in 2.85s]
2021-04-22 01:23:06.799493 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-22 01:23:06.801322 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-22 01:23:06.802316 (Thread-1): 22:23:06 | 4 of 12 START view model dbt_isadora.stg_shippers.................... [RUN]
2021-04-22 01:23:06.805568 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:23:06.805568 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-22 01:23:06.823971 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-22 01:23:06.832223 (Thread-1): finished collecting timing info
2021-04-22 01:23:06.855445 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-22 01:23:06.864372 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:06.955105 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-22 01:23:09.412952 (Thread-1): finished collecting timing info
2021-04-22 01:23:09.412952 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF96CFA48>]}
2021-04-22 01:23:09.420093 (Thread-1): 22:23:09 | 4 of 12 OK created view model dbt_isadora.stg_shippers............... [OK in 2.61s]
2021-04-22 01:23:09.424742 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-22 01:23:09.426738 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-22 01:23:09.430649 (Thread-1): 22:23:09 | 5 of 12 START view model dbt_isadora.stg_order_details............... [RUN]
2021-04-22 01:23:09.434786 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:23:09.436218 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-22 01:23:09.439836 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50681), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:09.443455 (Thread-1): unclosed <socket.socket fd=1216, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50682), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:09.466028 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-22 01:23:09.471798 (Thread-1): finished collecting timing info
2021-04-22 01:23:09.512999 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-22 01:23:09.518867 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:09.600021 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-22 01:23:12.134015 (Thread-1): finished collecting timing info
2021-04-22 01:23:12.136739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF5A172C8>]}
2021-04-22 01:23:12.136739 (Thread-1): 22:23:12 | 5 of 12 OK created view model dbt_isadora.stg_order_details.......... [OK in 2.70s]
2021-04-22 01:23:12.143913 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-22 01:23:12.147713 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-22 01:23:12.149862 (Thread-1): 22:23:12 | 6 of 12 START view model dbt_isadora.stg_orders...................... [RUN]
2021-04-22 01:23:12.156425 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:23:12.158583 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-22 01:23:12.186723 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-22 01:23:12.188594 (Thread-1): finished collecting timing info
2021-04-22 01:23:12.200838 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-22 01:23:12.204096 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:12.219638 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-22 01:23:13.958121 (Thread-1): finished collecting timing info
2021-04-22 01:23:13.960722 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF9670B08>]}
2021-04-22 01:23:13.961192 (Thread-1): 22:23:13 | 6 of 12 OK created view model dbt_isadora.stg_orders................. [OK in 1.81s]
2021-04-22 01:23:13.967965 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-22 01:23:13.970693 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-22 01:23:13.974865 (Thread-1): 22:23:13 | 7 of 12 START view model dbt_isadora.stg_suppliers................... [RUN]
2021-04-22 01:23:13.980824 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:23:13.983043 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-22 01:23:14.002682 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-22 01:23:14.021849 (Thread-1): finished collecting timing info
2021-04-22 01:23:14.051918 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-22 01:23:14.058714 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:14.134668 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-22 01:23:16.541883 (Thread-1): finished collecting timing info
2021-04-22 01:23:16.544930 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF9559788>]}
2021-04-22 01:23:16.544930 (Thread-1): 22:23:16 | 7 of 12 OK created view model dbt_isadora.stg_suppliers.............. [OK in 2.57s]
2021-04-22 01:23:16.553515 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-22 01:23:16.554718 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-22 01:23:16.557708 (Thread-1): 22:23:16 | 8 of 12 START view model dbt_isadora.dim_customers................... [RUN]
2021-04-22 01:23:16.563966 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:23:16.564961 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-22 01:23:16.603218 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-22 01:23:16.645832 (Thread-1): finished collecting timing info
2021-04-22 01:23:16.670386 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-22 01:23:16.854186 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:16.891382 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 01:23:16.899958 (Thread-1): unclosed <socket.socket fd=1188, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50680), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:16.899958 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50679), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:16.913447 (Thread-1): unclosed <socket.socket fd=1256, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50684), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:16.913447 (Thread-1): unclosed <socket.socket fd=1200, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50685), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:16.913447 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50686), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:16.913447 (Thread-1): unclosed <socket.socket fd=1288, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50687), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:16.919649 (Thread-1): unclosed <socket.socket fd=1328, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50688), raddr=('172.217.28.10', 443)>
2021-04-22 01:23:16.921903 (Thread-1): unclosed <socket.socket fd=1220, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50689), raddr=('142.250.218.234', 443)>
2021-04-22 01:23:19.396513 (Thread-1): finished collecting timing info
2021-04-22 01:23:19.396513 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF976D908>]}
2021-04-22 01:23:19.399732 (Thread-1): 22:23:19 | 8 of 12 OK created view model dbt_isadora.dim_customers.............. [OK in 2.84s]
2021-04-22 01:23:19.404310 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-22 01:23:19.407789 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-22 01:23:19.409873 (Thread-1): 22:23:19 | 9 of 12 START view model dbt_isadora.dim_employees................... [RUN]
2021-04-22 01:23:19.413666 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:23:19.415671 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-22 01:23:19.440535 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-22 01:23:19.449694 (Thread-1): finished collecting timing info
2021-04-22 01:23:19.480053 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-04-22 01:23:19.485073 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:19.559921 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
    )

    , transformed as (
        select
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 01:23:21.551359 (Thread-1): finished collecting timing info
2021-04-22 01:23:21.552820 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF954AE08>]}
2021-04-22 01:23:21.557837 (Thread-1): 22:23:21 | 9 of 12 OK created view model dbt_isadora.dim_employees.............. [OK in 2.14s]
2021-04-22 01:23:21.565960 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-22 01:23:21.567410 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-22 01:23:21.569840 (Thread-1): 22:23:21 | 10 of 12 START view model dbt_isadora.dim_products................... [RUN]
2021-04-22 01:23:21.573882 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:23:21.579720 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-22 01:23:21.609781 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-22 01:23:21.616479 (Thread-1): finished collecting timing info
2021-04-22 01:23:21.647255 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-22 01:23:21.649817 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:21.662031 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 01:23:24.215865 (Thread-1): finished collecting timing info
2021-04-22 01:23:24.215865 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BFA78C788>]}
2021-04-22 01:23:24.215865 (Thread-1): 22:23:24 | 10 of 12 OK created view model dbt_isadora.dim_products.............. [OK in 2.64s]
2021-04-22 01:23:24.227172 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-22 01:23:24.229531 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-22 01:23:24.231937 (Thread-1): 22:23:24 | 11 of 12 START view model dbt_isadora.dim_shippers................... [RUN]
2021-04-22 01:23:24.235540 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:23:24.237218 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-22 01:23:24.264383 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-22 01:23:24.270908 (Thread-1): finished collecting timing info
2021-04-22 01:23:24.294257 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-22 01:23:24.307637 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:24.375949 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 01:23:26.865075 (Thread-1): finished collecting timing info
2021-04-22 01:23:26.865075 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BFA74A808>]}
2021-04-22 01:23:26.873180 (Thread-1): 22:23:26 | 11 of 12 OK created view model dbt_isadora.dim_shippers.............. [OK in 2.63s]
2021-04-22 01:23:26.878611 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-22 01:23:26.881717 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-22 01:23:26.882718 (Thread-1): 22:23:26 | 12 of 12 START view model dbt_isadora.fact_order_details............. [RUN]
2021-04-22 01:23:26.889102 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:23:26.890276 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-22 01:23:26.942370 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-22 01:23:26.949904 (Thread-1): finished collecting timing info
2021-04-22 01:23:26.979399 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-22 01:23:26.986251 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:23:27.026021 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
        left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details_with_sk.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-22 01:23:29.629908 (Thread-1): finished collecting timing info
2021-04-22 01:23:29.629908 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eb1f4a-1eec-412a-8753-bf556923f963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BFA7C2548>]}
2021-04-22 01:23:29.637995 (Thread-1): 22:23:29 | 12 of 12 OK created view model dbt_isadora.fact_order_details........ [OK in 2.74s]
2021-04-22 01:23:29.642810 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-22 01:23:29.708579 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:23:29.708579 (MainThread): 22:23:29 | 
2021-04-22 01:23:29.714202 (MainThread): 22:23:29 | Finished running 12 view models in 34.64s.
2021-04-22 01:23:29.716621 (MainThread): Connection 'master' was properly closed.
2021-04-22 01:23:29.716621 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 01:23:29.716621 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 01:23:29.722012 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-22 01:23:29.788850 (MainThread): 
2021-04-22 01:23:29.801749 (MainThread): Completed successfully
2021-04-22 01:23:29.816500 (MainThread): 
Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
2021-04-22 01:23:29.822605 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BFA7BD5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BFA751148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BF96A8D08>]}
2021-04-22 01:23:29.822605 (MainThread): Flushing usage events
2021-04-22 01:35:16.717252 (MainThread): Running with dbt=0.19.1
2021-04-22 01:35:17.775833 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:35:17.776867 (MainThread): Tracking: tracking
2021-04-22 01:35:17.776867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D563E60608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D563F65D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D563F65C48>]}
2021-04-22 01:35:17.796531 (MainThread): Partial parsing not enabled
2021-04-22 01:35:17.805724 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:35:17.856442 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:35:17.876490 (MainThread): Parsing macros\etc.sql
2021-04-22 01:35:17.879058 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:35:17.894276 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:35:17.935355 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:35:17.944958 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:35:17.948325 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:35:17.984226 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:35:17.999376 (MainThread): Parsing macros\core.sql
2021-04-22 01:35:18.006526 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:35:18.136555 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:35:18.167981 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:35:18.170419 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:35:18.175467 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:35:18.183253 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:35:18.186701 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:35:18.186701 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:35:18.215936 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:35:18.257569 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:35:18.267204 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:35:18.289097 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:35:18.388294 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:35:18.564894 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:35:18.578568 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:35:18.681536 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:35:18.717944 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:35:18.750173 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:35:18.792503 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:35:18.809725 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:35:18.820480 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:35:18.840121 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:35:18.882682 (MainThread): Partial parsing not enabled
2021-04-22 01:35:19.006705 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:35:19.077398 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:35:19.102958 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:35:19.129120 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:35:19.186297 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:35:19.247026 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:35:19.277125 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:35:19.340552 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:35:19.378038 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:35:19.409050 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:35:19.438300 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:35:19.457422 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:35:19.669781 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D567A686C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D567A68688>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D567A687C8>]}
2021-04-22 01:35:19.669781 (MainThread): Flushing usage events
2021-04-22 01:35:22.319165 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-22 01:35:22.319165 (MainThread): Encountered an error:
2021-04-22 01:35:22.319165 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: products_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6
2021-04-22 01:35:22.638216 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 16
  ------------------------------
  13 |           to: ref('dim_customers')
  14 |           field: customer_sk
  15 | 
  16 |      - name: products_fk
  17 |         tests:
  18 |         - relationships:
  19 |           to: ref('dim_products')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: products_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6

2021-04-22 01:36:52.377847 (MainThread): Running with dbt=0.19.1
2021-04-22 01:36:53.231394 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:36:53.232428 (MainThread): Tracking: tracking
2021-04-22 01:36:53.232428 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF4B408748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF4BB2B208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF4BB2B188>]}
2021-04-22 01:36:53.250862 (MainThread): Partial parsing not enabled
2021-04-22 01:36:53.250862 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:36:53.296223 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:36:53.305280 (MainThread): Parsing macros\etc.sql
2021-04-22 01:36:53.305280 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:36:53.322040 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:36:53.348740 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:36:53.348740 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:36:53.348740 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:36:53.381335 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:36:53.381335 (MainThread): Parsing macros\core.sql
2021-04-22 01:36:53.397002 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:36:53.486856 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:36:53.507376 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:36:53.523060 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:36:53.529077 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:36:53.530076 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:36:53.530076 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:36:53.530076 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:36:53.565005 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:36:53.605658 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:36:53.607153 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:36:53.622822 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:36:53.670933 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:36:53.756081 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:36:53.756081 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:36:53.806684 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:36:53.822354 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:36:53.839054 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:36:53.839054 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:36:53.854718 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:36:53.854718 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:36:53.854718 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:36:53.871918 (MainThread): Partial parsing not enabled
2021-04-22 01:36:53.923162 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:36:53.956758 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:36:53.956758 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:36:53.973930 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:36:53.989613 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:36:53.989613 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:36:54.008380 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:36:54.009378 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:36:54.019513 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:36:54.029866 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:36:54.038961 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:36:54.038961 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:36:54.127765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF4F625848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF4F6258C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF4F625948>]}
2021-04-22 01:36:54.127765 (MainThread): Flushing usage events
2021-04-22 01:36:54.988690 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-22 01:36:54.988690 (MainThread): Encountered an error:
2021-04-22 01:36:54.990248 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: products_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6
2021-04-22 01:36:55.029864 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 16
  ------------------------------
  13 |           to: ref('dim_customers')
  14 |           field: customer_sk
  15 | 
  16 |      - name: products_fk
  17 |         tests:
  18 |         - relationships:
  19 |           to: ref('dim_products')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: products_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6

2021-04-22 01:37:10.543164 (MainThread): Running with dbt=0.19.1
2021-04-22 01:37:11.480220 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:37:11.480220 (MainThread): Tracking: tracking
2021-04-22 01:37:11.480220 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB5235D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB5235DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB5235E08>]}
2021-04-22 01:37:11.502976 (MainThread): Partial parsing not enabled
2021-04-22 01:37:11.511025 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:37:11.558330 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:37:11.576950 (MainThread): Parsing macros\etc.sql
2021-04-22 01:37:11.584952 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:37:11.594500 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:37:11.637727 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:37:11.648379 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:37:11.650373 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:37:11.686227 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:37:11.702993 (MainThread): Parsing macros\core.sql
2021-04-22 01:37:11.714194 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:37:11.835993 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:37:11.861150 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:37:11.861150 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:37:11.861150 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:37:11.872692 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:37:11.872692 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:37:11.882538 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:37:11.899646 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:37:11.946327 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:37:11.946327 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:37:11.969087 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:37:12.022193 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:37:12.111900 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:37:12.119956 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:37:12.176178 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:37:12.192235 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:37:12.201389 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:37:12.221159 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:37:12.229217 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:37:12.237217 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:37:12.237217 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:37:12.253216 (MainThread): Partial parsing not enabled
2021-04-22 01:37:12.318495 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:37:12.344473 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:37:12.354653 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:37:12.364822 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:37:12.375012 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:37:12.386420 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:37:12.396609 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:37:12.409700 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:37:12.414297 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:37:12.422304 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:37:12.433558 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:37:12.443769 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:37:12.561902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB8D35808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB8D35888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DB8D35908>]}
2021-04-22 01:37:12.562944 (MainThread): Flushing usage events
2021-04-22 01:37:13.373668 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-22 01:37:13.375674 (MainThread): Encountered an error:
2021-04-22 01:37:13.387935 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: product_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6
2021-04-22 01:37:13.496061 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 16
  ------------------------------
  13 |           to: ref('dim_customers')
  14 |           field: customer_sk
  15 | 
  16 |      - name: product_fk
  17 |         tests:
  18 |         - relationships:
  19 |           to: ref('dim_products')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: product_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6

2021-04-22 01:39:15.814476 (MainThread): Running with dbt=0.19.1
2021-04-22 01:39:17.090197 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:39:17.090197 (MainThread): Tracking: tracking
2021-04-22 01:39:17.090197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0FCCA2E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0FCCB3F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0FCCB4F88>]}
2021-04-22 01:39:17.121272 (MainThread): Partial parsing not enabled
2021-04-22 01:39:17.121272 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:39:17.173190 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:39:17.191179 (MainThread): Parsing macros\etc.sql
2021-04-22 01:39:17.199232 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:39:17.207240 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:39:17.241717 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:39:17.249718 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:39:17.257719 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:39:17.282950 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:39:17.298945 (MainThread): Parsing macros\core.sql
2021-04-22 01:39:17.306947 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:39:17.438267 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:39:17.457395 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:39:17.464505 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:39:17.469242 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:39:17.475015 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:39:17.477691 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:39:17.477691 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:39:17.507330 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:39:17.538797 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:39:17.549067 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:39:17.558774 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:39:17.616915 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:39:17.703162 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:39:17.712767 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:39:17.757030 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:39:17.777736 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:39:17.793890 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:39:17.811128 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:39:17.811128 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:39:17.819128 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:39:17.827127 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:39:17.840846 (MainThread): Partial parsing not enabled
2021-04-22 01:39:17.910936 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:39:17.934229 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:39:17.943479 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:39:17.954150 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:39:17.967513 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:39:17.976823 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:39:17.986245 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:39:18.001720 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:39:18.011186 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:39:18.019206 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:39:18.033269 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:39:18.043826 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:39:18.158827 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0FF7EA5C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0FF7EA608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0FF7EA6C8>]}
2021-04-22 01:39:18.158827 (MainThread): Flushing usage events
2021-04-22 01:39:20.293426 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-22 01:39:20.294420 (MainThread): Encountered an error:
2021-04-22 01:39:20.295415 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: product_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6
2021-04-22 01:39:20.354542 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 16
  ------------------------------
  13 |           to: ref('dim_customers')
  14 |           field: customer_sk
  15 | 
  16 |      - name: product_fk
  17 |         tests:
  18 |         - relationships:
  19 |           to: ref('dim_products')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |           to: ref('dim_customers')
    14 |           field: customer_sk
    15 | 
    16 |      - name: product_fk
    17 |         tests:
    18 |         - relationships:
    19 |           to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6

2021-04-22 01:43:36.189447 (MainThread): Running with dbt=0.19.1
2021-04-22 01:43:37.038372 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:43:37.038372 (MainThread): Tracking: tracking
2021-04-22 01:43:37.038372 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1FDB4D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1FDB4A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D1FDB4D88>]}
2021-04-22 01:43:37.063981 (MainThread): Partial parsing not enabled
2021-04-22 01:43:37.063981 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:43:37.108176 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:43:37.124174 (MainThread): Parsing macros\etc.sql
2021-04-22 01:43:37.132138 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:43:37.142956 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:43:37.174969 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:43:37.182971 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:43:37.190973 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:43:37.214969 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:43:37.230971 (MainThread): Parsing macros\core.sql
2021-04-22 01:43:37.238971 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:43:37.331191 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:43:37.348203 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:43:37.348203 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:43:37.357811 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:43:37.357811 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:43:37.365906 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:43:37.367970 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:43:37.386388 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:43:37.408637 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:43:37.418768 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:43:37.428900 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:43:37.479386 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:43:37.550187 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:43:37.550239 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:43:37.592108 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:43:37.613537 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:43:37.621539 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:43:37.642411 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:43:37.653751 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:43:37.653751 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:43:37.660824 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:43:37.681043 (MainThread): Partial parsing not enabled
2021-04-22 01:43:37.752605 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:43:37.777934 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:43:37.786131 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:43:37.797293 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:43:37.805465 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:43:37.816736 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:43:37.825865 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:43:37.837053 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:43:37.846192 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:43:37.857334 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:43:37.866544 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:43:37.876676 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:43:37.988700 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D238C4888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D238C4948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D238C49C8>]}
2021-04-22 01:43:37.988700 (MainThread): Flushing usage events
2021-04-22 01:43:38.993321 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-22 01:43:38.994316 (MainThread): Encountered an error:
2021-04-22 01:43:38.994316 (MainThread): Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |               to: ref('dim_customers')
    14 |               field: customer_sk
    15 | 
    16 |      - name: product_fk
    17 |         tests:
    18 |           - relationships:
    19 |               to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6
2021-04-22 01:43:39.024478 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\__init__.py", line 114, in load
    return loader.get_single_data()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\yaml\constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml\_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml\_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 851, in yaml._yaml.CParser._compose_sequence_node
  File "yaml\_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml\_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml\_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 4, column 5
did not find expected key
  in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 247, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 16
  ------------------------------
  13 |               to: ref('dim_customers')
  14 |               field: customer_sk
  15 | 
  16 |      - name: product_fk
  17 |         tests:
  18 |           - relationships:
  19 |               to: ref('dim_products')
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 4, column 5
  did not find expected key
    in "<unicode string>", line 16, column 6

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 624, in parse_file
    dct = self._yaml_from_file(block.file)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 252, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading northwind_shop: marts\fact_order_details.yml - Runtime Error
    Syntax error near line 16
    ------------------------------
    13 |               to: ref('dim_customers')
    14 |               field: customer_sk
    15 | 
    16 |      - name: product_fk
    17 |         tests:
    18 |           - relationships:
    19 |               to: ref('dim_products')
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 4, column 5
    did not find expected key
      in "<unicode string>", line 16, column 6

2021-04-22 01:45:04.218570 (MainThread): Running with dbt=0.19.1
2021-04-22 01:45:05.223561 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:45:05.231563 (MainThread): Tracking: tracking
2021-04-22 01:45:05.231563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28FDE5D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28FDD9E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E28FDD93C8>]}
2021-04-22 01:45:05.247603 (MainThread): Partial parsing not enabled
2021-04-22 01:45:05.255602 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:45:05.298126 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:45:05.315256 (MainThread): Parsing macros\etc.sql
2021-04-22 01:45:05.315256 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:45:05.323308 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:45:05.347272 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:45:05.355307 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:45:05.363309 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:45:05.382661 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:45:05.390706 (MainThread): Parsing macros\core.sql
2021-04-22 01:45:05.398705 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:45:05.479840 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:45:05.501639 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:45:05.502672 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:45:05.502672 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:45:05.511319 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:45:05.513723 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:45:05.513723 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:45:05.531589 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:45:05.558304 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:45:05.566574 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:45:05.579170 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:45:05.619909 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:45:05.693440 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:45:05.701457 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:45:05.739741 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:45:05.759871 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:45:05.770084 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:45:05.790486 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:45:05.798509 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:45:05.798509 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:45:05.807661 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:45:05.824914 (MainThread): Partial parsing not enabled
2021-04-22 01:45:05.885142 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:45:05.909954 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:45:05.915778 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:45:05.925894 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:45:05.937973 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:45:05.948697 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:45:05.953280 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:45:05.961287 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:45:05.969286 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:45:05.977251 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:45:05.988312 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:45:05.998939 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:45:06.113365 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2938B60C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2938B6908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2938B6F08>]}
2021-04-22 01:45:06.113365 (MainThread): Flushing usage events
2021-04-22 01:45:07.017877 (MainThread): Connection 'model.northwind_shop.stg_suppliers' was properly closed.
2021-04-22 01:45:07.017877 (MainThread): Encountered an error:
2021-04-22 01:45:07.019903 (MainThread): Compilation Error
  Invalid test config given in models\marts\fact_order_details.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_shippers')"), ('field', 'shipper_sk')] instead (3 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2021-04-22 01:45:07.169442 (MainThread): Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 423, in _parse_generic_test
    render_ctx=render_ctx,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schema_test_builders.py", line 198, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schema_test_builders.py", line 249, in extract_test_args
    ' {} instead ({} keys)'.format(test, len(test))
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_shippers')"), ('field', 'shipper_sk')] instead (3 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\main.py", line 256, in run_from_args
    results = task.run()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 406, in run
    self._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 862, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 442, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 290, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 237, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\manifest.py", line 188, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 655, in parse_file
    self.parse_tests(test_block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 613, in parse_tests
    self.parse_column_tests(block, column)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 263, in parse_column_tests
    self.parse_test(block, test, column)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 609, in parse_test
    self.parse_node(block)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 559, in parse_node
    column_name=block.column_name,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\parser\schemas.py", line 432, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models\marts\fact_order_details.yml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_shippers')"), ('field', 'shipper_sk')] instead (3 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2021-04-22 01:46:52.993735 (MainThread): Running with dbt=0.19.1
2021-04-22 01:46:53.885655 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:46:53.885655 (MainThread): Tracking: tracking
2021-04-22 01:46:53.885655 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5C8E0608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5CA24D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5CA24E88>]}
2021-04-22 01:46:53.912572 (MainThread): Partial parsing not enabled
2021-04-22 01:46:53.912572 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:46:53.968894 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:46:53.984889 (MainThread): Parsing macros\etc.sql
2021-04-22 01:46:53.992851 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:46:54.007491 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:46:54.043439 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:46:54.043439 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:46:54.051475 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:46:54.077493 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:46:54.095770 (MainThread): Parsing macros\core.sql
2021-04-22 01:46:54.103819 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:46:54.226145 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:46:54.256293 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:46:54.257328 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:46:54.257328 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:46:54.265388 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:46:54.273385 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:46:54.277503 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:46:54.301566 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:46:54.337513 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:46:54.344028 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:46:54.359711 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:46:54.418236 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:46:54.518238 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:46:54.528357 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:46:54.561831 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:46:54.577847 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:46:54.594823 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:46:54.611967 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:46:54.618513 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:46:54.618513 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:46:54.628274 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:46:54.644848 (MainThread): Partial parsing not enabled
2021-04-22 01:46:54.702051 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:46:54.727840 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:46:54.743858 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:46:54.751862 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:46:54.760744 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:46:54.777776 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:46:54.786843 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:46:54.794770 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:46:54.802842 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:46:54.810842 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:46:54.826806 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:46:54.834843 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:46:55.154221 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 01:46:55.162338 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '232f4d25-d44e-41c8-b54f-25d430939231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F6046C4C8>]}
2021-04-22 01:46:55.187433 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '232f4d25-d44e-41c8-b54f-25d430939231', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F604C8708>]}
2021-04-22 01:46:55.189110 (MainThread): Found 12 models, 12 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 01:46:55.197101 (MainThread): 
2021-04-22 01:46:55.197101 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:46:55.217387 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 01:46:55.217387 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 01:46:55.231043 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 01:46:56.710443 (MainThread): 22:46:56 | Concurrency: 1 threads (target='dev')
2021-04-22 01:46:56.712892 (MainThread): 22:46:56 | 
2021-04-22 01:46:56.729654 (Thread-1): Began running node test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 01:46:56.731109 (Thread-1): 22:46:56 | 1 of 2 START test not_null_fact_order_details_order_id............... [RUN]
2021-04-22 01:46:56.735641 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_fact_order_details_order_id".
2021-04-22 01:46:56.735641 (Thread-1): Compiling test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 01:46:56.837712 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_fact_order_details_order_id"
2021-04-22 01:46:56.853065 (Thread-1): finished collecting timing info
2021-04-22 01:46:56.855369 (Thread-1): Opening a new connection, currently in state init
2021-04-22 01:46:56.894944 (Thread-1): On test.northwind_shop.not_null_fact_order_details_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.not_null_fact_order_details_order_id"} */

    
    



select count(*) as validation_errors
from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
where order_id is null



2021-04-22 01:47:01.054359 (Thread-1): finished collecting timing info
2021-04-22 01:47:01.056096 (Thread-1): 22:47:01 | 1 of 2 PASS not_null_fact_order_details_order_id..................... [PASS in 4.32s]
2021-04-22 01:47:01.058512 (Thread-1): Finished running node test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 01:47:01.059749 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 01:47:01.061362 (Thread-1): 22:47:01 | 2 of 2 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_ [RUN]
2021-04-22 01:47:01.063495 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_".
2021-04-22 01:47:01.063495 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 01:47:01.072610 (Thread-1): unclosed <socket.socket fd=876, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50927), raddr=('172.217.28.234', 443)>
2021-04-22 01:47:01.073613 (Thread-1): unclosed <socket.socket fd=956, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50928), raddr=('142.250.218.202', 443)>
2021-04-22 01:47:01.136316 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"
2021-04-22 01:47:01.139229 (Thread-1): finished collecting timing info
2021-04-22 01:47:01.140228 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:47:01.167975 (Thread-1): On test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-04-22 01:47:05.353313 (Thread-1): finished collecting timing info
2021-04-22 01:47:05.354310 (Thread-1): 22:47:05 | 2 of 2 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_ [PASS in 4.29s]
2021-04-22 01:47:05.355355 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 01:47:05.415378 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:47:05.417555 (MainThread): 22:47:05 | 
2021-04-22 01:47:05.419260 (MainThread): 22:47:05 | Finished running 2 tests in 10.22s.
2021-04-22 01:47:05.420283 (MainThread): Connection 'master' was properly closed.
2021-04-22 01:47:05.421282 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 01:47:05.421282 (MainThread): Connection 'test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_' was properly closed.
2021-04-22 01:47:05.442004 (MainThread): 
2021-04-22 01:47:05.443001 (MainThread): Completed successfully
2021-04-22 01:47:05.445144 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-04-22 01:47:05.446800 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5C9CAC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5C9CAB88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5C9CAA88>]}
2021-04-22 01:47:05.447373 (MainThread): Flushing usage events
2021-04-22 01:48:37.575303 (MainThread): Running with dbt=0.19.1
2021-04-22 01:48:38.487953 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['fact_order_details'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 01:48:38.489394 (MainThread): Tracking: tracking
2021-04-22 01:48:38.490429 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3D5887C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3DCAB1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3DCAB148>]}
2021-04-22 01:48:38.514214 (MainThread): Partial parsing not enabled
2021-04-22 01:48:38.515214 (MainThread): Parsing macros\adapters.sql
2021-04-22 01:48:38.563306 (MainThread): Parsing macros\catalog.sql
2021-04-22 01:48:38.585529 (MainThread): Parsing macros\etc.sql
2021-04-22 01:48:38.594703 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 01:48:38.606743 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 01:48:38.640182 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 01:48:38.640182 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 01:48:38.648282 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 01:48:38.674178 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 01:48:38.690046 (MainThread): Parsing macros\core.sql
2021-04-22 01:48:38.698031 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 01:48:38.824569 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 01:48:38.848624 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 01:48:38.848624 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 01:48:38.856622 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 01:48:38.856622 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 01:48:38.864623 (MainThread): Parsing macros\etc\query.sql
2021-04-22 01:48:38.864623 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 01:48:38.890109 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 01:48:38.928333 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 01:48:38.936335 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 01:48:38.950133 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 01:48:39.010368 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 01:48:39.098182 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 01:48:39.106740 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 01:48:39.156344 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 01:48:39.175109 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 01:48:39.189097 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 01:48:39.206150 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 01:48:39.206150 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 01:48:39.215271 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 01:48:39.223426 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 01:48:39.237650 (MainThread): Partial parsing not enabled
2021-04-22 01:48:39.285694 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 01:48:39.308471 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 01:48:39.314527 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 01:48:39.322535 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 01:48:39.334401 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 01:48:39.350726 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 01:48:39.357760 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 01:48:39.368134 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 01:48:39.378716 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 01:48:39.391071 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 01:48:39.399124 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 01:48:39.408024 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 01:48:39.755875 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 01:48:39.769194 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1835af7-fe45-40f7-9473-82d6fab3ffff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3DD6D108>]}
2021-04-22 01:48:39.809288 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1835af7-fe45-40f7-9473-82d6fab3ffff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB41808DC8>]}
2021-04-22 01:48:39.809288 (MainThread): Found 12 models, 14 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 01:48:39.817860 (MainThread): 
2021-04-22 01:48:39.821659 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:48:39.837480 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 01:48:39.838477 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 01:48:39.853923 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 01:48:41.308786 (MainThread): 22:48:41 | Concurrency: 1 threads (target='dev')
2021-04-22 01:48:41.310193 (MainThread): 22:48:41 | 
2021-04-22 01:48:41.327945 (Thread-1): Began running node test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 01:48:41.328942 (Thread-1): 22:48:41 | 1 of 4 START test not_null_fact_order_details_order_id............... [RUN]
2021-04-22 01:48:41.333044 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_fact_order_details_order_id".
2021-04-22 01:48:41.334080 (Thread-1): Compiling test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 01:48:41.425495 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_fact_order_details_order_id"
2021-04-22 01:48:41.439820 (Thread-1): finished collecting timing info
2021-04-22 01:48:41.445091 (Thread-1): Opening a new connection, currently in state init
2021-04-22 01:48:41.513116 (Thread-1): On test.northwind_shop.not_null_fact_order_details_order_id: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.not_null_fact_order_details_order_id"} */

    
    



select count(*) as validation_errors
from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
where order_id is null



2021-04-22 01:48:44.701175 (Thread-1): finished collecting timing info
2021-04-22 01:48:44.701175 (Thread-1): 22:48:44 | 1 of 4 PASS not_null_fact_order_details_order_id..................... [PASS in 3.37s]
2021-04-22 01:48:44.710655 (Thread-1): Finished running node test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 01:48:44.712742 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 01:48:44.714349 (Thread-1): 22:48:44 | 2 of 4 START test relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_ [RUN]
2021-04-22 01:48:44.719519 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_".
2021-04-22 01:48:44.720513 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 01:48:44.890979 (Thread-1): unclosed <socket.socket fd=1172, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50951), raddr=('172.217.28.234', 443)>
2021-04-22 01:48:44.890979 (Thread-1): unclosed <socket.socket fd=1192, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50952), raddr=('142.250.218.202', 443)>
2021-04-22 01:48:44.914721 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"
2021-04-22 01:48:44.916227 (Thread-1): finished collecting timing info
2021-04-22 01:48:44.916227 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:48:44.926238 (Thread-1): On test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"} */

    
    




select count(*) as validation_errors
from (
    select customer_fk as id from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
) as child
left join (
    select customer_sk as id from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-04-22 01:48:47.350193 (Thread-1): finished collecting timing info
2021-04-22 01:48:47.354361 (Thread-1): 22:48:47 | 2 of 4 PASS relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_ [PASS in 2.64s]
2021-04-22 01:48:47.361075 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 01:48:47.362361 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-04-22 01:48:47.364013 (Thread-1): 22:48:47 | 3 of 4 START test relationships_fact_order_details_product_fk__product_sk__ref_dim_products_ [RUN]
2021-04-22 01:48:47.366473 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_".
2021-04-22 01:48:47.369155 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-04-22 01:48:47.423122 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_"
2021-04-22 01:48:47.439735 (Thread-1): finished collecting timing info
2021-04-22 01:48:47.443097 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:48:47.491048 (Thread-1): On test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_"} */

    
    




select count(*) as validation_errors
from (
    select product_fk as id from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
) as child
left join (
    select product_sk as id from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-04-22 01:48:51.133319 (Thread-1): finished collecting timing info
2021-04-22 01:48:51.133319 (Thread-1): 22:48:51 | 3 of 4 PASS relationships_fact_order_details_product_fk__product_sk__ref_dim_products_ [PASS in 3.77s]
2021-04-22 01:48:51.140938 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-04-22 01:48:51.142425 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-04-22 01:48:51.144769 (Thread-1): 22:48:51 | 4 of 4 START test relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_ [RUN]
2021-04-22 01:48:51.147770 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_".
2021-04-22 01:48:51.147770 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-04-22 01:48:51.157365 (Thread-1): unclosed <socket.socket fd=1100, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50957), raddr=('172.217.28.234', 443)>
2021-04-22 01:48:51.159756 (Thread-1): unclosed <socket.socket fd=1132, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 50958), raddr=('142.250.218.202', 443)>
2021-04-22 01:48:51.212947 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_"
2021-04-22 01:48:51.226501 (Thread-1): finished collecting timing info
2021-04-22 01:48:51.231882 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 01:48:51.272149 (Thread-1): On test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_"} */

    
    




select count(*) as validation_errors
from (
    select shipper_fk as id from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
) as child
left join (
    select shipper_sk as id from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2021-04-22 01:48:55.131992 (Thread-1): finished collecting timing info
2021-04-22 01:48:55.134530 (Thread-1): 22:48:55 | 4 of 4 PASS relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_ [PASS in 3.99s]
2021-04-22 01:48:55.140090 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-04-22 01:48:55.254763 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 01:48:55.254763 (MainThread): 22:48:55 | 
2021-04-22 01:48:55.258854 (MainThread): 22:48:55 | Finished running 4 tests in 15.43s.
2021-04-22 01:48:55.261056 (MainThread): Connection 'master' was properly closed.
2021-04-22 01:48:55.261056 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 01:48:55.264199 (MainThread): Connection 'test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_' was properly closed.
2021-04-22 01:48:55.333252 (MainThread): 
2021-04-22 01:48:55.334851 (MainThread): Completed successfully
2021-04-22 01:48:55.342829 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2021-04-22 01:48:55.348878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB417A5188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3DCE4E48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB3DCD2748>]}
2021-04-22 01:48:55.355952 (MainThread): Flushing usage events
2021-04-22 02:15:33.631145 (MainThread): Running with dbt=0.19.1
2021-04-22 02:15:34.940264 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['test'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:15:34.942220 (MainThread): Tracking: tracking
2021-04-22 02:15:34.943255 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EDDE9AE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE0C04E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE0C04D08>]}
2021-04-22 02:15:34.974367 (MainThread): Partial parsing not enabled
2021-04-22 02:15:34.978755 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:15:35.040621 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:15:35.062623 (MainThread): Parsing macros\etc.sql
2021-04-22 02:15:35.068879 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:15:35.084501 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:15:35.123892 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:15:35.132046 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:15:35.137692 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:15:35.168905 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:15:35.179078 (MainThread): Parsing macros\core.sql
2021-04-22 02:15:35.200266 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:15:35.331594 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:15:35.358066 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:15:35.364532 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:15:35.373463 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:15:35.380090 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:15:35.386671 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:15:35.390514 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:15:35.419414 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:15:35.459190 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:15:35.472000 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:15:35.491393 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:15:35.558891 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:15:35.658809 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:15:35.670941 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:15:35.742251 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:15:35.782700 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:15:35.804276 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:15:35.824867 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:15:35.828785 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:15:35.828785 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:15:35.840763 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:15:35.854582 (MainThread): Partial parsing not enabled
2021-04-22 02:15:35.907254 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:15:35.935031 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:15:35.943706 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:15:35.956325 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:15:35.965372 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:15:35.978267 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:15:35.988662 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:15:35.996766 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:15:36.007478 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:15:36.018523 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:15:36.029048 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:15:36.041615 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:15:36.079616 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:15:36.441556 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:15:36.448895 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebb31ab1-96af-4840-a87b-1a3fecfca3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE46B7B08>]}
2021-04-22 02:15:36.484266 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebb31ab1-96af-4840-a87b-1a3fecfca3e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE4721748>]}
2021-04-22 02:15:36.484266 (MainThread): Found 12 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 02:15:36.498384 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-04-22 02:15:36.499438 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE4721BC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE4721F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025EE4721A88>]}
2021-04-22 02:15:36.500605 (MainThread): Flushing usage events
2021-04-22 02:15:37.650336 (MainThread): Connection 'test.northwind_shop.test' was properly closed.
2021-04-22 02:15:51.842258 (MainThread): Running with dbt=0.19.1
2021-04-22 02:15:53.547331 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 02:15:53.548391 (MainThread): Tracking: tracking
2021-04-22 02:15:53.553585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BA278788>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BA995708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BA99B208>]}
2021-04-22 02:15:53.590390 (MainThread): Partial parsing not enabled
2021-04-22 02:15:53.598669 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:15:53.706483 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:15:53.728953 (MainThread): Parsing macros\etc.sql
2021-04-22 02:15:53.747138 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:15:53.776106 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:15:53.824116 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:15:53.828593 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:15:53.840520 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:15:53.879607 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:15:53.897813 (MainThread): Parsing macros\core.sql
2021-04-22 02:15:53.912003 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:15:54.105340 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:15:54.136628 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:15:54.144008 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:15:54.155219 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:15:54.163064 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:15:54.173186 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:15:54.178843 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:15:54.212919 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:15:54.259650 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:15:54.277772 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:15:54.306003 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:15:54.396331 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:15:54.526538 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:15:54.528534 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:15:54.601059 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:15:54.623329 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:15:54.638247 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:15:54.651487 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:15:54.660125 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:15:54.660125 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:15:54.673142 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:15:54.689020 (MainThread): Partial parsing not enabled
2021-04-22 02:15:54.769319 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:15:54.804336 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:15:54.811414 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:15:54.819360 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:15:54.836909 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:15:54.852583 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:15:54.862198 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:15:54.879162 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:15:54.888969 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:15:54.903954 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:15:54.910346 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:15:54.918895 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:15:54.957742 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:15:55.389111 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:15:55.393672 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '754b47dd-fe73-4471-b1fe-4c42c854f485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BE4875C8>]}
2021-04-22 02:15:55.442391 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '754b47dd-fe73-4471-b1fe-4c42c854f485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BE44F5C8>]}
2021-04-22 02:15:55.443667 (MainThread): Found 12 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 02:15:55.447494 (MainThread): 
2021-04-22 02:15:55.454476 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:15:55.463400 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:15:55.464398 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:15:55.488522 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:15:56.996153 (MainThread): 23:15:56 | Concurrency: 1 threads (target='dev')
2021-04-22 02:15:56.998528 (MainThread): 23:15:56 | 
2021-04-22 02:15:57.048117 (Thread-1): Began running node test.northwind_shop.test
2021-04-22 02:15:57.053385 (Thread-1): 23:15:57 | 1 of 1 START test test............................................... [RUN]
2021-04-22 02:15:57.066800 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:15:57.067745 (Thread-1): Compiling test.northwind_shop.test
2021-04-22 02:15:57.192632 (Thread-1): Writing injected SQL for node "test.northwind_shop.test"
2021-04-22 02:15:57.206473 (Thread-1): finished collecting timing info
2021-04-22 02:15:57.206473 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:15:57.221903 (Thread-1): On test.northwind_shop.test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.test"} */

with dbt__CTE__INTERNAL_test as (
with   
    validation as (
        select sum(quantity) as sum_val
        from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
    )

    select * from validation where sum_val != 51317
)select count(*) from dbt__CTE__INTERNAL_test
2021-04-22 02:16:01.860736 (Thread-1): finished collecting timing info
2021-04-22 02:16:01.862999 (Thread-1): 23:16:01 | 1 of 1 PASS test..................................................... [PASS in 4.80s]
2021-04-22 02:16:01.872433 (Thread-1): Finished running node test.northwind_shop.test
2021-04-22 02:16:01.974657 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:16:01.976214 (MainThread): 23:16:01 | 
2021-04-22 02:16:01.977887 (MainThread): 23:16:01 | Finished running 1 test in 6.52s.
2021-04-22 02:16:01.978882 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:16:01.978882 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:16:01.978882 (MainThread): Connection 'test.northwind_shop.test' was properly closed.
2021-04-22 02:16:02.050519 (MainThread): 
2021-04-22 02:16:02.059883 (MainThread): Completed successfully
2021-04-22 02:16:02.062805 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-22 02:16:02.077834 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BAC887C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BC3ADD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BA9D4BC8>]}
2021-04-22 02:16:02.080822 (MainThread): Flushing usage events
2021-04-22 02:18:37.459670 (MainThread): Running with dbt=0.19.1
2021-04-22 02:18:38.579011 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['test'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2021-04-22 02:18:38.579011 (MainThread): Tracking: tracking
2021-04-22 02:18:38.587032 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD323F708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD338B1C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD338B148>]}
2021-04-22 02:18:38.615662 (MainThread): Partial parsing not enabled
2021-04-22 02:18:38.620887 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:18:38.686237 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:18:38.704307 (MainThread): Parsing macros\etc.sql
2021-04-22 02:18:38.705306 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:18:38.727194 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:18:38.765526 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:18:38.774379 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:18:38.779047 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:18:38.806941 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:18:38.826838 (MainThread): Parsing macros\core.sql
2021-04-22 02:18:38.838403 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:18:38.986598 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:18:39.006887 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:18:39.018240 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:18:39.024256 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:18:39.029268 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:18:39.038236 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:18:39.039269 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:18:39.072044 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:18:39.106662 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:18:39.121560 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:18:39.144685 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:18:39.206731 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:18:39.317947 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:18:39.324303 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:18:39.377263 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:18:39.406012 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:18:39.421241 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:18:39.437401 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:18:39.454046 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:18:39.458160 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:18:39.464348 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:18:39.484200 (MainThread): Partial parsing not enabled
2021-04-22 02:18:39.556379 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:18:39.588170 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:18:39.608066 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:18:39.627987 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:18:39.636880 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:18:39.648622 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:18:39.666445 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:18:39.677537 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:18:39.687623 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:18:39.698654 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:18:39.706293 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:18:39.720971 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:18:39.770537 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:18:40.169750 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:18:40.177265 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '394df4fa-7145-4dc7-9fa8-3f86cb550afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD6F47B48>]}
2021-04-22 02:18:40.225322 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '394df4fa-7145-4dc7-9fa8-3f86cb550afa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD6EA2E48>]}
2021-04-22 02:18:40.226526 (MainThread): Found 12 models, 15 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 02:18:40.240853 (MainThread): 
2021-04-22 02:18:40.244991 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:18:40.260613 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:18:40.260613 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:18:40.290989 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:18:41.757705 (MainThread): 23:18:41 | Concurrency: 1 threads (target='dev')
2021-04-22 02:18:41.758703 (MainThread): 23:18:41 | 
2021-04-22 02:18:41.778147 (Thread-1): Began running node test.northwind_shop.test
2021-04-22 02:18:41.788622 (Thread-1): 23:18:41 | 1 of 1 START test test............................................... [RUN]
2021-04-22 02:18:41.801644 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:18:41.803639 (Thread-1): Compiling test.northwind_shop.test
2021-04-22 02:18:41.905205 (Thread-1): Writing injected SQL for node "test.northwind_shop.test"
2021-04-22 02:18:41.907735 (Thread-1): finished collecting timing info
2021-04-22 02:18:41.907735 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:18:41.921745 (Thread-1): On test.northwind_shop.test: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "test.northwind_shop.test"} */

with dbt__CTE__INTERNAL_test as (
with   
    validation as (
        select sum(quantity) as sum_val
        from `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
        where order_date between '1998-03-01' and '1998-03-31'
    )

    select * from validation where sum_val != 4065
)select count(*) from dbt__CTE__INTERNAL_test
2021-04-22 02:18:46.145304 (Thread-1): finished collecting timing info
2021-04-22 02:18:46.147166 (Thread-1): 23:18:46 | 1 of 1 PASS test..................................................... [PASS in 4.35s]
2021-04-22 02:18:46.155507 (Thread-1): Finished running node test.northwind_shop.test
2021-04-22 02:18:46.192319 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:18:46.197257 (MainThread): 23:18:46 | 
2021-04-22 02:18:46.215073 (MainThread): 23:18:46 | Finished running 1 test in 5.95s.
2021-04-22 02:18:46.224550 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:18:46.225558 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:18:46.227929 (MainThread): Connection 'test.northwind_shop.test' was properly closed.
2021-04-22 02:18:46.317946 (MainThread): 
2021-04-22 02:18:46.320937 (MainThread): Completed successfully
2021-04-22 02:18:46.321939 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-22 02:18:46.326943 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD35E67C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD4D6CC08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD539D988>]}
2021-04-22 02:18:46.329375 (MainThread): Flushing usage events
2021-04-22 02:28:58.526263 (MainThread): Running with dbt=0.19.1
2021-04-22 02:29:00.336085 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:29:00.337887 (MainThread): Tracking: tracking
2021-04-22 02:29:00.340434 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F67D5E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F67C7408>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F67DC0C8>]}
2021-04-22 02:29:00.407249 (MainThread): Partial parsing not enabled
2021-04-22 02:29:00.409334 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:29:00.510414 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:29:00.539499 (MainThread): Parsing macros\etc.sql
2021-04-22 02:29:00.550495 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:29:00.570956 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:29:00.626325 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:29:00.641019 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:29:00.656076 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:29:00.704324 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:29:00.724416 (MainThread): Parsing macros\core.sql
2021-04-22 02:29:00.743224 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:29:01.007276 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:29:01.053317 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:29:01.057096 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:29:01.069845 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:29:01.075314 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:29:01.085527 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:29:01.089539 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:29:01.137091 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:29:01.208194 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:29:01.219538 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:29:01.253259 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:29:01.370663 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:29:01.517240 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:29:01.522942 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:29:01.618421 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:29:01.652594 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:29:01.670641 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:29:01.707937 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:29:01.733403 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:29:01.742247 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:29:01.772462 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:29:01.838457 (MainThread): Partial parsing not enabled
2021-04-22 02:29:01.989834 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:29:02.046003 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:29:02.059086 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:29:02.071259 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:29:02.100651 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:29:02.185410 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:29:02.204979 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:29:02.222112 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:29:02.231065 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:29:02.243331 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:29:02.291047 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:29:02.313751 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:29:02.324708 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:29:02.389983 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:29:03.320734 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:29:03.369296 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA4E6248>]}
2021-04-22 02:29:03.423149 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA503A08>]}
2021-04-22 02:29:03.423149 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 0 seed files, 7 sources, 0 exposures
2021-04-22 02:29:03.474114 (MainThread): 
2021-04-22 02:29:03.501574 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:29:03.532488 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 02:29:03.533485 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:29:05.276070 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:29:05.281474 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:29:05.313787 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:29:06.872009 (MainThread): 23:29:06 | Concurrency: 1 threads (target='dev')
2021-04-22 02:29:06.873013 (MainThread): 23:29:06 | 
2021-04-22 02:29:06.883570 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-22 02:29:06.884958 (Thread-1): 23:29:06 | 1 of 13 START view model dbt_isadora.stg_customers................... [RUN]
2021-04-22 02:29:06.888795 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:29:06.889794 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-22 02:29:06.901887 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-22 02:29:06.903998 (Thread-1): finished collecting timing info
2021-04-22 02:29:07.000838 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_customers"
2021-04-22 02:29:07.003821 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:29:07.012669 (Thread-1): On model.northwind_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            customer_id

            , country	
            , city	
            , fax	
            , postal_code		
            , address	
            , region
            , contact_name	
            , phone	
            , company_name	
            , contact_title	

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`customers`
    )

    select * from source;


2021-04-22 02:29:09.511739 (Thread-1): finished collecting timing info
2021-04-22 02:29:09.511739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F6806548>]}
2021-04-22 02:29:09.517797 (Thread-1): 23:29:09 | 1 of 13 OK created view model dbt_isadora.stg_customers.............. [OK in 2.62s]
2021-04-22 02:29:09.521711 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-22 02:29:09.524272 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-22 02:29:09.533649 (Thread-1): 23:29:09 | 2 of 13 START view model dbt_isadora.stg_employees................... [RUN]
2021-04-22 02:29:09.537291 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:29:09.545534 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-22 02:29:09.585972 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-22 02:29:09.588364 (Thread-1): finished collecting timing info
2021-04-22 02:29:09.605833 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_employees"
2021-04-22 02:29:09.607934 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:09.621940 (Thread-1): On model.northwind_shop.stg_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`employees`
    )

    select * from source;


2021-04-22 02:29:12.012760 (Thread-1): finished collecting timing info
2021-04-22 02:29:12.015202 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F67BAB08>]}
2021-04-22 02:29:12.017237 (Thread-1): 23:29:12 | 2 of 13 OK created view model dbt_isadora.stg_employees.............. [OK in 2.48s]
2021-04-22 02:29:12.019349 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-22 02:29:12.019349 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-22 02:29:12.022449 (Thread-1): 23:29:12 | 3 of 13 START view model dbt_isadora.stg_products.................... [RUN]
2021-04-22 02:29:12.027163 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:29:12.030941 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-22 02:29:12.055650 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-22 02:29:12.061348 (Thread-1): finished collecting timing info
2021-04-22 02:29:12.080546 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_products"
2021-04-22 02:29:12.084862 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:12.100502 (Thread-1): On model.northwind_shop.stg_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , 
                case
                    when discontinued = 1 then true
                    else false 
                end as is_discontinued
            , reorder_level

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`products`
    )

    select * from source;


2021-04-22 02:29:14.507097 (Thread-1): finished collecting timing info
2021-04-22 02:29:14.512009 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA250548>]}
2021-04-22 02:29:14.515798 (Thread-1): 23:29:14 | 3 of 13 OK created view model dbt_isadora.stg_products............... [OK in 2.49s]
2021-04-22 02:29:14.518791 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-22 02:29:14.518791 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-22 02:29:14.526800 (Thread-1): 23:29:14 | 4 of 13 START view model dbt_isadora.stg_shippers.................... [RUN]
2021-04-22 02:29:14.534754 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:29:14.535792 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-22 02:29:14.543148 (Thread-1): unclosed <socket.socket fd=1292, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51269), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:14.552285 (Thread-1): unclosed <socket.socket fd=1252, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51270), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:14.575060 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-22 02:29:14.577940 (Thread-1): finished collecting timing info
2021-04-22 02:29:14.589914 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_shippers"
2021-04-22 02:29:14.593391 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:14.608864 (Thread-1): On model.northwind_shop.stg_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`shippers`
    )

    select * from source;


2021-04-22 02:29:16.981109 (Thread-1): finished collecting timing info
2021-04-22 02:29:16.982106 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA491948>]}
2021-04-22 02:29:16.982106 (Thread-1): 23:29:16 | 4 of 13 OK created view model dbt_isadora.stg_shippers............... [OK in 2.45s]
2021-04-22 02:29:16.985522 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-22 02:29:16.985905 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-22 02:29:16.986902 (Thread-1): 23:29:16 | 5 of 13 START view model dbt_isadora.stg_suppliers................... [RUN]
2021-04-22 02:29:16.988080 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:29:16.989079 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-22 02:29:16.992440 (Thread-1): unclosed <socket.socket fd=1280, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51266), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:16.993441 (Thread-1): unclosed <socket.socket fd=1540, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51265), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:16.993441 (Thread-1): unclosed <socket.socket fd=1312, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51268), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:16.993441 (Thread-1): unclosed <socket.socket fd=968, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51267), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:17.000364 (Thread-1): unclosed <socket.socket fd=1320, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51271), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:17.000364 (Thread-1): unclosed <socket.socket fd=1244, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51272), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:17.015456 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-22 02:29:17.017351 (Thread-1): finished collecting timing info
2021-04-22 02:29:17.027036 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_suppliers"
2021-04-22 02:29:17.028365 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:17.045585 (Thread-1): On model.northwind_shop.stg_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`suppliers`
    )

    select * from source;


2021-04-22 02:29:19.206056 (Thread-1): finished collecting timing info
2021-04-22 02:29:19.207165 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA2B1CC8>]}
2021-04-22 02:29:19.208261 (Thread-1): 23:29:19 | 5 of 13 OK created view model dbt_isadora.stg_suppliers.............. [OK in 2.22s]
2021-04-22 02:29:19.209296 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-22 02:29:19.210295 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-22 02:29:19.210629 (Thread-1): 23:29:19 | 6 of 13 START view model dbt_isadora.stg_order_details............... [RUN]
2021-04-22 02:29:19.211627 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:29:19.212624 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-22 02:29:19.221078 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-22 02:29:19.224341 (Thread-1): finished collecting timing info
2021-04-22 02:29:19.235454 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_order_details"
2021-04-22 02:29:19.237457 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:19.255762 (Thread-1): On model.northwind_shop.stg_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details`
  OPTIONS()
  as with
    source as (
        select
	        /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , product_id

            , discount
            , unit_price
            , quantity

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`order_details`
    )

    select * from source;


2021-04-22 02:29:21.482342 (Thread-1): finished collecting timing info
2021-04-22 02:29:21.482342 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9F686AAC8>]}
2021-04-22 02:29:21.482342 (Thread-1): 23:29:21 | 6 of 13 OK created view model dbt_isadora.stg_order_details.......... [OK in 2.27s]
2021-04-22 02:29:21.488425 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-22 02:29:21.490156 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-22 02:29:21.491967 (Thread-1): 23:29:21 | 7 of 13 START view model dbt_isadora.stg_orders...................... [RUN]
2021-04-22 02:29:21.495271 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:29:21.496854 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-22 02:29:21.511949 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-22 02:29:21.517249 (Thread-1): finished collecting timing info
2021-04-22 02:29:21.546975 (Thread-1): Writing runtime SQL for node "model.northwind_shop.stg_orders"
2021-04-22 02:29:21.553132 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:21.587759 (Thread-1): On model.northwind_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.stg_orders"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders`
  OPTIONS()
  as with
    source as (
        select
            /*Primary Key*/
            order_id

            /*Foreign Keys*/
            , employee_id
            , customer_id            
            , ship_via as shipper_id

            , ship_region
            , shipped_date
            , ship_country
            , ship_name
            , order_date
            , ship_postal_code
            , ship_city
            , freight
            , required_date
            , ship_address

           /*Stitch Columns*/
            , _sdc_batched_at
            , _sdc_extracted_at as last_etl_run
            , _sdc_sequence
            , _sdc_table_version
            , _sdc_received_at
        from `tutorial-dbt-310721`.`northwind_etl`.`orders`
    )

    select * from source;


2021-04-22 02:29:23.281360 (Thread-1): finished collecting timing info
2021-04-22 02:29:23.282808 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA3D3448>]}
2021-04-22 02:29:23.282808 (Thread-1): 23:29:23 | 7 of 13 OK created view model dbt_isadora.stg_orders................. [OK in 1.79s]
2021-04-22 02:29:23.284804 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-22 02:29:23.284804 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-22 02:29:23.285803 (Thread-1): 23:29:23 | 8 of 13 START view model dbt_isadora.dim_customers................... [RUN]
2021-04-22 02:29:23.287002 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:29:23.287985 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-22 02:29:23.295601 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-22 02:29:23.297045 (Thread-1): finished collecting timing info
2021-04-22 02:29:23.300553 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_customers"
2021-04-22 02:29:23.304274 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:23.318386 (Thread-1): On model.northwind_shop.dim_customers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_customers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            customer_id

            , country
            , city
            , fax
            , postal_code
            , address
            , region
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_customers`
    )

    , transformed as (
        select
        row_number() over (order by customer_id) as customer_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 02:29:25.816846 (Thread-1): finished collecting timing info
2021-04-22 02:29:25.816846 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA426808>]}
2021-04-22 02:29:25.818449 (Thread-1): 23:29:25 | 8 of 13 OK created view model dbt_isadora.dim_customers.............. [OK in 2.53s]
2021-04-22 02:29:25.819525 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-22 02:29:25.820557 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-22 02:29:25.820557 (Thread-1): 23:29:25 | 9 of 13 START view model dbt_isadora.dim_employees................... [RUN]
2021-04-22 02:29:25.822552 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:29:25.822552 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-22 02:29:25.829395 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-22 02:29:25.830572 (Thread-1): finished collecting timing info
2021-04-22 02:29:25.840500 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_employees"
2021-04-22 02:29:25.842516 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:25.853098 (Thread-1): On model.northwind_shop.dim_employees: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_employees"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            employee_id

            , country
            , city
            , postal_code
            , hire_date
            , extension
            , address
            , birth_date
            , region
            , photo_path
            , last_name
            , first_name
            , title
            , title_of_courtesy
            , notes
            , home_phone
            , reports_to
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_employees`
    )

    , transformed as (
        select
        row_number() over (order by employee_id) as employee_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 02:29:28.182322 (Thread-1): finished collecting timing info
2021-04-22 02:29:28.186972 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA4083C8>]}
2021-04-22 02:29:28.191078 (Thread-1): 23:29:28 | 9 of 13 OK created view model dbt_isadora.dim_employees.............. [OK in 2.37s]
2021-04-22 02:29:28.194976 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-22 02:29:28.196947 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-22 02:29:28.197950 (Thread-1): 23:29:28 | 10 of 13 START view model dbt_isadora.dim_products................... [RUN]
2021-04-22 02:29:28.203576 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:29:28.205672 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-22 02:29:28.217106 (Thread-1): unclosed <socket.socket fd=1104, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51283), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:28.217106 (Thread-1): unclosed <socket.socket fd=1096, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51284), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:28.243237 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-22 02:29:28.251928 (Thread-1): finished collecting timing info
2021-04-22 02:29:28.263685 (Thread-1): unclosed <socket.socket fd=1264, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51274), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:28.264813 (Thread-1): unclosed <socket.socket fd=1560, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51275), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:28.265810 (Thread-1): unclosed <socket.socket fd=1580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51276), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:28.267807 (Thread-1): unclosed <socket.socket fd=980, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51277), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:28.267807 (Thread-1): unclosed <socket.socket fd=944, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51279), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:28.269978 (Thread-1): unclosed <socket.socket fd=824, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51280), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:28.269978 (Thread-1): unclosed <socket.socket fd=1232, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51282), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:28.271182 (Thread-1): unclosed <socket.socket fd=1680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51281), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:28.279343 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_products"
2021-04-22 02:29:28.282537 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:28.292003 (Thread-1): On model.northwind_shop.dim_products: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_products"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            product_id

            /*Foreign Keys*/
            , category_id
            , supplier_id

            , product_name
            , unit_price
            , units_in_stock            
            , quantity_per_unit
            , units_on_order
            , is_discontinued
            , reorder_level
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_products`
    )

    , transformed as (
        select
        row_number() over (order by product_id) as product_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 02:29:30.610585 (Thread-1): finished collecting timing info
2021-04-22 02:29:30.611579 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA2144C8>]}
2021-04-22 02:29:30.612362 (Thread-1): 23:29:30 | 10 of 13 OK created view model dbt_isadora.dim_products.............. [OK in 2.41s]
2021-04-22 02:29:30.615535 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-22 02:29:30.617266 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-22 02:29:30.617266 (Thread-1): 23:29:30 | 11 of 13 START view model dbt_isadora.dim_shippers................... [RUN]
2021-04-22 02:29:30.626997 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:29:30.626997 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-22 02:29:30.642665 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-22 02:29:30.647239 (Thread-1): finished collecting timing info
2021-04-22 02:29:30.659067 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_shippers"
2021-04-22 02:29:30.667102 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:30.686595 (Thread-1): On model.northwind_shop.dim_shippers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_shippers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
            shipper_id

            , phone
            , company_name
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_shippers`
    )

    , transformed as (
        select
        row_number() over (order by shipper_id) as shipper_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 02:29:33.091357 (Thread-1): finished collecting timing info
2021-04-22 02:29:33.091357 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA439708>]}
2021-04-22 02:29:33.091357 (Thread-1): 23:29:33 | 11 of 13 OK created view model dbt_isadora.dim_shippers.............. [OK in 2.46s]
2021-04-22 02:29:33.101348 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-22 02:29:33.102618 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-04-22 02:29:33.106127 (Thread-1): 23:29:33 | 12 of 13 START view model dbt_isadora.dim_suppliers.................. [RUN]
2021-04-22 02:29:33.109372 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:29:33.112075 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-04-22 02:29:33.142939 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:29:33.147197 (Thread-1): finished collecting timing info
2021-04-22 02:29:33.192132 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:29:33.196904 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:33.214668 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
  OPTIONS()
  as with
    selected as (
        select
            /*Primary Key*/
             supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
    )

    , transformed as (
        select
        row_number() over (order by supplier_id) as supplier_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 02:29:35.577230 (Thread-1): finished collecting timing info
2021-04-22 02:29:35.582478 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA20C208>]}
2021-04-22 02:29:35.582478 (Thread-1): 23:29:35 | 12 of 13 OK created view model dbt_isadora.dim_suppliers............. [OK in 2.47s]
2021-04-22 02:29:35.589578 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-04-22 02:29:35.593568 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-22 02:29:35.596400 (Thread-1): 23:29:35 | 13 of 13 START view model dbt_isadora.fact_order_details............. [RUN]
2021-04-22 02:29:35.598075 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:29:35.601138 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-22 02:29:35.664437 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-22 02:29:35.668944 (Thread-1): finished collecting timing info
2021-04-22 02:29:35.681730 (Thread-1): Writing runtime SQL for node "model.northwind_shop.fact_order_details"
2021-04-22 02:29:35.684649 (Thread-1): Opening a new connection, currently in state closed
2021-04-22 02:29:35.699507 (Thread-1): On model.northwind_shop.fact_order_details: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.fact_order_details"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`fact_order_details`
  OPTIONS()
  as with
    customers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_customers`
    )
    , employees as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_employees`
    )
    , products as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_products`
    )
    , shippers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_shippers`
    )
    , suppliers as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
    )
    , orders_with_sk as (
            select
            order_id
            , employees.employee_sk as employeee_fk
            , customers.customer_sk as customer_fk
            , shippers.shipper_sk as shipper_fk
            , orders.ship_region
            , orders.shipped_date
            , orders.ship_country
            , orders.ship_name
            , orders.order_date
            , orders.ship_postal_code
            , orders.ship_city
            , orders.freight
            , orders.required_date
            , orders.ship_address
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_orders` as orders

        left join customers on orders.customer_id=customers.customer_id
        left join employees on orders.employee_id=employees.employee_id
        left join shippers on orders.shipper_id=shippers.shipper_id
    )

    , order_details_with_sk as (
        select
            order_details.order_id
            , products.product_sk as product_fk
            , order_details.discount
            , order_details.unit_price
            , order_details.quantity
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_order_details` as order_details
        left join products on order_details.product_id = products.product_id
    )
    , final as (
        select
            order_details_with_sk.order_id
            , orders_with_sk.employeee_fk
            , orders_with_sk.customer_fk
            , orders_with_sk.shipper_fk
            , orders_with_sk.ship_region
            , orders_with_sk.shipped_date
            , orders_with_sk.ship_country
            , orders_with_sk.ship_name
            , orders_with_sk.order_date
            , orders_with_sk.ship_postal_code
            , orders_with_sk.ship_city
            , orders_with_sk.freight
            , orders_with_sk.required_date
            , orders_with_sk.ship_address
            , order_details_with_sk.product_fk
            , order_details_with_sk.discount
            , order_details_with_sk.unit_price
            , order_details_with_sk.quantity
            from orders_with_sk
            left join order_details_with_sk on orders_with_sk.order_id=order_details_with_sk.order_id
    )

select * from final;


2021-04-22 02:29:38.106421 (Thread-1): finished collecting timing info
2021-04-22 02:29:38.109407 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17eab7d6-04ff-41c8-bc4d-009e67edcce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA3A9F48>]}
2021-04-22 02:29:38.111402 (Thread-1): 23:29:38 | 13 of 13 OK created view model dbt_isadora.fact_order_details........ [OK in 2.51s]
2021-04-22 02:29:38.119058 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-22 02:29:38.171325 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:29:38.179540 (MainThread): 23:29:38 | 
2021-04-22 02:29:38.193207 (MainThread): 23:29:38 | Finished running 13 view models in 34.67s.
2021-04-22 02:29:38.196420 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:29:38.196420 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 02:29:38.196420 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:29:38.197418 (MainThread): Connection 'model.northwind_shop.fact_order_details' was properly closed.
2021-04-22 02:29:38.197418 (MainThread): unclosed <socket.socket fd=1072, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51295), raddr=('172.217.30.74', 443)>
2021-04-22 02:29:38.197418 (MainThread): unclosed <socket.socket fd=1780, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('192.168.0.102', 51296), raddr=('142.250.218.10', 443)>
2021-04-22 02:29:38.261378 (MainThread): 
2021-04-22 02:29:38.277744 (MainThread): Completed successfully
2021-04-22 02:29:38.368164 (MainThread): 
Done. PASS=13 WARN=0 ERROR=0 SKIP=0 TOTAL=13
2021-04-22 02:29:38.381289 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA1EB388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA3AF4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9FA3A9F48>]}
2021-04-22 02:29:38.382287 (MainThread): Flushing usage events
2021-04-22 02:40:23.945837 (MainThread): Running with dbt=0.19.1
2021-04-22 02:40:25.851152 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.seed.SeedTask'>, debug=False, defer=None, exclude=None, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='seed', selector_name=None, show=False, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='seed', write_json=True)
2021-04-22 02:40:25.853179 (MainThread): Tracking: tracking
2021-04-22 02:40:25.855967 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900A455D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900A49DF08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900A44E588>]}
2021-04-22 02:40:25.897846 (MainThread): Partial parsing not enabled
2021-04-22 02:40:25.905495 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:40:25.985121 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:40:26.003481 (MainThread): Parsing macros\etc.sql
2021-04-22 02:40:26.016833 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:40:26.033615 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:40:26.088828 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:40:26.103350 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:40:26.109704 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:40:26.147532 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:40:26.166099 (MainThread): Parsing macros\core.sql
2021-04-22 02:40:26.177583 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:40:26.352856 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:40:26.389477 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:40:26.395313 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:40:26.403357 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:40:26.408719 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:40:26.417296 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:40:26.419569 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:40:26.455458 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:40:26.507657 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:40:26.519891 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:40:26.569687 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:40:26.700112 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:40:26.831262 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:40:26.836717 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:40:26.933263 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:40:26.955086 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:40:26.982462 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:40:27.009412 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:40:27.021505 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:40:27.029273 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:40:27.035419 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:40:27.067120 (MainThread): Partial parsing not enabled
2021-04-22 02:40:27.223151 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:40:27.256981 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:40:27.272039 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:40:27.284961 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:40:27.296602 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:40:27.305311 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:40:27.324566 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:40:27.337257 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:40:27.351556 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:40:27.368544 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:40:27.383268 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:40:27.397451 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:40:27.413058 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:40:27.452076 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:40:27.937005 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:40:27.954139 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2b7aa3d-6697-479b-9ea0-c080a605ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900DEFEC08>]}
2021-04-22 02:40:28.013036 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2b7aa3d-6697-479b-9ea0-c080a605ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900DF58D88>]}
2021-04-22 02:40:28.015719 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:40:28.034457 (MainThread): 
2021-04-22 02:40:28.036260 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:40:28.043755 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 02:40:28.047140 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:40:29.695698 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:40:29.697214 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:40:29.730306 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:40:31.204984 (MainThread): 23:40:31 | Concurrency: 1 threads (target='dev')
2021-04-22 02:40:31.208820 (MainThread): 23:40:31 | 
2021-04-22 02:40:31.262720 (Thread-1): Began running node seed.northwind_shop.seed_divisions
2021-04-22 02:40:31.262720 (Thread-1): 23:40:31 | 1 of 1 START seed file dbt_isadora.seed_divisions.................... [RUN]
2021-04-22 02:40:31.269093 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed_divisions".
2021-04-22 02:40:31.269691 (Thread-1): finished collecting timing info
2021-04-22 02:40:31.364830 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:40:31.378312 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:40:35.852810 (Thread-1): Writing runtime SQL for node "seed.northwind_shop.seed_divisions"
2021-04-22 02:40:35.884656 (Thread-1): finished collecting timing info
2021-04-22 02:40:35.885652 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2b7aa3d-6697-479b-9ea0-c080a605ab68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900C3D7188>]}
2021-04-22 02:40:35.885652 (Thread-1): 23:40:35 | 1 of 1 OK loaded seed file dbt_isadora.seed_divisions................ [INSERT 16 in 4.62s]
2021-04-22 02:40:35.885652 (Thread-1): Finished running node seed.northwind_shop.seed_divisions
2021-04-22 02:40:35.955113 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:40:35.958991 (MainThread): 23:40:35 | 
2021-04-22 02:40:35.962931 (MainThread): 23:40:35 | Finished running 1 seed in 7.92s.
2021-04-22 02:40:35.966748 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:40:35.968597 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 02:40:35.968597 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:40:35.968597 (MainThread): Connection 'seed.northwind_shop.seed_divisions' was properly closed.
2021-04-22 02:40:36.035755 (MainThread): 
2021-04-22 02:40:36.037204 (MainThread): Completed successfully
2021-04-22 02:40:36.046239 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-22 02:40:36.051098 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900A4838C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900A43DAC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001900C3D7188>]}
2021-04-22 02:40:36.052092 (MainThread): Flushing usage events
2021-04-22 02:46:01.304710 (MainThread): Running with dbt=0.19.1
2021-04-22 02:46:02.262641 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:46:02.264335 (MainThread): Tracking: tracking
2021-04-22 02:46:02.265176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F456C508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F25AB208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F25AB188>]}
2021-04-22 02:46:02.284169 (MainThread): Partial parsing not enabled
2021-04-22 02:46:02.287161 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:46:02.327176 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:46:02.339182 (MainThread): Parsing macros\etc.sql
2021-04-22 02:46:02.344906 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:46:02.356611 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:46:02.380585 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:46:02.386570 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:46:02.390561 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:46:02.410471 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:46:02.421158 (MainThread): Parsing macros\core.sql
2021-04-22 02:46:02.430139 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:46:02.518766 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:46:02.537695 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:46:02.540691 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:46:02.545205 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:46:02.549198 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:46:02.553187 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:46:02.555181 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:46:02.574216 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:46:02.602144 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:46:02.607132 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:46:02.620097 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:46:02.663897 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:46:02.737020 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:46:02.741048 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:46:02.776729 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:46:02.790713 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:46:02.801622 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:46:02.815257 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:46:02.821282 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:46:02.824274 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:46:02.828261 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:46:02.842192 (MainThread): Partial parsing not enabled
2021-04-22 02:46:02.886627 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:46:02.906150 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:46:02.914167 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:46:02.921981 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:46:02.938345 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:46:02.946324 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:46:02.958292 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:46:02.967097 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:46:02.975659 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:46:02.984804 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:46:02.992783 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:46:03.001759 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:46:03.009838 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:46:03.033774 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:46:03.330622 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:46:03.339568 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26db2e07-0ff1-4ad8-bb7d-5443a0bf6f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F60A1688>]}
2021-04-22 02:46:03.371480 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26db2e07-0ff1-4ad8-bb7d-5443a0bf6f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F60C25C8>]}
2021-04-22 02:46:03.372477 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:46:03.374471 (MainThread): The selector 'dim' does not match any nodes and will be ignored
2021-04-22 02:46:03.387439 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-04-22 02:46:03.389430 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F61B2B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F61FC0C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206F61CC688>]}
2021-04-22 02:46:03.389430 (MainThread): Flushing usage events
2021-04-22 02:46:04.338843 (MainThread): Connection 'test.northwind_shop.test' was properly closed.
2021-04-22 02:46:25.598722 (MainThread): Running with dbt=0.19.1
2021-04-22 02:46:26.893964 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:46:26.894962 (MainThread): Tracking: tracking
2021-04-22 02:46:26.896960 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CB974948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CB914F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CB914E48>]}
2021-04-22 02:46:26.927386 (MainThread): Partial parsing not enabled
2021-04-22 02:46:26.932378 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:46:26.992213 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:46:27.012164 (MainThread): Parsing macros\etc.sql
2021-04-22 02:46:27.018148 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:46:27.036100 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:46:27.074017 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:46:27.081979 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:46:27.085972 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:46:27.113911 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:46:27.127872 (MainThread): Parsing macros\core.sql
2021-04-22 02:46:27.142835 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:46:27.238577 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:46:27.256566 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:46:27.258560 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:46:27.261552 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:46:27.265541 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:46:27.269530 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:46:27.272523 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:46:27.290474 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:46:27.318611 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:46:27.323597 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:46:27.335918 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:46:27.384893 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:46:27.453086 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:46:27.458072 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:46:27.496974 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:46:27.510938 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:46:27.520948 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:46:27.534097 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:46:27.540114 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:46:27.544107 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:46:27.548096 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:46:27.560820 (MainThread): Partial parsing not enabled
2021-04-22 02:46:27.610815 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:46:27.629762 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:46:27.637738 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:46:27.645719 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:46:27.654660 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:46:27.669619 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:46:27.691560 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:46:27.700539 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:46:27.716493 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:46:27.732451 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:46:27.744417 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:46:27.751436 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:46:27.759415 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:46:27.780362 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:46:28.170278 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:46:28.176264 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9875de99-27b1-408c-8997-8c0da41cf7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CF6395C8>]}
2021-04-22 02:46:28.212166 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9875de99-27b1-408c-8997-8c0da41cf7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CF569EC8>]}
2021-04-22 02:46:28.213166 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:46:28.228125 (MainThread): 
2021-04-22 02:46:28.230120 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:46:28.234111 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 02:46:28.234111 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:46:29.937488 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:46:29.942491 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:46:29.963417 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:46:31.287384 (MainThread): 23:46:31 | Concurrency: 1 threads (target='dev')
2021-04-22 02:46:31.288373 (MainThread): 23:46:31 | 
2021-04-22 02:46:31.295417 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-04-22 02:46:31.295417 (Thread-1): 23:46:31 | 1 of 1 START view model dbt_isadora.dim_suppliers.................... [RUN]
2021-04-22 02:46:31.296555 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:46:31.297593 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-04-22 02:46:31.301582 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:46:31.304537 (Thread-1): finished collecting timing info
2021-04-22 02:46:31.395293 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:46:31.397899 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:46:31.410906 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
  OPTIONS()
  as with

    divisions as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
    )

    , selected as (
        select
            /*Primary Key*/
             supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title
            , divisions.division
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
        left join divisions on suppliers.country = divisions.country
    )


    , transformed as (
        select
        row_number() over (order by supplier_id) as supplier_sk
        , *
        from selected
    )

    select * from transformed;


2021-04-22 02:46:33.334301 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/c36dfd97-a98f-4b0a-a7f8-497f59394a62?maxResults=0&location=US&prettyPrint=false: Unrecognized name: suppliers; Did you mean supplier_id? at [31:32]')
2021-04-22 02:46:34.562987 (Thread-1): finished collecting timing info
2021-04-22 02:46:34.564933 (Thread-1): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Unrecognized name: suppliers; Did you mean supplier_id? at [31:32]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/43af9fcb-2328-40cd-877f-3f550be877a0?maxResults=0&location=US&prettyPrint=false: Unrecognized name: suppliers; Did you mean supplier_id? at [31:32]

(job ID: 43af9fcb-2328-40cd-877f-3f550be877a0)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
   5:  OPTIONS()
   6:  as with
   7:
   8:    divisions as (
   9:        select *
  10:        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
  11:    )
  12:
  13:    , selected as (
  14:        select
  15:            /*Primary Key*/
  16:             supplier_id
  17:
  18:            , country
  19:            , city
  20:            , fax
  21:            , postal_code
  22:            , homepage
  23:            , address
  24:            , region 
  25:            , contact_name
  26:            , phone
  27:            , company_name
  28:            , contact_title
  29:            , divisions.division
  30:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  31:        left join divisions on suppliers.country = divisions.country
  32:    )
  33:
  34:
  35:    , transformed as (
  36:        select
  37:        row_number() over (order by supplier_id) as supplier_sk
  38:        , *
  39:        from selected
  40:    )
  41:
  42:    select * from transformed;
  43:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Unrecognized name: suppliers; Did you mean supplier_id? at [31:32]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-04-22 02:46:34.869005 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9875de99-27b1-408c-8997-8c0da41cf7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245C8AAAB08>]}
2021-04-22 02:46:34.869005 (Thread-1): 23:46:34 | 1 of 1 ERROR creating view model dbt_isadora.dim_suppliers........... [ERROR in 3.57s]
2021-04-22 02:46:34.870999 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-04-22 02:46:34.928322 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:46:34.928322 (MainThread): 23:46:34 | 
2021-04-22 02:46:34.929742 (MainThread): 23:46:34 | Finished running 1 view model in 6.70s.
2021-04-22 02:46:34.930744 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:46:34.930744 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 02:46:34.930744 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:46:34.930744 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-04-22 02:46:34.948698 (MainThread): 
2021-04-22 02:46:34.948698 (MainThread): Completed with 1 error and 0 warnings:
2021-04-22 02:46:34.952687 (MainThread): 
2021-04-22 02:46:34.954680 (MainThread): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
2021-04-22 02:46:34.955678 (MainThread):   Unrecognized name: suppliers; Did you mean supplier_id? at [31:32]
2021-04-22 02:46:34.956675 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-04-22 02:46:34.957672 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-22 02:46:34.959667 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CDA364C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CEE6ED88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CEE6ED48>]}
2021-04-22 02:46:34.959667 (MainThread): Flushing usage events
2021-04-22 02:49:08.146043 (MainThread): Running with dbt=0.19.1
2021-04-22 02:49:09.480764 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:49:09.481762 (MainThread): Tracking: tracking
2021-04-22 02:49:09.482759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7A86B088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7C8EA148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7A864F48>]}
2021-04-22 02:49:09.518665 (MainThread): Partial parsing not enabled
2021-04-22 02:49:09.527639 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:49:09.595970 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:49:09.610930 (MainThread): Parsing macros\etc.sql
2021-04-22 02:49:09.615916 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:49:09.627884 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:49:09.657807 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:49:09.664787 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:49:09.669778 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:49:09.692711 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:49:09.707672 (MainThread): Parsing macros\core.sql
2021-04-22 02:49:09.716647 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:49:09.827356 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:49:09.848298 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:49:09.851291 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:49:09.856280 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:49:09.862261 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:49:09.867244 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:49:09.870240 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:49:09.891218 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:49:09.924095 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:49:09.929084 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:49:09.943076 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:49:10.008864 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:49:10.171430 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:49:10.177414 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:49:10.226285 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:49:10.245233 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:49:10.261190 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:49:10.283132 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:49:10.291110 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:49:10.294102 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:49:10.298091 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:49:10.312053 (MainThread): Partial parsing not enabled
2021-04-22 02:49:10.362954 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:49:10.380905 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:49:10.388883 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:49:10.395832 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:49:10.413657 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:49:10.421598 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:49:10.431607 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:49:10.439586 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:49:10.446567 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:49:10.454545 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:49:10.462111 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:49:10.469055 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:49:10.478065 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:49:10.498014 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:49:10.811113 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:49:10.817099 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c30bec1-7a01-4394-a3cf-b1f6c34d7566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E372848>]}
2021-04-22 02:49:10.858574 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c30bec1-7a01-4394-a3cf-b1f6c34d7566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E4B5108>]}
2021-04-22 02:49:10.859519 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:49:10.874478 (MainThread): 
2021-04-22 02:49:10.878466 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:49:10.881458 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 02:49:10.882459 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:49:12.227329 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:49:12.227329 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:49:12.235307 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:49:13.483232 (MainThread): 23:49:13 | Concurrency: 1 threads (target='dev')
2021-04-22 02:49:13.484225 (MainThread): 23:49:13 | 
2021-04-22 02:49:13.493302 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-04-22 02:49:13.494304 (Thread-1): 23:49:13 | 1 of 1 START view model dbt_isadora.dim_suppliers.................... [RUN]
2021-04-22 02:49:13.495303 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:49:13.495303 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-04-22 02:49:13.500288 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:49:13.502284 (Thread-1): finished collecting timing info
2021-04-22 02:49:13.581083 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:49:13.583069 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:49:13.591082 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
  OPTIONS()
  as with

    divisions as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
    )

    , selected as (
        select
            /*Primary Key*/
             supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
    )


    , transformed as (
        select
        row_number() over (order by supplier_id) as supplier_sk
        , *
        from selected, divisions
        left join divisions on selected.country = divisions.country
    )

    select * from transformed;


2021-04-22 02:49:14.855867 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/3b76aac7-737d-4c07-a32b-24322612b4f1?maxResults=0&location=US&prettyPrint=false: Duplicate table alias divisions in the same FROM clause at [38:19]')
2021-04-22 02:49:16.724952 (Thread-1): finished collecting timing info
2021-04-22 02:49:16.726898 (Thread-1): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Duplicate table alias divisions in the same FROM clause at [38:19]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/e748a87b-2e7f-419b-be49-83644b219f9e?maxResults=0&location=US&prettyPrint=false: Duplicate table alias divisions in the same FROM clause at [38:19]

(job ID: e748a87b-2e7f-419b-be49-83644b219f9e)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
   5:  OPTIONS()
   6:  as with
   7:
   8:    divisions as (
   9:        select *
  10:        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
  11:    )
  12:
  13:    , selected as (
  14:        select
  15:            /*Primary Key*/
  16:             supplier_id
  17:
  18:            , country
  19:            , city
  20:            , fax
  21:            , postal_code
  22:            , homepage
  23:            , address
  24:            , region 
  25:            , contact_name
  26:            , phone
  27:            , company_name
  28:            , contact_title
  29:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  30:    )
  31:
  32:
  33:    , transformed as (
  34:        select
  35:        row_number() over (order by supplier_id) as supplier_sk
  36:        , *
  37:        from selected, divisions
  38:        left join divisions on selected.country = divisions.country
  39:    )
  40:
  41:    select * from transformed;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  Duplicate table alias divisions in the same FROM clause at [38:19]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-04-22 02:49:16.741893 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c30bec1-7a01-4394-a3cf-b1f6c34d7566', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7E5777C8>]}
2021-04-22 02:49:16.742891 (Thread-1): 23:49:16 | 1 of 1 ERROR creating view model dbt_isadora.dim_suppliers........... [ERROR in 3.25s]
2021-04-22 02:49:16.743852 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-04-22 02:49:16.786788 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:49:16.788798 (MainThread): 23:49:16 | 
2021-04-22 02:49:16.789779 (MainThread): 23:49:16 | Finished running 1 view model in 5.91s.
2021-04-22 02:49:16.790778 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:49:16.790778 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 02:49:16.790778 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:49:16.791775 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-04-22 02:49:16.808732 (MainThread): 
2021-04-22 02:49:16.809738 (MainThread): Completed with 1 error and 0 warnings:
2021-04-22 02:49:16.810725 (MainThread): 
2021-04-22 02:49:16.811721 (MainThread): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
2021-04-22 02:49:16.813716 (MainThread):   Duplicate table alias divisions in the same FROM clause at [38:19]
2021-04-22 02:49:16.814713 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-04-22 02:49:16.817705 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-22 02:49:16.821695 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7C624288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7C61B548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C7DF56448>]}
2021-04-22 02:49:16.822696 (MainThread): Flushing usage events
2021-04-22 02:50:11.654158 (MainThread): Running with dbt=0.19.1
2021-04-22 02:50:12.325248 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:50:12.325248 (MainThread): Tracking: tracking
2021-04-22 02:50:12.325248 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBF66F748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBF774A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBF774D48>]}
2021-04-22 02:50:12.340910 (MainThread): Partial parsing not enabled
2021-04-22 02:50:12.340910 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:50:12.387772 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:50:12.403394 (MainThread): Parsing macros\etc.sql
2021-04-22 02:50:12.403394 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:50:12.419015 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:50:12.443736 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:50:12.443736 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:50:12.443736 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:50:12.460726 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:50:12.482658 (MainThread): Parsing macros\core.sql
2021-04-22 02:50:12.490638 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:50:12.572787 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:50:12.588411 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:50:12.588411 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:50:12.588411 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:50:12.604033 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:50:12.604033 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:50:12.604033 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:50:12.626163 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:50:12.641791 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:50:12.657413 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:50:12.657413 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:50:12.704275 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:50:12.778967 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:50:12.778967 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:50:12.819296 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:50:12.829402 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:50:12.839505 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:50:12.849629 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:50:12.859750 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:50:12.859750 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:50:12.867821 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:50:12.879960 (MainThread): Partial parsing not enabled
2021-04-22 02:50:12.928480 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:50:12.940636 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:50:12.950768 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:50:12.960862 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:50:12.980496 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:50:12.989471 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:50:13.009516 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:50:13.009516 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:50:13.009516 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:50:13.025142 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:50:13.025142 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:50:13.040763 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:50:13.040763 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:50:13.073913 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:50:13.345851 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:50:13.350839 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee2388ac-2dbd-4d6a-b5e5-d5c1daeb3746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC32BC9C8>]}
2021-04-22 02:50:13.382750 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee2388ac-2dbd-4d6a-b5e5-d5c1daeb3746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC33D11C8>]}
2021-04-22 02:50:13.382750 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:50:13.391730 (MainThread): 
2021-04-22 02:50:13.395715 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:50:13.398707 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 02:50:13.399707 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:50:14.766788 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:50:14.766788 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:50:14.782176 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:50:16.067130 (MainThread): 23:50:16 | Concurrency: 1 threads (target='dev')
2021-04-22 02:50:16.068620 (MainThread): 23:50:16 | 
2021-04-22 02:50:16.083591 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-04-22 02:50:16.084589 (Thread-1): 23:50:16 | 1 of 1 START view model dbt_isadora.dim_suppliers.................... [RUN]
2021-04-22 02:50:16.085587 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:50:16.086587 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-04-22 02:50:16.099546 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:50:16.101541 (Thread-1): finished collecting timing info
2021-04-22 02:50:16.190302 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:50:16.194300 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:50:16.210259 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
  OPTIONS()
  as with

    divisions as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
    )

    , selected as (
        select
            /*Primary Key*/
             supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
    )


    , transformed as (
        select
        row_number() over (order by supplier_id) as supplier_sk
        , *
        from selected
        left join divisions on selected.country = divisions.country
    )

    select * from transformed;


2021-04-22 02:50:17.950256 (Thread-1): Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/fe27c3c8-c387-4f8b-a7ac-4b3c207a475d?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name country at [6:6]')
2021-04-22 02:50:19.771898 (Thread-1): finished collecting timing info
2021-04-22 02:50:19.771898 (Thread-1): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  CREATE VIEW has columns with duplicate name country at [6:6]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 149, in exception_handler
    yield
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 327, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 520, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1146, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\base.py", line 631, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 129, in result
    self._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1042, in _blocking_poll
    super(QueryJob, self)._blocking_poll(timeout=timeout, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 107, in _blocking_poll
    retry_(self._done_or_raise)(**kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\future\polling.py", line 85, in _done_or_raise
    if not self.done(**kwargs):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\job\query.py", line 1028, in done
    timeout=transport_timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 1564, in _get_query_results
    timeout=timeout,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\bigquery\client.py", line 636, in _call_api
    return call()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 286, in retry_wrapped_func
    on_error=on_error,
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\google\cloud\_http.py", line 438, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/tutorial-dbt-310721/queries/4aaf4b22-f843-4893-a618-3dddaf908d17?maxResults=0&location=US&prettyPrint=false: CREATE VIEW has columns with duplicate name country at [6:6]

(job ID: 4aaf4b22-f843-4893-a618-3dddaf908d17)

                                                              -----Query Job SQL Follows-----                                                              

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */
   2:
   3:
   4:  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
   5:  OPTIONS()
   6:  as with
   7:
   8:    divisions as (
   9:        select *
  10:        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
  11:    )
  12:
  13:    , selected as (
  14:        select
  15:            /*Primary Key*/
  16:             supplier_id
  17:
  18:            , country
  19:            , city
  20:            , fax
  21:            , postal_code
  22:            , homepage
  23:            , address
  24:            , region 
  25:            , contact_name
  26:            , phone
  27:            , company_name
  28:            , contact_title
  29:        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
  30:    )
  31:
  32:
  33:    , transformed as (
  34:        select
  35:        row_number() over (order by supplier_id) as supplier_sk
  36:        , *
  37:        from selected
  38:        left join divisions on selected.country = divisions.country
  39:    )
  40:
  41:    select * from transformed;
  42:
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\task\run.py", line 248, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 332, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\clients\jinja.py", line 259, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\base\impl.py", line 230, in execute
    fetch=fetch
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 338, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 329, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 539, in _retry_and_handle
    on_error=reopen_conn_on_error)
  File "c:\users\user\appdata\local\programs\python\python37\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 153, in exception_handler
    self.handle_error(e, message)
  File "c:\users\user\appdata\local\programs\python\python37\lib\site-packages\dbt\adapters\bigquery\connections.py", line 141, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
  CREATE VIEW has columns with duplicate name country at [6:6]
  compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-04-22 02:50:19.787518 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee2388ac-2dbd-4d6a-b5e5-d5c1daeb3746', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFBF75CE88>]}
2021-04-22 02:50:19.787518 (Thread-1): 23:50:19 | 1 of 1 ERROR creating view model dbt_isadora.dim_suppliers........... [ERROR in 3.70s]
2021-04-22 02:50:19.787518 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-04-22 02:50:19.820425 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:50:19.820425 (MainThread): 23:50:19 | 
2021-04-22 02:50:19.821419 (MainThread): 23:50:19 | Finished running 1 view model in 6.42s.
2021-04-22 02:50:19.822415 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:50:19.822415 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 02:50:19.823411 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:50:19.823411 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-04-22 02:50:19.845354 (MainThread): 
2021-04-22 02:50:19.846352 (MainThread): Completed with 1 error and 0 warnings:
2021-04-22 02:50:19.853352 (MainThread): 
2021-04-22 02:50:19.854332 (MainThread): Database Error in model dim_suppliers (models\marts\dim_suppliers.sql)
2021-04-22 02:50:19.856322 (MainThread):   CREATE VIEW has columns with duplicate name country at [6:6]
2021-04-22 02:50:19.863321 (MainThread):   compiled SQL at target\run\northwind_shop\models\marts\dim_suppliers.sql
2021-04-22 02:50:19.865298 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-04-22 02:50:19.866299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC1765E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC3285648>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC32855C8>]}
2021-04-22 02:50:19.867297 (MainThread): Flushing usage events
2021-04-22 02:53:08.578554 (MainThread): Running with dbt=0.19.1
2021-04-22 02:53:09.292950 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['dim_suppliers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-04-22 02:53:09.293947 (MainThread): Tracking: tracking
2021-04-22 02:53:09.294945 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C03AFA048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C03B0B088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C03B0B1C8>]}
2021-04-22 02:53:09.313929 (MainThread): Partial parsing not enabled
2021-04-22 02:53:09.316923 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:53:09.357778 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:53:09.370741 (MainThread): Parsing macros\etc.sql
2021-04-22 02:53:09.375768 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:53:09.388695 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:53:09.418613 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:53:09.425599 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:53:09.429588 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:53:09.449566 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:53:09.459507 (MainThread): Parsing macros\core.sql
2021-04-22 02:53:09.467520 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:53:09.566256 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:53:09.583211 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:53:09.585171 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:53:09.589192 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:53:09.593185 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:53:09.597175 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:53:09.599165 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:53:09.619080 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:53:09.648997 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:53:09.651989 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:53:09.664954 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:53:09.706879 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:53:09.780647 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:53:09.784639 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:53:09.828554 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:53:09.842517 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:53:09.852490 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:53:09.865422 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:53:09.870443 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:53:09.874395 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:53:09.878386 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:53:09.893348 (MainThread): Partial parsing not enabled
2021-04-22 02:53:09.945208 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:53:09.964155 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:53:09.972145 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:53:09.980114 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:53:09.996106 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:53:10.004086 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:53:10.015021 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:53:10.022997 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:53:10.029978 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:53:10.042944 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:53:10.057905 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:53:10.070870 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:53:10.083871 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:53:10.112758 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:53:10.405981 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:53:10.411967 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4daa907-629f-4f3c-aa2c-63a5f14ac403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C075A5888>]}
2021-04-22 02:53:10.447440 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4daa907-629f-4f3c-aa2c-63a5f14ac403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C03B88548>]}
2021-04-22 02:53:10.448435 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:53:10.464406 (MainThread): 
2021-04-22 02:53:10.465391 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:53:10.467384 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721".
2021-04-22 02:53:10.468380 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:53:11.422284 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:53:11.423291 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:53:11.436254 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:53:12.735879 (MainThread): 23:53:12 | Concurrency: 1 threads (target='dev')
2021-04-22 02:53:12.738019 (MainThread): 23:53:12 | 
2021-04-22 02:53:12.749998 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-04-22 02:53:12.749998 (Thread-1): 23:53:12 | 1 of 1 START view model dbt_isadora.dim_suppliers.................... [RUN]
2021-04-22 02:53:12.751996 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:53:12.751996 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-04-22 02:53:12.763964 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:53:12.764957 (Thread-1): finished collecting timing info
2021-04-22 02:53:12.851761 (Thread-1): Writing runtime SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:53:12.852764 (Thread-1): Opening a new connection, currently in state init
2021-04-22 02:53:12.861697 (Thread-1): On model.northwind_shop.dim_suppliers: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "node_id": "model.northwind_shop.dim_suppliers"} */


  create or replace view `tutorial-dbt-310721`.`dbt_isadora`.`dim_suppliers`
  OPTIONS()
  as with

    divisions as (
        select *
        from `tutorial-dbt-310721`.`dbt_isadora`.`seed_divisions`
    )

    , suppliers as (
        select
            /*Primary Key*/
             supplier_id

            , country
            , city
            , fax
            , postal_code
            , homepage
            , address
            , region 
            , contact_name
            , phone
            , company_name
            , contact_title
        from `tutorial-dbt-310721`.`dbt_isadora`.`stg_suppliers`
    )


    , transformed as (
        select
        row_number() over (order by supplier_id) as supplier_sk
            , suppliers.country
            , suppliers.city
            , suppliers.fax
            , suppliers.postal_code
            , suppliers.homepage
            , suppliers.address
            , suppliers.region 
            , suppliers.contact_name
            , suppliers.phone
            , suppliers.company_name
            , suppliers.contact_title
            , divisions.division
        from suppliers
        left join divisions on suppliers.country = divisions.country
    )

    select * from transformed;


2021-04-22 02:53:15.826486 (Thread-1): finished collecting timing info
2021-04-22 02:53:15.826486 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4daa907-629f-4f3c-aa2c-63a5f14ac403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C03B35288>]}
2021-04-22 02:53:15.827483 (Thread-1): 23:53:15 | 1 of 1 OK created view model dbt_isadora.dim_suppliers............... [OK in 3.08s]
2021-04-22 02:53:15.829216 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-04-22 02:53:15.841269 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:53:15.842268 (MainThread): 23:53:15 | 
2021-04-22 02:53:15.842268 (MainThread): 23:53:15 | Finished running 1 view model in 5.38s.
2021-04-22 02:53:15.843262 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:53:15.844260 (MainThread): Connection 'list_tutorial-dbt-310721' was properly closed.
2021-04-22 02:53:15.844260 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:53:15.844260 (MainThread): Connection 'model.northwind_shop.dim_suppliers' was properly closed.
2021-04-22 02:53:15.863208 (MainThread): 
2021-04-22 02:53:15.864207 (MainThread): Completed successfully
2021-04-22 02:53:15.865204 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-04-22 02:53:15.867198 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C04CB5948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C07810D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C03ABA208>]}
2021-04-22 02:53:15.868197 (MainThread): Flushing usage events
2021-04-22 02:58:31.985526 (MainThread): Running with dbt=0.19.1
2021-04-22 02:58:33.234086 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2021-04-22 02:58:33.236171 (MainThread): Tracking: tracking
2021-04-22 02:58:33.237004 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D831616D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D831609448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D831609E08>]}
2021-04-22 02:58:33.260176 (MainThread): Partial parsing not enabled
2021-04-22 02:58:33.263653 (MainThread): Parsing macros\adapters.sql
2021-04-22 02:58:33.303552 (MainThread): Parsing macros\catalog.sql
2021-04-22 02:58:33.316515 (MainThread): Parsing macros\etc.sql
2021-04-22 02:58:33.321642 (MainThread): Parsing macros\materializations\copy.sql
2021-04-22 02:58:33.331882 (MainThread): Parsing macros\materializations\incremental.sql
2021-04-22 02:58:33.357818 (MainThread): Parsing macros\materializations\seed.sql
2021-04-22 02:58:33.362838 (MainThread): Parsing macros\materializations\snapshot.sql
2021-04-22 02:58:33.367800 (MainThread): Parsing macros\materializations\table.sql
2021-04-22 02:58:33.387741 (MainThread): Parsing macros\materializations\view.sql
2021-04-22 02:58:33.398856 (MainThread): Parsing macros\core.sql
2021-04-22 02:58:33.407836 (MainThread): Parsing macros\adapters\common.sql
2021-04-22 02:58:33.502585 (MainThread): Parsing macros\etc\datetime.sql
2021-04-22 02:58:33.520593 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-04-22 02:58:33.523455 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-04-22 02:58:33.527469 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-04-22 02:58:33.531472 (MainThread): Parsing macros\etc\is_incremental.sql
2021-04-22 02:58:33.535468 (MainThread): Parsing macros\etc\query.sql
2021-04-22 02:58:33.538420 (MainThread): Parsing macros\materializations\helpers.sql
2021-04-22 02:58:33.557269 (MainThread): Parsing macros\materializations\common\merge.sql
2021-04-22 02:58:33.588190 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-04-22 02:58:33.593177 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-04-22 02:58:33.606218 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-04-22 02:58:33.648387 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-04-22 02:58:33.716190 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-04-22 02:58:33.720218 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-04-22 02:58:33.757083 (MainThread): Parsing macros\materializations\table\table.sql
2021-04-22 02:58:33.771632 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-04-22 02:58:33.782390 (MainThread): Parsing macros\materializations\view\view.sql
2021-04-22 02:58:33.795472 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-04-22 02:58:33.801493 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-04-22 02:58:33.805452 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-04-22 02:58:33.809473 (MainThread): Parsing macros\schema_tests\unique.sql
2021-04-22 02:58:33.822438 (MainThread): Partial parsing not enabled
2021-04-22 02:58:33.867938 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:58:33.887103 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:58:33.894885 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:58:33.902669 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:58:33.910333 (MainThread): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:58:33.918865 (MainThread): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:58:33.929869 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:58:33.937831 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:58:33.945810 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:58:33.954749 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:58:33.962728 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:58:33.970707 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:58:33.978722 (MainThread): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:58:33.998666 (MainThread): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:58:34.383944 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind_shop.example

2021-04-22 02:58:34.394917 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbaf1ecc-1b92-4d1c-b38b-9f51cba4af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D83513E2C8>]}
2021-04-22 02:58:34.468716 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbaf1ecc-1b92-4d1c-b38b-9f51cba4af7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D83525CF08>]}
2021-04-22 02:58:34.468716 (MainThread): Found 13 models, 18 tests, 0 snapshots, 0 analyses, 156 macros, 0 operations, 1 seed file, 7 sources, 0 exposures
2021-04-22 02:58:34.482680 (MainThread): 
2021-04-22 02:58:34.483678 (MainThread): Acquiring new bigquery connection "master".
2021-04-22 02:58:34.500630 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_tutorial-dbt-310721_dbt_isadora".
2021-04-22 02:58:34.501629 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-04-22 02:58:34.532559 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2021-04-22 02:58:36.213039 (MainThread): 23:58:36 | Concurrency: 1 threads (target='dev')
2021-04-22 02:58:36.217023 (MainThread): 23:58:36 | 
2021-04-22 02:58:36.234975 (Thread-1): Began running node model.northwind_shop.stg_customers
2021-04-22 02:58:36.235970 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_customers".
2021-04-22 02:58:36.236972 (Thread-1): Compiling model.northwind_shop.stg_customers
2021-04-22 02:58:36.256915 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_customers"
2021-04-22 02:58:36.264892 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.265892 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.266890 (Thread-1): Finished running node model.northwind_shop.stg_customers
2021-04-22 02:58:36.266890 (Thread-1): Began running node model.northwind_shop.stg_employees
2021-04-22 02:58:36.267886 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_employees".
2021-04-22 02:58:36.268883 (Thread-1): Compiling model.northwind_shop.stg_employees
2021-04-22 02:58:36.286836 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_employees"
2021-04-22 02:58:36.288833 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.288833 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.289828 (Thread-1): Finished running node model.northwind_shop.stg_employees
2021-04-22 02:58:36.290825 (Thread-1): Began running node model.northwind_shop.stg_products
2021-04-22 02:58:36.291821 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_products".
2021-04-22 02:58:36.295811 (Thread-1): Compiling model.northwind_shop.stg_products
2021-04-22 02:58:36.309773 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_products"
2021-04-22 02:58:36.311768 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.312768 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.313764 (Thread-1): Finished running node model.northwind_shop.stg_products
2021-04-22 02:58:36.314762 (Thread-1): Began running node model.northwind_shop.stg_shippers
2021-04-22 02:58:36.315757 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_shippers".
2021-04-22 02:58:36.315757 (Thread-1): Compiling model.northwind_shop.stg_shippers
2021-04-22 02:58:36.334351 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_shippers"
2021-04-22 02:58:36.335348 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.336346 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.337344 (Thread-1): Finished running node model.northwind_shop.stg_shippers
2021-04-22 02:58:36.337344 (Thread-1): Began running node model.northwind_shop.stg_suppliers
2021-04-22 02:58:36.338340 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_suppliers".
2021-04-22 02:58:36.339339 (Thread-1): Compiling model.northwind_shop.stg_suppliers
2021-04-22 02:58:36.346320 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_suppliers"
2021-04-22 02:58:36.347316 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.348314 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.349311 (Thread-1): Finished running node model.northwind_shop.stg_suppliers
2021-04-22 02:58:36.349311 (Thread-1): Began running node seed.northwind_shop.seed_divisions
2021-04-22 02:58:36.350309 (Thread-1): Acquiring new bigquery connection "seed.northwind_shop.seed_divisions".
2021-04-22 02:58:36.350309 (Thread-1): Compiling seed.northwind_shop.seed_divisions
2021-04-22 02:58:36.354298 (Thread-1): Writing injected SQL for node "seed.northwind_shop.seed_divisions"
2021-04-22 02:58:36.355298 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.356294 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.358293 (Thread-1): Finished running node seed.northwind_shop.seed_divisions
2021-04-22 02:58:36.358293 (Thread-1): Began running node model.northwind_shop.stg_order_details
2021-04-22 02:58:36.363278 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_order_details".
2021-04-22 02:58:36.364273 (Thread-1): Compiling model.northwind_shop.stg_order_details
2021-04-22 02:58:36.377238 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_order_details"
2021-04-22 02:58:36.386771 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.387766 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.388764 (Thread-1): Finished running node model.northwind_shop.stg_order_details
2021-04-22 02:58:36.388764 (Thread-1): Began running node model.northwind_shop.stg_orders
2021-04-22 02:58:36.389761 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.stg_orders".
2021-04-22 02:58:36.389761 (Thread-1): Compiling model.northwind_shop.stg_orders
2021-04-22 02:58:36.404720 (Thread-1): Writing injected SQL for node "model.northwind_shop.stg_orders"
2021-04-22 02:58:36.405718 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.406714 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.407712 (Thread-1): Finished running node model.northwind_shop.stg_orders
2021-04-22 02:58:36.407712 (Thread-1): Began running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 02:58:36.408710 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_not_null_northwind_etl_orders_order_id".
2021-04-22 02:58:36.408710 (Thread-1): Compiling test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 02:58:36.448646 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_not_null_northwind_etl_orders_order_id"
2021-04-22 02:58:36.452599 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.452599 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.453596 (Thread-1): Finished running node test.northwind_shop.source_not_null_northwind_etl_orders_order_id
2021-04-22 02:58:36.453596 (Thread-1): Began running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 02:58:36.454593 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.source_unique_northwind_etl_orders_order_id".
2021-04-22 02:58:36.454593 (Thread-1): Compiling test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 02:58:36.487504 (Thread-1): Writing injected SQL for node "test.northwind_shop.source_unique_northwind_etl_orders_order_id"
2021-04-22 02:58:36.489499 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.489499 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.490773 (Thread-1): Finished running node test.northwind_shop.source_unique_northwind_etl_orders_order_id
2021-04-22 02:58:36.490773 (Thread-1): Began running node model.northwind_shop.dim_customers
2021-04-22 02:58:36.491752 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_customers".
2021-04-22 02:58:36.492747 (Thread-1): Compiling model.northwind_shop.dim_customers
2021-04-22 02:58:36.504717 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_customers"
2021-04-22 02:58:36.506710 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.506710 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.507709 (Thread-1): Finished running node model.northwind_shop.dim_customers
2021-04-22 02:58:36.508706 (Thread-1): Began running node model.northwind_shop.dim_employees
2021-04-22 02:58:36.510703 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_employees".
2021-04-22 02:58:36.511708 (Thread-1): Compiling model.northwind_shop.dim_employees
2021-04-22 02:58:36.520675 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_employees"
2021-04-22 02:58:36.522669 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.523667 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.524664 (Thread-1): Finished running node model.northwind_shop.dim_employees
2021-04-22 02:58:36.524664 (Thread-1): Began running node model.northwind_shop.dim_products
2021-04-22 02:58:36.526659 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_products".
2021-04-22 02:58:36.526659 (Thread-1): Compiling model.northwind_shop.dim_products
2021-04-22 02:58:36.541670 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_products"
2021-04-22 02:58:36.548666 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.549647 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.550647 (Thread-1): Finished running node model.northwind_shop.dim_products
2021-04-22 02:58:36.551643 (Thread-1): Began running node model.northwind_shop.dim_shippers
2021-04-22 02:58:36.552639 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_shippers".
2021-04-22 02:58:36.553637 (Thread-1): Compiling model.northwind_shop.dim_shippers
2021-04-22 02:58:36.564628 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_shippers"
2021-04-22 02:58:36.568596 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.568596 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.569595 (Thread-1): Finished running node model.northwind_shop.dim_shippers
2021-04-22 02:58:36.570591 (Thread-1): Began running node model.northwind_shop.dim_suppliers
2021-04-22 02:58:36.571588 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.dim_suppliers".
2021-04-22 02:58:36.572589 (Thread-1): Compiling model.northwind_shop.dim_suppliers
2021-04-22 02:58:36.588546 (Thread-1): Writing injected SQL for node "model.northwind_shop.dim_suppliers"
2021-04-22 02:58:36.590195 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.590195 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.591182 (Thread-1): Finished running node model.northwind_shop.dim_suppliers
2021-04-22 02:58:36.591182 (Thread-1): Began running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-04-22 02:58:36.596177 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_customers_customer_sk".
2021-04-22 02:58:36.598173 (Thread-1): Compiling test.northwind_shop.not_null_dim_customers_customer_sk
2021-04-22 02:58:36.614124 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_customers_customer_sk"
2021-04-22 02:58:36.621103 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.621103 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.622099 (Thread-1): Finished running node test.northwind_shop.not_null_dim_customers_customer_sk
2021-04-22 02:58:36.623098 (Thread-1): Began running node test.northwind_shop.unique_dim_customers_customer_sk
2021-04-22 02:58:36.624094 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_customers_customer_sk".
2021-04-22 02:58:36.624094 (Thread-1): Compiling test.northwind_shop.unique_dim_customers_customer_sk
2021-04-22 02:58:36.642048 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_customers_customer_sk"
2021-04-22 02:58:36.650025 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.651022 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.652019 (Thread-1): Finished running node test.northwind_shop.unique_dim_customers_customer_sk
2021-04-22 02:58:36.652019 (Thread-1): Began running node test.northwind_shop.not_null_dim_employees_employee_sk
2021-04-22 02:58:36.653017 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_employees_employee_sk".
2021-04-22 02:58:36.654014 (Thread-1): Compiling test.northwind_shop.not_null_dim_employees_employee_sk
2021-04-22 02:58:36.668975 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_employees_employee_sk"
2021-04-22 02:58:36.674628 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.674628 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.675625 (Thread-1): Finished running node test.northwind_shop.not_null_dim_employees_employee_sk
2021-04-22 02:58:36.677620 (Thread-1): Began running node test.northwind_shop.unique_dim_employees_employee_sk
2021-04-22 02:58:36.681170 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_employees_employee_sk".
2021-04-22 02:58:36.685169 (Thread-1): Compiling test.northwind_shop.unique_dim_employees_employee_sk
2021-04-22 02:58:36.700117 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_employees_employee_sk"
2021-04-22 02:58:36.703226 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.703226 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.705221 (Thread-1): Finished running node test.northwind_shop.unique_dim_employees_employee_sk
2021-04-22 02:58:36.705221 (Thread-1): Began running node test.northwind_shop.not_null_dim_products_product_sk
2021-04-22 02:58:36.706219 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_products_product_sk".
2021-04-22 02:58:36.707218 (Thread-1): Compiling test.northwind_shop.not_null_dim_products_product_sk
2021-04-22 02:58:36.724171 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_products_product_sk"
2021-04-22 02:58:36.736256 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.736256 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.737254 (Thread-1): Finished running node test.northwind_shop.not_null_dim_products_product_sk
2021-04-22 02:58:36.738251 (Thread-1): Began running node test.northwind_shop.unique_dim_products_product_sk
2021-04-22 02:58:36.739249 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_products_product_sk".
2021-04-22 02:58:36.739249 (Thread-1): Compiling test.northwind_shop.unique_dim_products_product_sk
2021-04-22 02:58:36.757200 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_products_product_sk"
2021-04-22 02:58:36.759196 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.762191 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.768177 (Thread-1): Finished running node test.northwind_shop.unique_dim_products_product_sk
2021-04-22 02:58:36.771164 (Thread-1): Began running node test.northwind_shop.not_null_dim_shippers_shipper_sk
2021-04-22 02:58:36.773157 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_shippers_shipper_sk".
2021-04-22 02:58:36.773157 (Thread-1): Compiling test.northwind_shop.not_null_dim_shippers_shipper_sk
2021-04-22 02:58:36.790313 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_shippers_shipper_sk"
2021-04-22 02:58:36.794788 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.796792 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.799775 (Thread-1): Finished running node test.northwind_shop.not_null_dim_shippers_shipper_sk
2021-04-22 02:58:36.800770 (Thread-1): Began running node test.northwind_shop.unique_dim_shippers_shipper_sk
2021-04-22 02:58:36.801773 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_shippers_shipper_sk".
2021-04-22 02:58:36.802764 (Thread-1): Compiling test.northwind_shop.unique_dim_shippers_shipper_sk
2021-04-22 02:58:36.822710 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_shippers_shipper_sk"
2021-04-22 02:58:36.824706 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.825703 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.827700 (Thread-1): Finished running node test.northwind_shop.unique_dim_shippers_shipper_sk
2021-04-22 02:58:36.829703 (Thread-1): Began running node model.northwind_shop.fact_order_details
2021-04-22 02:58:36.834680 (Thread-1): Acquiring new bigquery connection "model.northwind_shop.fact_order_details".
2021-04-22 02:58:36.834680 (Thread-1): Compiling model.northwind_shop.fact_order_details
2021-04-22 02:58:36.861609 (Thread-1): Writing injected SQL for node "model.northwind_shop.fact_order_details"
2021-04-22 02:58:36.868591 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.868591 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.869587 (Thread-1): Finished running node model.northwind_shop.fact_order_details
2021-04-22 02:58:36.870584 (Thread-1): Began running node test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-04-22 02:58:36.871581 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_dim_suppliers_supplier_sk".
2021-04-22 02:58:36.872578 (Thread-1): Compiling test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-04-22 02:58:36.885544 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_dim_suppliers_supplier_sk"
2021-04-22 02:58:36.888536 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.889533 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.889533 (Thread-1): Finished running node test.northwind_shop.not_null_dim_suppliers_supplier_sk
2021-04-22 02:58:36.890530 (Thread-1): Began running node test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-04-22 02:58:36.891527 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.unique_dim_suppliers_supplier_sk".
2021-04-22 02:58:36.891527 (Thread-1): Compiling test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-04-22 02:58:36.899506 (Thread-1): Writing injected SQL for node "test.northwind_shop.unique_dim_suppliers_supplier_sk"
2021-04-22 02:58:36.901510 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.901510 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.902507 (Thread-1): Finished running node test.northwind_shop.unique_dim_suppliers_supplier_sk
2021-04-22 02:58:36.902507 (Thread-1): Began running node test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 02:58:36.903505 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.not_null_fact_order_details_order_id".
2021-04-22 02:58:36.903505 (Thread-1): Compiling test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 02:58:36.911482 (Thread-1): Writing injected SQL for node "test.northwind_shop.not_null_fact_order_details_order_id"
2021-04-22 02:58:36.913477 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.914476 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.914476 (Thread-1): Finished running node test.northwind_shop.not_null_fact_order_details_order_id
2021-04-22 02:58:36.915472 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 02:58:36.915472 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_".
2021-04-22 02:58:36.916471 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 02:58:36.938412 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_"
2021-04-22 02:58:36.940413 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.940413 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.941403 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_customer_fk__customer_sk__ref_dim_customers_
2021-04-22 02:58:36.941403 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-04-22 02:58:36.943398 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_".
2021-04-22 02:58:36.943398 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-04-22 02:58:36.956363 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_"
2021-04-22 02:58:36.959355 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.959355 (Thread-1): finished collecting timing info
2021-04-22 02:58:36.961349 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_product_fk__product_sk__ref_dim_products_
2021-04-22 02:58:36.961349 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-04-22 02:58:36.962347 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_".
2021-04-22 02:58:36.963344 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-04-22 02:58:37.012214 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_"
2021-04-22 02:58:37.014209 (Thread-1): finished collecting timing info
2021-04-22 02:58:37.015209 (Thread-1): finished collecting timing info
2021-04-22 02:58:37.016204 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_shipper_fk__shipper_sk__ref_dim_shippers_
2021-04-22 02:58:37.016204 (Thread-1): Began running node test.northwind_shop.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_
2021-04-22 02:58:37.017200 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_".
2021-04-22 02:58:37.018202 (Thread-1): Compiling test.northwind_shop.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_
2021-04-22 02:58:37.040139 (Thread-1): Writing injected SQL for node "test.northwind_shop.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_"
2021-04-22 02:58:37.043131 (Thread-1): finished collecting timing info
2021-04-22 02:58:37.043131 (Thread-1): finished collecting timing info
2021-04-22 02:58:37.044129 (Thread-1): Finished running node test.northwind_shop.relationships_fact_order_details_supplier_fk__supplier_sk__ref_dim_suppliers_
2021-04-22 02:58:37.045127 (Thread-1): Began running node test.northwind_shop.test
2021-04-22 02:58:37.046123 (Thread-1): Acquiring new bigquery connection "test.northwind_shop.test".
2021-04-22 02:58:37.046123 (Thread-1): Compiling test.northwind_shop.test
2021-04-22 02:58:37.172846 (Thread-1): Writing injected SQL for node "test.northwind_shop.test"
2021-04-22 02:58:37.174842 (Thread-1): finished collecting timing info
2021-04-22 02:58:37.175839 (Thread-1): finished collecting timing info
2021-04-22 02:58:37.177834 (Thread-1): Finished running node test.northwind_shop.test
2021-04-22 02:58:37.276694 (MainThread): Connection 'master' was properly closed.
2021-04-22 02:58:37.276694 (MainThread): Connection 'list_tutorial-dbt-310721_dbt_isadora' was properly closed.
2021-04-22 02:58:37.277692 (MainThread): Connection 'test.northwind_shop.test' was properly closed.
2021-04-22 02:58:37.300630 (MainThread): 23:58:37 | Done.
2021-04-22 02:58:37.720845 (MainThread): Acquiring new bigquery connection "generate_catalog".
2021-04-22 02:58:37.720845 (MainThread): 23:58:37 | Building catalog
2021-04-22 02:58:37.731816 (MainThread): Opening a new connection, currently in state init
2021-04-22 02:58:38.977892 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "tutorial-dbt-310721.information_schema".
2021-04-22 02:58:39.009817 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-04-22 02:58:39.017793 (ThreadPoolExecutor-1_0): On tutorial-dbt-310721.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "connection_name": "tutorial-dbt-310721.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `tutorial-dbt-310721`.`dbt_isadora`.__TABLES__
        where (upper(dataset_id) = upper('dbt_isadora'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `tutorial-dbt-310721`.`dbt_isadora`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `tutorial-dbt-310721`.`dbt_isadora`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-04-22 02:58:44.734213 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "tutorial-dbt-310721.information_schema".
2021-04-22 02:58:44.739197 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-04-22 02:58:44.754889 (ThreadPoolExecutor-1_0): On tutorial-dbt-310721.information_schema: /* {"app": "dbt", "dbt_version": "0.19.1", "profile_name": "my-bigquery-db", "target_name": "dev", "connection_name": "tutorial-dbt-310721.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `tutorial-dbt-310721`.`northwind_etl`.__TABLES__
        where (upper(dataset_id) = upper('northwind_etl'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `tutorial-dbt-310721`.`northwind_etl`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `tutorial-dbt-310721`.`northwind_etl`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2021-04-22 02:58:49.755286 (MainThread): 23:58:49 | Catalog written to C:\Users\user\test_project\target\catalog.json
2021-04-22 02:58:49.763282 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D82E7F8088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D82E7F4C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8335E4F88>]}
2021-04-22 02:58:49.765267 (MainThread): Flushing usage events
2021-04-22 02:58:50.740322 (MainThread): Connection 'generate_catalog' was properly closed.
2021-04-22 02:58:50.741321 (MainThread): Connection 'tutorial-dbt-310721.information_schema' was properly closed.
2021-04-22 02:59:04.402979 (MainThread): Running with dbt=0.19.1
2021-04-22 02:59:05.163330 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\user\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2021-04-22 02:59:05.164331 (MainThread): Tracking: tracking
2021-04-22 02:59:05.165290 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAF6F44F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAF6F42D48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AAF6F3AC48>]}
2021-04-22 02:59:05.171275 (MainThread): Serving docs at 0.0.0.0:8080
2021-04-22 02:59:05.173269 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2021-04-22 02:59:05.174268 (MainThread): Press Ctrl+C to exit.


